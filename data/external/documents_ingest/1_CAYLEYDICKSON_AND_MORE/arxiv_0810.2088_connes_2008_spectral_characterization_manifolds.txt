                                          ON THE SPECTRAL CHARACTERIZATION OF MANIFOLDS

                                                                              ALAIN CONNES




arXiv:0810.2088v1 [math.OA] 12 Oct 2008
                                               Abstract. We show that the first five of the axioms we had formulated on
                                               spectral triples suffice (in a slightly stronger form) to characterize the spectral
                                               triples associated to smooth compact manifolds. The algebra, which is assumed
                                               to be commutative, is shown to be isomorphic to the algebra of all smooth
                                               functions on a unique smooth oriented compact manifold, while the operator
                                               is shown to be of Dirac type and the metric to be Riemannian.




                                                                                 Contents
                                          1. Introduction                                                                             2
                                          2. Preliminaries                                                                            4
                                          3. Openness Lemma                                                                          10
                                          4. Jacobian and openness of local charts                                                   12
                                          5. Dissipative derivations                                                                 15
                                          6. Self-adjointness and derivations                                                        24
                                          7. Absolute continuity                                                                     35
                                          8. Spectral multiplicity                                                                   39
                                          9. Local form of the L(p,1) estimate                                                       41
                                          10. Local bound on #(s−1 α (x) ∩ V )                                                       48
                                          11. Reconstruction Theorem                                                                 50
                                          12. Final remarks                                                                          54
                                          12.1. The role of D                                                                        54
                                          12.2. Finite propagation                                                                   56
                                          12.3. Immersion versus embedding                                                           56
                                          12.4. The antisymmetry condition                                                           57
                                          12.5. Strong regularity                                                                    57
                                          12.6. The Noncommutative case                                                              58
                                          13. Appendix 1: Regularity                                                                 58
                                          14. Appendix 2: The Dixmier trace and the heat expansion                                   61
                                          References                                                                                 66
                                                                                       1
                                  1. Introduction
The problem of spectral characterization of manifolds was initially formulated as
an open question in [11]. The issue is to show that under the simple conditions
of [11] on a spectral triple (A, H, D), with A commutative, the algebra A is the
algebra C ∞ (X) of smooth functions on a (unique) smooth compact manifold X.
The five conditions ([11]), in dimension p, are
    (1) The n-th characteristic value of the resolvent of D is O(n−1/p ).
    (2) [[D, a], b] = 0   ∀ a, b ∈ A.
    (3) For any a ∈ A both a and [D, a] belong to the domain of δ m , for any integer
        m where δ is the derivation: δ(T ) = [|D|, T ].
    (4) There exists a Hochschild cycle c ∈ Zp (A, A) such that πD (c) = 1 for p
        odd, while for p even, πD (c) = γ is a Z/2 grading.
    (5) Viewed as an A-module the space H∞ = ∩DomDm is finite and projective.
        Moreover the following    equality defines a hermitian structure ( | ) on this
        module: hξ, a ηi = − a(ξ|η) |D|−p , ∀a ∈ A, ∀ξ, η ∈ H∞ .
                           R

The notations are recalled at the beginning of §2 below. The strategy of proof was
outlined
    P 0briefly in [11]. It consists in using the components ajα (j > 0) of the cycle
c = aα ⊗ aα ⊗ · · · ⊗ apα as tentative local charts. There are three basic difficulties:
            1

    a) Show that the spectrum X of A is large enough so that the range of “local
       charts” aα contains an open set in Rp .
    b) Show that the joint spectral measure of the components ajα (j > 0) of a
       “local chart” is the Lebesgue measure.
    c) Apply the basic inequality ([8], [9], Proposition IV.3.14) giving an upper
       bound on the Voiculescu obstruction [25] and use [25] Theorem 4.5 to show
       that the “local charts” are locally injective.
In a recent paper [22], Rennie and Varilly considered the above challenging problem.
The paper [22] is a courageous attempt which contains a number of interesting
ideas and a useful smooth calculus but also, unfortunately, several gaps, each being
enough to invalidate the proof of the claimed result.
I will show in this paper how to prove a), b), c). I have tried to be very careful
and give detailed proofs. The way to prove a) uses a new ingredient: the implicit
function theorem (whose presence is not a real surprise). We shall first assume that
continuous ∗-derivations of A exponentiate, i.e. are generators of one-parameter
groups (of automorphisms of A). Then most of the work, done in §§5, 6, is to show
that this hypothesis can be removed. In this very technical part of the paper we
show that enough self-adjoint derivations of A exponentiate. We first prove in §5
that enough derivations are dissipative for the C ∗ -algebra norm. We then proceed
in §6 and use the self-adjointness of D and the third condition (regularity) in the
strong form, to show the surjectivity of the resolvent, and apply the Hille-Yosida
Theorem to integrate these derivations into one-parameter groups of automorphisms
of the C ∗ -algebra. We then show that they are continuous for the Sobolev norms
and define automorphisms of A.

To prove b) one needs a key result which is the analogue in our context of the quasi-
invariance under diffeomorphisms of the smooth measure class on a manifold, whose
replacement in our case is given by the Dixmier trace. This is shown in Proposition
6.16 at the end of §6. We then prove in §7 the required absolute continuity of the
                                           2
spectral measure using a smearing argument. In §8 we show the required inequality
between the multiplicity of the map sα and the spectral multiplicity of the ajα .
To prove c) a new strategy is required. Roughly one needs to know that the multi-
plicity function of a tentative local coordinate system is locally bounded while the
information one obtains just by applying the strategy outlined in [11] (and pursued
in [22]) is that it is a lower semicontinuous1 integrable function. Typical examples
of Lebesgue negligible dense Gδ sets2 show that, as such, the situation is hopeless.
In order to solve this problem, one needs a local form of the basic inequality ([8],
[9], Proposition IV.3.14) giving an upper bound on the Voiculescu obstruction. We
prove this result in §9. This key result is combined with Voiculescu’s Theorem
(Theorem 4.5 of [25]) and with the initial implicit function technique to conclude
the proof in §11. Our main result can be stated as follows (cf. Theorem 11.3):
Theorem 1.1. Let (A, H, D) be a spectral triple, with A commutative, fulfilling
the first five conditions of [11] (cf. §2) in a slightly stronger form i.e. we assume
that:
      • The regularity holds for all A-endomorphisms of ∩DomDm .
      • The Hochschild cycle c is antisymmetric.
Then there exists a compact oriented smooth manifold X such that A is the algebra
C ∞ (X) of smooth functions on X.
Moreover every compact oriented smooth manifold appears in this spectral manner.
Our next result is the following variant (Theorem 11.5):
Theorem 1.2. Let (A, H, D) be a spectral triple with A commutative, fulfilling the
first five conditions of [11] (cf. §2) with the cycle c antisymmetric. Assume that the
multiplicity of the action of A′′ in H is 2p/2 . Then there exists a smooth oriented
compact (spinc ) manifold X such that A = C ∞ (X).
This multiplicity hypothesis is a weak form of the Poincaré duality condition 6 of
[11] and thus the above theorem can be seen as the solution of the original problem
formulated in [11] and gives a characterization of spinc manifolds. It follows from
[11] (cf. [14] for the proof) that the operator D is then a Dirac operator. The reality
condition selects spin manifolds among spinc , and the spectral action ([3]) selects
the Levi-Civita connection.
Finally we make a few remarks in §12. The first describes a different perspective on
our main result. As explained many times, it is only because one drops commuta-
tivity that variables with continuous range can coexist with infinitesimal variables
(which only affect finitely many values larger than a given ǫ). In the classical
formulation of variables, as maps from a set X to the real numbers, infinitesimal
variables cannot coexist with continuous variables. The formalism of quantum
mechanics and the uniqueness of the separable infinite dimensional Hilbert space
cure this problem. Using this formalism, variables with continuous range (i.e. self-
adjoint operators with continuous spectrum) coexist, in the same operator theoretic
framework, with variables with countable range, such as the infinitesimal ones (i.e.
compact operators). The only new fact is that they do not commute. The content
of Theorem 1.2 can be expressed in a suggestive manner from this coexistence be-
tween the continuum and the discrete. We fix the integer p and N = 2[p/2] where
  1the inverse image of ]a, ∞] is open
  2countable intersection of open sets

                                          3
[p/2] is the integral part of p/2. The continuum will only be used through its “mea-
sure theoretic” content. This is captured by a commutative von-Neumann algebra
M and, provided there is no atomic part in M , this algebra is then unique (up to
isomorphism). It is uniquely represented in Hilbert space H (which we fix once and
for all, as a universal stage) once the spectral multiplicity is fixed equal to N . Thus
the pair (M, H) is unique (up to isomorphism). Let us now consider (separately
first) an infinitesimal ds i.e. a self-adjoint compact operator in H. Equivalently
we can talk about its inverse D which is unbounded and self-adjoint. We assume
that ds is an infinitesimal of finite order α = p1 . The information contained in the
operator ds is entirely captured by a list of real numbers, namely the eigenvalues
of ds (with their multiplicity). This list determines uniquely (up to isomorphism)
the pair (H, D). Theorem 1.2 can now be restated as the birth of a geometry
from the coexistence of (M, H) with (H, D). This coexistence is encoded by a uni-
tary isomorphism F between the Hilbert space of the canonical pair (M, H) and
the Hilbert space of the canonical pair (H, D). Thus the full information on the
geometric space is subdivided in two pieces
     (1) The list of eigenvalues of D.
     (2) The unitary F .
We point out in §12 the analogy between these parameters for geometry and the
parameters of the Yukawa coupling of the Standard Model ([6]) which are encoded
similarly by:
     (1) The list of masses.
     (2) The CKM matrix C.
This analogy as well as the precise definition of the corresponding unitary invariant
of Riemannian geometry will be dealt with in details in the companion paper [12].
The second remark recalls a result of M. Hilsum on finite propagation (cf. [17]).
We then discuss briefly in §12 the variations dealing with real analytic manifolds,
non-integral dimensions and the non-commutative case.
We end with two appendices. In the first, §13, we discuss equivalent formulations
of the regularity condition. In the second, §14, we recall the basic properties of the
Dixmier trace and its relation with the heat expansion.
Acknowledgment. The author is grateful to G. Landi, H. Moscovici, G. Skandalis
and R. Wulkenhaar for useful comments.

                                 2. Preliminaries
Let us recall the conditions for commutative geometry as formulated in [11]. We
shall only use the first five conditions.
We let (A, H, D) be a spectral triple, thus H is a Hilbert space, A an involutive
algebra represented in H and D is a selfadjoint operator in H. We assume that
A is commutative. We are given an integer p which controls the dimension of our
space. The conditions are:
1) Dimension: The n-th characteristic value of the resolvent of D is O(n−1/p ).
2) Order one: [[D, f ], g] = 0       ∀ f, g ∈ A.
We let δ(T ) = [|D|, T ] be the commutator3 with the absolute value of D:
   3The domain of δ is the set of bounded operators T with T Dom|D| ⊂ Dom|D| and δ(T )
bounded.
                                           4
3) Regularity: For any a ∈ A both a and [D, a] belong to the domain of δ m , for
any integer m.
We let πD be the linear map given by
(1)            πD (a0 ⊗ a1 ⊗ . . . ⊗ ap ) = a0 [D, a1 ] . . . [D, ap ] ,   ∀aj ∈ A .
4) Orientability: There exists a Hochschild cycle c ∈ Zp (A, A) such that πD (c) = 1
for p odd, while for p even, πD (c) = γ satisfies
                               γ = γ ∗ , γ 2 = 1 , γD = −Dγ .
5) Finiteness and absolute continuity:Viewed as an A-module the space H∞ =
∩m Domain Dm is finite and projective. Moreover the following equality defines a
hermitian structure ( | ) on this module,
                          Z
(2)            hξ, a ηi = − a(ξ|η) |D|−p  ∀ a ∈ A , ∀ ξ, η ∈ H∞ .

In other words the module can be written as H∞ = eAn with e = e∗ ∈ Mn (A)
defining the Hermitian structure so that
                               X
(3)                    (ξ|η) =     ξi∗ ηi ∈ A , ∀ξ, η ∈ eAn
It follows from condition 4) and from4 ([9], Theorem 8, IV.2.γ, and [14]) that the
operators aR |D|−p , a ∈ A are measurable ([9], Definition 7, IV.2.β) so that the
coefficient − a |D|−p of the logarithmic divergence of their trace is unambiguously
defined.
It follows from condition 5) that the algebra A is uniquely determined inside its
weak closure A′′ (which is also the bicommutant of A in H) by the equality
                           A = {T ∈ A′′ ; T ∈ ∩m>0 Domδ m } .
This was stated without proof in [11] and we give the argument below:
Lemma 2.1. The following conditions are equivalent for T ∈ A′′ :
  (1) T ∈ A
  (2) [D, T ] is bounded and both T and [D, T ] belong to the domain of δ m , for
      any integer m
  (3) T belongs to the domain of δ m , for any integer m
  (4) T H∞ ⊂ H∞
Proof. Let us assume the fourth property. Then T defines an endomorphism of
the finite projective module H∞ = eAn over A. As any endomorphism T is of the
form,
(4)                                  T = e[aij ]e , aij ∈ A
i.e. it is the compression of a matrix a = [aij ] ∈ Mn (A).
Let us show that since T belongs to the weak closure of A one can choose aij = xδij
for some element x of A. The norm closure A of A in L(H) is a commutative C ∗ -
algebra, A = C(X) for some compact space X, and since A is a subalgebra of L(H)
it injects in A. The following equality
                                     Z
(5)                          λ(f ) = −f |D|−p , ∀f ∈ A ,

   4We shall not use this result in an essential manner since one can just fix a choice of Dixmier
trace Trω throughout the proof.
                                                  5
defines a positive measure λ on X. We let E = eAn be the induced finite projective
module over A, which is intrinsically defined as E = H∞ ⊗A A. We let S be the
hermitian vector bundle on X such that E = C(X, S). By the absolute continuity
relation (2), the representation of A = C(X) in H is obtained from its action in
L2 (X, λ) by the tensor product
(6)                H = E ⊗A L2 (X, λ) = eL2 (X, λ)n = L2 (X, λ, S) .
This shows that the weak closure A′′ = A′′ of A in H is given by the diagonal
action of L∞ (X, λ) in eL2 (X, λ)n . Thus, since T ∈ A′′ , there exists f ∈ L∞ (X, λ)
such that T = ef . It follows that the matrix eae belongs to the center of eMn (A)e.
This center is e(1 ⊗ A) and thus T agrees with an element of A which proves the
implication 4) ⇒ 1). To be more specific, and for later use, let us give a formula
for an element x ∈ A such that T = ex in term of the matrix elements tij ∈ A of
T = e[aij ]e. First the fact that T belongs to the center of the algebra B = eMn (A)e
of endomorphisms of H∞ can be seen directly since any such endomorphism S is
automatically continuous in H using (6). Thus since T ∈ A′′ one has ST = T S.
Since
P     e is a self-adjoint idempotent and A injects in C(X) the element τ = Tr(e) =
   ejj ∈ A is determined by its image in A which is just the function χ ∈ X 7→
dimSχ ∈ {0, 1, . . . , n}. This determines n + 1 self-adjoint idempotents pj ∈ A by
                                        X         X
(7)                         τ = Tr(e) =     j pj      pj = 1 .
To check that pj ∈ A it is enough to show that pj = Pj (τ ) where Pj is a polynomial
with
(8)                    Pj (k) = 0 ,   ∀k 6= j , 0 ≤ k ≤ n , Pj (j) = 1 .
One then has the following formula5 for x:
                                X         X1
(9)                         x=(     tii )       pj ∈ A .
                                          j>0
                                              j

As T belongs to the center of eMn (C(X))e one gets an equality T = ef for f ∈
C(X) and working at every point χ ∈ X one then shows that T = ex.
The implication 1) ⇒ 2) follows from the regularity, and 2) ⇒ 3) is immediate. To
show the implication 3) ⇒ 4) one uses the definition of H∞ as the intersection of
domains of powers of |D| and the implication
                    T ∈ Dom δ m , ξ ∈ Dom |D|m ⇒ T ξ ∈ Dom |D|m
with the formula
                             m
                             X           
                   m                  m
(10)           |D| T ξ =                      δ k (T ) |D|m−k ξ ,   ∀ξ ∈ Dom|D|m
                                      k
                             k=0
which is proved by induction on m. More precisely this gives an estimate of the
norms but one has to care for the domains and proceed as follows. By definition
any T ∈ Domδ preserves the domain Dom|D| thus one gets (10) for m = 1. Let
now T ∈ Domδ 2 i.e. T ∈ Domδ and δ(T ) ∈ Domδ. Let ξ ∈ Dom|D|2 . Then
since T ∈ Dom δ and |D|ξ ∈ Dom|D|, one has T |D|ξ ∈ Dom|D|. One has δ(T )ξ =
|D|T ξ −T |D|ξ where both terms make sense separately. Since δ(T ) ∈ Domδ one has
δ(T )Dom|D| ⊂ Dom|D|. Thus δ(T )ξ ∈ Dom|D|. Hence |D|T ξ = δ(T )ξ + T |D|ξ ∈
   5Note that p = 0 because of the faithfulness of the action of A in Hilbert space together with
               0
condition 5.
                                                   6
Dom|D| so that T preserves Dom|D|2 . Moreover one gets (10) for m = 2 as an
equality valid on any vector ξ ∈ Dom|D|2 . One can now proceed by induction on
m. We assume to have shown,
      • For q ≤ m, S ∈ Domδ q ⇒ SDom|D|q ⊂ Dom|D|q
      • (10) holds for all n ≤ m.
For T ∈ Domδ m+1 and ξ ∈ Dom|D|m+1 , one has ξ ∈ Dom|D|m and one can use
the induction hypothesis to get
                                  m      
                                  X   m
                       |D|m T ξ =           δ k (T ) |D|m−k ξ
                                      k
                                     k=0
                   k       m−k
Let us show that δ (T ) |D|    ξ ∈ Dom|D|. One has δ k (T ) ∈ Domδ m+1−k ⊂ Domδ
        m−k              1+k
and |D|     ξ ∈ Dom|D|       ⊂ Dom|D| which gives the result. Thus each term of
the sum belongs to Dom|D| and one has
                                  m     
                                  X    m
                    |D|m+1 T ξ =           |D|δ k (T ) |D|m−k ξ
                                       k
                                     k=0

Moreover, as δ (T ) ∈ Domδ and |D|m−k ξ ∈ Dom|D| one has
               k

            |D|δ k (T ) |D|m−k ξ = δ k+1 (T ) |D|m−k ξ + δ k (T ) |D|m−k+1 ξ
which gives (10) for n + 1.                                                       

This shows that the whole geometric data (A, H, D) is in fact uniquely determined
by the triple (A′′ , H, D) where A′′ is a commutative von Neumann algebra.
This also shows that A is a pre-C ∗ -algebra, i.e. that it is stable under the holo-
morphic functional calculus in the C ∗ -algebra norm closure of A, A = A. Since we
assumed that A was commutative, so is A and by Gelfand’s theorem A = C(X)
is the algebra of continuous complex valued functions on X = Spec(A). We note
finally that characters χ of A are automatically self-adjoint: χ(a∗ ) = χ(a) since
the spectrum of self-adjoint elements of A is real. Also they are automatically
continuous since the C ∗ -norm is uniquely determined algebraically by
                          kak = sup{|λ| | a∗ a − λ2 ∈
                                                    / A−1 }
thus they extend automatically to A by continuity so that
                                  SpecA = SpecA .

We shall now show that A is a Frechet algebra i.e. a complete locally convex algebra
whose topology is defined by the submultiplicative norms
(11)                     pk (xy) ≤ pk (x)pk (y) ,   ∀x, y ∈ A
associated to the regularity condition, for instance by
                                             x δ(x) . . . δ k (x)/k!
                                                                    
                                          0       x   ...     ...   
(12)        pk (x) = kρk (x)k , ρk (x) = 
                                          ... ...
                                                                     
                                                        x    δ(x) 
                                             0    ...   0       x
since ρk is a representation of A.
Proposition 2.2.     (1) The unbounded derivation δ is a closed operator in L(H).
   (2) The algebra A endowed with the norms pk is a Frechet algebra.
                                           7
    (3) The semi-norms pk ([D, a]) = p′k (a) are continuous.
Proof. (1) Let G(|D|) be the graph of |D|. The graph of δ is
       G(δ) = {(T, S) ∈ L(H)2 | (T ξ, T η + Sξ) ∈ G(|D|) ,       ∀(ξ, η) ∈ G(|D|)} .
It is therefore closed.
(2) Let us show that A is complete. Let an ∈ A be a sequence which is a Cauchy
sequence in any of the norms pk . Then an → T in norm, so that T ∈ A ⊂ A′′ . Since
δ is a closed operator one has T ∈ Domδ and δ(an ) → δ(T ) in norm. By induction
one gets, using the closedness of δ that T ∈ Domδ k and δ k (T ) = lim δ k (an ). Thus
T ∈ ∩Domδ m and by Lemma 2.1, we get T ∈ A. Furthermore we also have the
norm convergence δ k (T ) = lim δ k (an ). This shows that the an converge to T in the
topology of the norms pk and hence that A is a Frechet space.
(3) Let us show that if we adjoin the semi-norms p′k to the topology of A we still get
a complete space. The argument of the proof of (1) only uses the closedness of the
operator |D| and thus we get in the same way that the derivation T → d(T ) = [D, T ]
with domain Domd = {T ∈ L(H) | T DomD ⊂ DomD , k[D, T ]k < ∞} is closed for
the norm topology of L(H). Thus the above proof of completeness applies. The
result then follows from the open mapping Theorem ([24] Corollary 2.12) applied
to the identity map from A endowed with the topology of the pk , p′k to A endowed
with the topology of the pk .                                                       

In fact Lemma 2.1 shows that one has Sobolev estimates, using finitely many gen-
erators ηµ of the A-module H∞ to define the Sobolev norms on A as
                              X
(13)             kaksobolev
                    s       =(  k(1 + D2 )s/2 aηµ k2 )1/2 , ∀a ∈ A
                                  µ

One has
Proposition 2.3.       (1) When endowed with the norms (13), A is a Frechet sep-
       arable nuclear space.
   (2) One has Sobolev estimates of the form
(14)         pk (a) ≤ ck kaksobolev
                            sk      , pk ([D, a]) ≤ c′k kaksobolev
                                                           s′      ,   ∀a ∈ A
                                                            k

        with ck < ∞, c′k < ∞ and suitable sequences sk > 0, s′k > 0.
    (3) The spectrum X = Spec(A) is metrizable.
    (4) Any T ∈ EndA H∞ is continuous in H∞ and extends continuously to a
        bounded operator in H.
    (5) The algebraic isomorphism H∞ = eAn is topological.
    (6) The map (a, ξ) 7→ aξ and the A-valued inner product are jointly continuous
        A × H∞ → H∞ and H∞ × H∞ → A.
Proof. 1) By construction the family (13) is an increasing sequence of norms. Let
us show that A is complete. Let an be a sequence of elements of A such that the
vectors (1 + D2 )s/2 an ηµ converge for all s (and all µ). We then obtain vectors
                              ζµ = lim an ηµ ∈ H∞ ,      ∀µ ,
where the convergence holds in the topology of H∞ . Let then T be the operator
given by
(15)                          T ξ = lim an ξ ,   ∀ξ ∈ H∞ .
                                             8
                                              P µ
It
P isµ well defined since one can write ξ =       b ηµ with bµP∈ A which gives an ξ =
    b an ηµ which converges, in the topology of H∞ , to         bµ ζµ since the bµ are
continuous linear maps on H∞ using (10) and regularity. Thus T is a linear map
on H∞ and it commutes with A i.e. it is an endomorphism of this finite projective
module. Thus T is of the form (4) and in particular it is bounded in H. Also since
endomorphisms of the finite projective module are automatically continuous in H
they commute with T using (15). Thus the argument of Lemma 2.1 shows that
T ∈ A. Moreover, since the convergence (15) holds in the topology of H∞ , one has
an → T in the Sobolev topology and A is complete in that topology. Thus A is a
Frechet space. It is by construction a closed subspace of the sum of finitely many
spaces H∞ each being a separable nuclear space (of sequences of rapid decay). Thus
it is a separable nuclear space.
2) The identity map from the Frechet algebra A with the norms pk to the Frechet
space A with the Sobolev topology, is continuous (using (10)) and surjective. Hence
the open mapping Theorem ([24] Corollary 2.12) asserts that it is an open mapping.
This shows that the inverse map is continuous which gives the required estimates
for the norms pk . The result for the semi-norms pk ([D, a]) follows from Proposition
2.2.
3) Since A is a Frechet separable nuclear space there is a sequence xn ∈ A which
is dense in any of the continuous norms and in particular using 2) in the p0 norm.
This shows that the C ∗ -algebra A is norm separable and hence that its spectrum
is metrizable.
4) By hypothesis T being an endomorphism is of the form (4). Using the inclusion
A ⊂ A = C(X) of A in its norm closure, we can view T as an endomorphism of the
induced C ∗ -module E over A. By (6), any element of EndA (E) defines a bounded
operator in H. This shows that the graph of the operator T in H∞ × H∞ is closed
and hence by the closed graph theorem that T is continuous in the Frechet topology
of H∞ .
5) The product A × A → A is jointly continuous using the submultiplicative norms
pk of (12). This shows thatPeAn is a closed subspace of An and hence is complete.
Moreover the map (aj ) 7→      aj ξj for given ξj ∈ H∞ is continuous from An to H∞
using (10). Thus the open mapping theorem gives the result.
6) Follows from 5) and the joint continuity of the product A × A → A.               

We end this section with the stability of A under the smooth functional calculus
as shown in [22] Proposition 2.8. We repeat the proof for convenience.

Proposition 2.4. Let aj = a∗j be n self-adjoint elements of A and f : Rn 7→ C be
a smooth function defined on a neighborhood of the joint spectrum of the aj . Then
the element f (a1 , . . . , an ) ∈ A belongs to A ⊂ A.

Proof. Let us first show that for a = a∗ ∈ A one has for any k ∈ N,

(16)                      kδ k (eisa )k = O(|s|k ) , |s| → ∞ .

For k = 1 one has
                                              Z 1
                               isa
(17)                     δ(e         ) = is         eitsa δ(a)ei(1−t)sa dt
                                               0
                                                     9
which proves (16) for k = 1. In general one has, with βu (T ) = eiusa T e−iusa ,
         1 n isa −isa                                    δ k1 (a)               δ kℓ (a)
                                X              Z
(18)        δ (e )e      =              i ℓ sℓ     βu1 (          ) · · · βuℓ (          )du
         n!                                     Sℓ          k1 !                   kℓ !
                                 kj >0,   kj =n
                                 P


where Sℓ = {(uj ) | 0 ≤ u1 ≤ . . . ≤ uℓ ≤ 1} is the standard simplex. This gives
(16). Now the joint spectrum K ⊂ Rn of the aj is a compact subset and one can
extend f to a smooth function with compact support f ∈ Cc∞ (Rn ). The element
f (a1 , . . . , an ) ∈ A is then given by
                                                   Z
                                                     fˆ(s1 , . . . , sn )
                                                                          Y         Y
(19)                 f (a1 , . . . , an ) = (2π)−n
                                                                            eisj aj   dsj

where fˆ is the Fourier transform of f and is a Schwartz function fˆ ∈ S(Rn ). By
(16) the integral (19) is convergent in any of the norms pk which define the topology
of A and one gets f (a1 , . . . , an ) ∈ A.                                        




                                    3. Openness Lemma
In this section, we use the standard implicit function theorem for smooth maps
Rp → Rp to obtain the openness of the tentative local charts. We formulate the
Lemma in a rather abstract manner below and use it concretely in §7 for the local
charts.
As above and in [22], we let A be a Frechet pre-C ∗ -algebra. We recall, for involutive
algebras, the reality condition which defines a ∗-derivation:
(20)                             δ0 (a∗ ) = δ0 (a)∗ ,   ∀a ∈ A .
We let DerA be the Lie algebra of continuous ∗-derivations of A.
Definition 3.1. Let A be a Frechet pre-C ∗ -algebra. A continuous ∗-derivation
δ0 ∈ DerA exponentiates iff one has a unique solution, depending continuously on
(t, a) ∈ R × A, of the differential equation:
(21)                        ∂t y(t, a) = δ0 (y(t, a)) , y(0, a) = a .
We say that A is expable when any continuous ∗-derivation δ0 ∈ DerA exponenti-
ates.
We shall show in §§5, 6 that in our context enough derivations exponentiate but
for clarity of the argument we shall first assume that the algebra A is expable.
We refer to [16] §I.3 for the discussion of differentiability in the context of Frechet
spaces. We just recall that a map y : F → G of Frechet spaces is of class C 1 when
the following directional derivative exists and is a jointly continuous function of
(x, h) ∈ F × F ,
                                           1
(22)                        Dy(x, h) = lim (y(x + ǫh) − y(x))
                                       ǫ→0 ǫ

The map is of class C n when the higher derivatives Dk y(x, h1 , . . . , hk ) which are
defined by iteration of (22) exist and are jointly continuous functions for k ≤ n.
The map is smooth (or of class C ∞ ) iff it is of class C n for all n.
                                                  10
Proposition 3.2. One has for any a, b ∈ A,
(23)      y(t, ab) = y(t, a)y(t, b) , y(t, a∗ ) = y(t, a)∗ , y(t, a + b) = y(t, a) + y(t, b) .

(24)              y(t1 + t2 , a) = y(t1 , y(t2 , a)) , y(t, δ0 (a)) = δ0 (y(t, a)) .
Moreover y(t, a) is a smooth function of (t, a) with n-th derivative given by
                                                              Y      X                 Y
(25)   Dn y(t, a, s1 , h1 , . . . , sn , hn ) = δ0n (y(t, a))   sj +   δ0n−1 y(t, hi )   sj .
                                                                               i                   j6=i

Proof. The two equalities (23) and (24) follow from the uniqueness of the solution.
To prove (25) we consider the Frechet spaces F = R × A and G = A and compute
the first derivative Dy. One has
             y(t + ǫs, a + ǫh) − y(t, a) = y(t + ǫs, a) − y(t, a) + ǫy(t + ǫs, h)
so that
                        Dy(t, a, s, h) = sδ0 (y(t, a)) + y(t, h)
Since by (24) one has δ0k (y(t, a)) = y(t, δ0k (a)) for all k, one gets (25) by induction
on n.                                                                                   
The Taylor expansion at (t, a) is thus of the form
                                X
              y(t + s, a + h) ∼     (δ0k (y(t, a))sk + δ0k (y(t, h))sk )/k!

Lemma 3.3. Let A be commutative, and a = (aj ) be p self-adjoint elements of A.
Let χ be a character of A. Assume that there exits p derivations δj ∈ DerA such
that
     • Each δj exponentiates.
     • The determinant of the matrix χ(δj (ak )) does not vanish.
Then the image under a of any neighborhood of χ in the spectrum Spec(A) of A
contains a neighborhood of a(χ) in Rp .
Proof. By hypothesis the derivations δj ∈ DerA can be exponentiated to the corre-
sponding one parameter groups F j (t) ∈ Aut(A) of automorphisms of A. Note that
the flows F j do not commute pairwise in general. We then define a map h from Rp
to Spec(A) by
                       h = χ ◦ σ , σ(t1 ,...,tp ) = Ft11 ◦ . . . ◦ Ftpp
which defines a character since F j (t) ∈ Aut(A) by (23). The map h is continuous
since the topology of Spec(A) is the weak topology and for any a ∈ A the map
(t1 , . . . , tp ) ∈ Rp 7→ σ(t1 ,...,tp ) (a) is continuous using Definition 3.1. The coordinates
of the map φ = a ◦ h, from Rp to Rp , are given by
                φk (t1 , . . . , tp ) = h(t1 , . . . , tp )(ak ) = χ ◦ Ft11 ◦ . . . ◦ Ftpp (ak )
The map
                              (t1 , . . . , tp ) ∈ Rp 7→ Ft11 ◦ . . . ◦ Ftpp (ak )
is a smooth map from Rp to A. Indeed the maps (t, a) 7→ Ftj (a) are smooth, and
composition of smooth maps are smooth (cf. [16] Theorem 3.6.4), while the above
map is the composition:
(26)             F 1 ◦ (Id × F 2 ) ◦ · · · ◦ (Idp−2 × F p−1 ) ◦ (Idp−1 × F p (ak ))
                  F p (ak )              F p−1                                             F1
              Rp −→ Rp−1 × A −→ Rp−2 × A −→ . . . −→ R × A −→ A
                                                      11
Thus the map φ = a ◦ h, obtained by composition with the character χ which is
linear and continuous and hence smooth, is a smooth map from Rp to Rp . The
image of 0 ∈ Rp is a(χ). The partial derivatives at 0 are
                                    (∂j φk )(0) = χ(δj (ak ))
thus we know from the hypothesis of the lemma, that the Jacobian does not vanish
at 0. It then follows from the implicit function theorem that the mapping φ = a ◦ h
maps by a diffeomorphism a suitable neighborhood of 0 to a neighborhood of a(χ).
In particular the image under a of a neighborhood W of χ contains the image under
φ of h−1 (W ) which, since h is continuous, is a neighborhood of 0 ∈ Rp . This shows
that the image under a of any neighborhood of χ in the spectrum Spec(A) of A
contains a neighborhood of a(χ) in Rp .                                           
The above proof yields the following more precise statement:
Lemma 3.4. Under the hypothesis of Lemma 3.3, there exists a smooth family
σt ∈ Aut(A), t ∈ Rp , a neighborhood Z of χ in X = Spec(A) and a neighborhood
W of 0 ∈ Rp such that, for any κ ∈ Z, the map t 7→ a(κ ◦ σt ) is a diffeomorphism,
depending continuously on κ, of W with a neighborhood of a(κ) in Rp .
Proof. Let as above
(27)                             σ(t1 ,...,tp ) = Ft11 ◦ . . . ◦ Ftpp
The map which to κ ∈ X associates the map ψκ from Rp to Rp given by ψκ (t) =
a(κ ◦ σt ) yields by restriction a continuous map X → C ∞ (K, Rp ) where K is a
closed ball centered at 0 ∈ Rp . Indeed for each j the map t ∈ K 7→ σt (aj ) ∈ A is
smooth by (26) and thus its partial derivatives ∂tα σt (aj ) are elements of A which
depend continuously of t. One has
                                   ∂tα ψκj (t) = κ(∂tα σt (aj ))
and thus the partial derivatives of ψκ (t) are continuous functions of (κ, t). Since
the determinant of the jacobian χ(δj (ak )) does not vanish, the result follows from
the implicit function Theorem (see e.g. [16] Theorem 5.2.3).                       


                 4. Jacobian and openness of local charts
We first briefly recall first the well known properties of multiple commutators which
we need later.
Definition 4.1. Let Tj ∈ B be elements of a noncommutative algebra B, one lets
                                           X
                 [T1 , T2 , . . . , Tn ] =   ǫ(σ) Tσ(1) Tσ(2) · · · Tσ(n)
                                              σ

where σ varies through all permutations of {1, . . . , n} and ǫ(σ) is its signature.
We mention the following general properties
Proposition 4.2. Let Tj ∈ B be elements of a noncommutative algebra B.
   a) For any permutation α of {1, . . . , n}, one has
                    [Tα(1) , Tα(2) , . . . , Tα(n) ] = ǫ(α) [T1 , T2 , . . . , Tn ]
                                                  12
       b) If two of the Tj are equal one has
                                         [T1 , T2 , . . . , Tn ] = 0
       c) Let A ⊂ B be a commutative subalgebra and A′ ⊂ B its relative commutant
          in B. Let ajk ∈ A, γj ∈ A′ . Then, with Tk = ajk γj , one has
                                                      P

(28)                   [T1 , T2 , . . . , Tn ] = Det((ajk )) [γ1 , γ2 , . . . , γn ]
     d) The equality (28) extends to the case of a rectangular matrix ajk ∈ A as
        follows
                                        Det((ajk (F ))) [γ1 (F ), γ2 (F ), . . . , γn (F )]
                                      X
(29)        [T1 , T2 , . . . , Tn ] =
                                     F

          where the sum is over all subsets F ⊂ {1, . . . , m} with #F = n, the matrix
          ajk (F ) is the restriction of ajk to j ∈ F and the γj (F ) are the γi , i ∈ F ,
          ordered with increasing index in F .
Proof. a) This follows from ǫ(σ ◦ α) = ǫ(σ)ǫ(α).
b) The permutation of the two indices is odd, but does not affect the expression
which must vanish.
c) One has
                                                  n
                                                             ajkk [γj1 , γj2 , . . . , γjn ]
                                                 XY
(30)                 [T1 , T2 , . . . , Tn ] =
                                                 (jk ) k=1

where, a priori, the (jk ) is an arbitrary map from {1, . . . , n} to {1, . . . , n}. By the
second statement of the lemma, these terms vanish when two of the indices jk are
equal. Thus one can take the sum over permutations (jk ) and one can use the first
statement of the lemma to rewrite the corresponding term as
                          [γj1 , γj2 , . . . , γjn ] = ǫ(j) [γ1 , γ2 , . . . , γn ]
It follows that
                             [T1 , T2 , . . . , Tn ] = Det((ajk )) [γ1 , γ2 , . . . , γn ]
d) One decomposes the sum (30) according to the range F of the injection j from
{1, . . . , n} to {1, . . . , m}.                                                          
Let us now go back to spectral triples (A, H, D) fulfilling the five conditions of §2.
Lemma 4.3. Let B be the algebra of endomorphisms of H∞ . One has a finite
decomposition
                              X
(31)                 [D, a] =    δj (a)γj , ∀a ∈ A ,
where γj ∈ B and the δj are derivations of the form
(32)                          δj (a) = i(ξj |[D, a]ξj ) ,             ∀a ∈ A
for some ξj ∈ H∞ .
Proof. First [D, a]H∞ ⊂ H∞ using regularity and (10). Thus the order one condi-
tion shows that [D, a] ∈ B. One has H∞ = eAn , B = eMn (A)e for a self-adjoint
idempotent e ∈ Mn (A). Thus every element T ∈ B can be written uniquely, as any
element of Mn (A) in the form
                                X
                            T =    akℓ εkℓ , akℓ ∈ A
                                                     13
in terms of the matrix units εij . The coefficients akℓ ∈ A are uniquely determined,
using the elements ηk = eζk ∈ H∞ where ζk ∈ An is the element all of whose
components vanish except the k-th one which is equal to 1. Using the A-valued
inner product, one has
(33)                           akℓ = (ηk |T ηℓ ) = Lkℓ (T ) ,   ∀k, ℓ .
Moreover one has, since T = eT e and the akℓ commute with e:
                                    X
(34)                           T =     akℓ eεkℓ e .
One has Lkℓ (aT ) = aLkℓ (T ) for any a ∈ A. Applying this to T = [D, b], the
maps a 7→ Lij ([D, a]) give derivations of A. They are not self-adjoint but can be
decomposed as linear combinations of self-adjoint derivations, which, using (34),
gives the required formula (31). More precisely, the derivations δj can be written
using the A-valued inner product on H∞ in the form (32) for some ξj ∈ H∞
(with i to ensure self-adjointness). Indeed one obtains (32) applying to (33) the
polarization identity:
(35)               2(ξ|T η) = ((ξ + η)|T (ξ + η)) − (ξ|T ξ) − (η|T η)
                    −i (((ξ + iη)|T (ξ + iη)) − (ξ|T ξ) − (iη|T iη))
In particular, using Proposition 2.3, the δj are continuous.                      
By hypothesis the cycle c is of the form:
                   X                   X
(36)           c=     a0α ωα , ωα =       ǫ(β)1 ⊗ aβ(1)
                                                   α    ⊗ · · · ⊗ aβ(p)
                                                                   α
                       α                        β

where one can assume that the aµα are self-adjoint for µ > 0. We define the condi-
tional expectation EA : EndA (H∞ ) → A, using the projections pj of (7),
                          X1 X
(37)            EA (T ) =       pj Tkk , ∀T = (Tkℓ ) ∈ eMn (A)e
                          j>0
                              j

using the identification H∞ = eAn . We obtain a self-adjoint ρα ∈ A given6 by
                        p(p+1)   X
(38)             ρα = i 2 EA (γ      ǫ(β)[D, aβ(1)           β(p)
                                              α ] · · · [D, aα    ]) .
                                            β

One lets
(39)                               Cα = {x ∈ X | ρα (x) = 0}
and Uα = Cαc be its complement i.e. the open set where ρα does not vanish.
Lemma 4.4. The Uα form an open cover of X = Spec(A).
Each Uα is the disjoint union of the two open subsets Uα± corresponding to the sign
of ρα ,
                             ±ρα (x) > 0 , ∀x ∈ Uα± .
Proof. It is enough to show that any x ∈ X belongs to some Uα . One has πD (c) = γ,
so that by (36)
                      X       X
                    γ     a0α    ǫ(β)[D, aβ(1)           β(p)
                                          α ] · · · [D, aα    ] = 1.
                           α        β

  6there is no γ in the odd case

                                                    14
By (38) and the conditional expectation module property EA (aT ) = aEA (T ),
                                p(p+1) X
                             i− 2        a0α ρα = 1
                                                  α

and ρα (x) 6= 0 for some α. The second statement follows since ρα is a non-vanishing
real valued function on Uα .                                                      
We let sα be the natural continuous map from X to Rp given by
(40)                          χ ∈ Spec(A) → (χ(ajα )) ∈ Rp .
Lemma 4.5. Assume that derivations of the form (32) exponentiate. Let χ ∈ Uα .
   • There exists p derivations δj ∈ Der(A) such that χ(Det((δj (akα )))) 6= 0
   • The map aα from Uα to Rp is open.
   • There exists a smooth family σt ∈ Aut(A), t ∈ Rp , a neighborhood Z of χ
     in X = Spec(A) and a neighborhood W of 0 ∈ Rp such that, for any κ ∈ Z,
     the map t 7→ sα (κ ◦ σt ) is a diffeomorphism, depending continuously on κ,
     of W with a neighborhood of a(κ) in Rp .
Proof. We let, as above, B be the algebra of endomorphisms of the A-module H∞ .
It contains A ⊂ B as a subalgebra of its center. By Lemma 4.3, one has derivations
δj ∈ Der(A) of the form (32), such that the formula (31) holds:
                                          m
                                          X
                             [D, a] =          δj (a)γj ,     ∀a ∈ A .
                                           1

By hypothesis we have ρα (χ) 6= 0. Thus, the following endomorphism of the A-
module H∞ does not vanish,
                  [[D, a1α ], [D, a2α ], . . . , [D, apα ]](χ) 6= 0 ,   ∀χ ∈ Uα .
It thus follows, from (29) of proposition 4.2, that for χ ∈ Uα one can find p elements
δj ∈ Der(A) among the above δj such that:
(41)                                χ(Det((δj (akα )))) 6= 0 .
Now let V ⊂ Uα be open. To show that sα (V ) is open one needs to show that, for
any χ ∈ V , sα (V ) contains a neighborhood of sα (χ). But V is a neighborhood of χ
in Spec(A) and the hypothesis of Lemma 3.3 is fulfilled so that this lemma shows
that sα (V ) contains a neighborhood of sα (χ). The third statement follows from
Lemma 3.4.                                                                       


                               5. Dissipative derivations
We assumed in the above discussion that the algebra A is expable. It is of course
desirable to remove this hypothesis, and this will be done in this section and the next
one. We need a form of existence and uniqueness for solutions of linear differential
equations with values in a Frechet space E. Simple examples show that in that
generality one has neither existence nor uniqueness. For failure of existence just let
A = C ∞ ([0, 1]), δ0 = ∂x . For failure of uniqueness, let E be the space of sequences
xn ∈ R for n ≥ 1 and take the shift operator S, then the equation
                                ∂t x = Sx , (Sx)n = xn+1 ,
                                                  15
                                          X
                                                                sΑ



                                                                      x
                                          XΑ




                      Figure 1. The map sα from X to Xα

has no uniqueness of solutions. Indeed we can take for x1 (t) any smooth function
which is flat at t = 0, i.e. ∂tn x1 (0) = 0, and then define by induction xn+1 (t) =
∂t xn (t) so that ∂t x = Sx holds and the initial condition x(0) = 0 does not imply
uniqueness.
In our case we need to know that any derivation δ ∈ DerA can be exponentiated,
i.e. that one has existence and uniqueness for the differential equation
                             dy(t)
                                     = δ(y(t)) , y(t) ∈ A .
                               dt
It is only the compactness of X that ensures this, and also the fact that one is
dealing with a real vector field. This means that we first need to make sure that
the derivation exponentiates at the level of the C ∗ -algebra as discussed in [2].
One step towards this would be to show directly the following corollary of expability:
Lemma 5.1. Assume that the derivations of the form the form (32) exponentiate,
then, for any h = h∗ ∈ A, the commutator [D, h] vanishes where7 h reaches its
maximum. Conversely if this property holds the derivations ±δj of the form (32)
are dissipative (cf. [2], Definition 1.4.6), i.e.
(42)                   kx + λδj (x)k ≥ kxk , ∀x ∈ A , λ ∈ R .
                                     P
Proof. One has, by (31), [D, h] =      δj (h)γj where δj ∈ DerA. Thus it is enough
to show that δj (h)(χ) = 0 where h = h∗ ∈ A reaches its maximum at χ. This
follows from the existence of etδj ∈ Aut(A) using the differentiable function f (t) =
χ(etδj (h)) which has a maximum at t = 0 and hence vanishing derivative.
Conversely, the derivations δj are of the form (32) i.e. δj (h) = i(ξ|[D, h]ξ). Thus
the vanishing of [D, h](χ) where h = h∗ ∈ A reaches its maximum, ensures that
δj (h)(χ) = ihξ(χ), [D, h](χ)ξ(χ)i = 0 also vanishes. Thus one has
                    kh + λδj (h)k ≥ khk ,     ∀h = h∗ ∈ A , λ ∈ R ,
  7This makes sense since [D, h] commutes with h

                                            16
since for a character χ of A with χ(±h) = khk one has χ(±(h + λδj (h))) = khk. In
the complex case i.e. for an arbitrary x ∈ A, let ψ be a state on A ⊃ A, such that
|ψ(x)| = kxk. Replacing x 7→ ux for u ∈ C, |u| = 1, one can assume that ψ(x) > 0.
Then writing x = h + ik with h = h∗ and k = k ∗ , one has ψ(x) = ψ(h) = khk so
that ψ(δj (h)) = 0 from the above discussion. Then one has, for λ ∈ R,
                         ψ(x + λδj (x)) = ψ(h) + iλψ(δj (k))
and |ψ(x + λδj (x))| ≥ ψ(h) = kxk.                                                
Note that the commutativity of [D, h] with h and the self-adjointness of D do not
suffice to entail the conclusion of Lemma 5.1. This can be seen with the following
spectral triple:
                                                                    
                    ∞                 2         2            0   ∂x
(43)        A = C ([0, 1]) , H = L ([0, 1]) ⊗ C , D =
                                                           −∂x 0
with the boundary condition
                                          
                                      ξ1
(44)             DomD = {ξ =                   | ξ1 (0) = 0 , ξ2 (1) = 0} .
                                      ξ2
For any h ∈ A one has [D, h] = ∂x hγ1 ,
                                            
                                        0 1
                               γ1 =
                                        −1 0
so that [D, h] commutes with h. For h(x) = x the maximum is at x = 1 and [D, h]
does not vanish there. This example shows that the hypothesis of expability of the
algebra A appears at first sight as essential. However, in this example, condition 5
fails since the boundary condition (44) does not yield a finite projective submodule
of C ∞ ([0, 1]) ⊗ C2 over A = C ∞ ([0, 1]). Also [D, h] = ∂x hγ1 does not preserve
the domain of D which is the same as the domain of |D| thus regularity fails.
Orientability also fails in this example. We shall now show that regularity allows
in fact to obtain the required dissipativity.
Let us consider the one parameter group of automorphisms of L(H) given by
(45)                       αt (T ) = eitD T e−itD ,          ∀t ∈ R
Lemma 5.2. Let T preserve DomD and [D, T ] be bounded. Then the function
t 7→ αt (T ) is norm continuous,
(46)                     kαs (T ) − αt (T )k ≤ |s − t| k[D, T ]k
and when s → 0 the difference quotient
                                                Z s
                           αs (T ) − T   i
(47)                                   =                αt ([D, T ])dt
                                s        s          0
converges to i[D, T ] in the strong topology.
Proof. Let ξ ∈ DomD. Then 1s (eisD − 1)ξ → iDξ (in norm) when s → 0. Thus
using
           1 isD −isD            1                       1
             (e T e      − T )ξ = eisD T (e−isD − 1)ξ + (eisD − 1)T ξ
           s                     s                       s
one gets that (in norm) when s → 0
                         1 isD −isD
                           (e T e     − T )ξ → i[D, T ]ξ
                         s
                                               17
Thus t 7→ αt (T )ξ is of class C 1 . Its derivative is t 7→ iαt ([D, T ])ξ. Thus
                                                 Z s
(48)                    (αs (T ) − αt (T ))ξ = i     αu ([D, T ])ξdu
                                                  t
holds for all ξ ∈ DomD and hence all ξ ∈ H since the map u 7→ αu ([D, T ])ξ is
continuous, as follows from the continuity of s 7→ eisD η for any η ∈ H. Both
statements follow.                                                          
We can now consider the C ∗ -algebra C generated by the αs (h) for h = h∗ ∈ A
as above. It is norm separable and the αs ∈ Aut(C) form a norm continuous one
parameter group. To try and prove that [D, h] vanishes where h = h∗ ≥ 0 reaches
its maximum, one considers a state φ on C such that φ(h) = khk. It is obtained by
extension using the inclusion C ∗ (h) ⊂ C. The function
                                     f (s) = φ(αs (h))
is a Lipschitz function and reaches its maximum: khk at s = 0. Thus if one could
assert that the derivative at s = 0 is given by φ([D, h]), one would get the vanishing
φ([D, h]) = 0. The problem is that αu ([D, h]) is not in general a norm continuous
function of u and thus the differentiability only holds in the strong topology but
not in the norm topology.
Things are easier with |D| since the regularity conditions ensures that the map
(49)                           t → γt (a) = eit|D| ae−it|D|
is in fact of class C ∞ in the norm topology (cf. Lemma 13.3 of §13). Moreover the
following Lemma shows that it is enough to show the vanishing of [[D2 , a], b] at χ
for all b ∈ A to get the vanishing of [D, a] at χ.
Lemma 5.3. Let h = h∗ ∈ A and χ ∈ Spec(A). If [[D2 , h], h] vanishes at χ then
[D, h] vanishes at χ.
Proof.
(50)                              [[D2 , h], h] = 2[D, h]2
using the order one condition.                                                         
                                     2                                             2
Note that (50) shows that [D, h] and hence |[D, h]| only depends upon D and
hence |D| and not upon the phase of the polar decomposition of D. This comes
from the order one condition. Moreover one has the following vanishing of [|D|, h]
where h = h∗ ∈ A reaches its maximum.
Lemma 5.4. For any h = h∗ ∈ A, h ≥ 0, reaching its maximum at χ ∈ Spec(A)
and any sequence bn ∈ A, kbn k ≤ 1, with support tending to {χ}, one has
(51)                               kb∗n [|D|, h]bn k → 0
Proof. Let ξn ∈ H be unit vectors with support tending to {χ}. Then consider any
limit state on L(H):
(52)                              η(T ) = limhξn , T ξn i
                                            ω
One has η(h) = h(χ) since h is a continuous function on X = Spec(A). Thus
η(h) = khk. When applied to |D| instead of D, Lemma 46 shows that both γs (h)
and γs (δ(h)) are Lipschitz functions of s, while
                       γs (h) − h   1 s
                                      Z
(53)                              =        γt (iδ(h))dt → iδ(h)
                            s       s 0
                                             18
so that γs (h) is of class C 1 in norm. It follows that the function s 7→ η(γs (h))
is of class C 1 . It is maximal for s = 0 and hence its derivative vanishes so that
η(δ(h)) = 0. Thus
(54)                                 limhξn , δ(h)ξn i = 0
                                       ω

and this continues to hold for any bounded sequence ξn ∈ H with support tending
to {χ}. Now, let bn be as in the Lemma, then if (51) does not hold, one can find
a subsequence nk with kb∗nk [|D|, h]bnk k ≥ ǫ > 0 for all k. Using polarization (35),
one gets unit vectors ξk′ ∈ H such that
                              |hξk′ , b∗nk [|D|, h]bnk ξk′ i| ≥ ǫ′ > 0
which contradicts (54), for ξk = bnk ξk′ .                                            

We shall use the analogue in our context of the notion of symbol for pseudodiffer-
ential operators. The symbol of T can be viewed as a weak limit of the conjugate
operators of the form
                            τ −k eiτ φ T e−iτ φ , τ → ∞
where the integer k is the order of T . For instance the symbol of D is given by
−i[D, φ] since the order one condition gives
(55)                        τ −1 eiτ φ De−iτ φ = −i[D, φ] + τ −1 D
One expects the symbol of D2 to be of the form
                        1
(56)              lim       eiτ φ D2 e−iτ φ ξ = −[D, φ]2 ξ ,      ∀ξ ∈ DomD2
                 τ →∞ τ 2

This is obtained by squaring (55) but one needs to know that DomD is invariant
under [D, φ] to control the term D [D, φ]. This is insured by regularity.
Remark 5.5. In the example (43) considered above, [D, φ] does not map DomD2
to DomD so that D [D, φ]ξ does not make sense in that case. In fact regularity
fails, and DomD2 is not invariant under φ, unless [D, φ] vanishes on the boundary.
To see this note that the boundary condition for D2 is
                
             ξ1
(57) ξ =           ∈ DomD2 ⇔ ξ1 (0) = 0 , ∂x ξ2 (0) = 0 , ξ2 (1) = 0 , ∂x ξ1 (1) = 0 .
             ξ2
which contains the Neumann condition ∂x ξ2 (0) = 0 while ξ2 (0) is arbitrary. Thus
∂x φξ2 (0) = ∂x φ(0)ξ2 (0) vanishes only when ∂x φ(0) = 0.
In the case of an operator of order 0 there is no power of τ and one deals with a
bounded family so that one can expect the limit to be a weak limit. We need to
guess the symbol of [|D|, h]. We expect that if we choose φ = h, this symbol will just
be i|[D, h]| ∈ End S. The symbol of [D2 , h] is (using [D2 , h] = D[D, h] + [D, h]D)
(58)    τ −1 eiτ φ [D2 , h]e−iτ φ = −i([D, φ][D, h] + [D, h][D, φ]) + τ −1 [D2 , h]
To see why we should expect the symbol of [|D|, h] for φ = h to just be i|[D, h]| we
have:
Lemma 5.6. Assume that when τ → ∞ the following limit holds in the strong
topology:
                       lim eiτ h [|D|, h]e−iτ h = T .
                                τ →∞
                                                19
Then one has, with strong convergence on DomD:
                            lim τ −1 eiτ h |D|e−iτ h = −iT .
                           τ →∞

Proof. One defines a one parameter group βu of automorphisms:
(59)                              βu (Y ) = eiuh Y e−iuh
                                  d
One has, at the formal level, du    βu (Y ) = −iβu ([Y, h]). Taking Y = |D| one gets,
with the notations of the Lemma, and using regularity
                                           d
(60)             eiuh [|D|, h]e−iuh ξ = i βu (|D|)ξ , ∀ξ ∈ Dom|D|
                                          du
which gives
           Z τ
(61)           eiuh [|D|, h]e−iuh ξdu = i(βτ (|D|) − |D|)ξ , ∀ξ ∈ Dom|D|
             0
Note that this equality continues to hold for any ξ ∈ H since βτ (|D|) − |D| is
a bounded operator. Now eiuh [|D|, h]e−iuh is uniformly bounded and converges
strongly by hypothesis to T . Thus one has, for the Cesaro mean:
                         Z τ
                      −1
                lim τ         eiuh [|D|, h]e−iuh ξ du = T ξ , ∀ξ ∈ H
                 τ →∞       0
which gives the result since one controls τ −1 |D|ξ → 0 for ξ ∈ DomD.                 
Moreover we expect the symbol map to be a morphism so that the symbol of |D|
is given by the absolute value of the symbol of D i.e. by |[D, h]|. In fact we do not
need to prove the converse of Lemma 5.6 since we can use the regularization by
Cesaro mean to compose the states η, with weak limits of Cτ (T ),
                                            Z τ
(62)                         Cτ (T ) = τ −1     βu (T )du
                                                 0

Lemma 5.7. With h as above one has
  (1) Cτ is a completely positive map from L(H) to itself and Cτ (1) = 1
  (2) Cτ (aT b) = aCτ (T )b for all a, b ∈ A.
  (3) Cτ ([|D|, h]) = τi (eiτ h |D|e−iτ h − |D|)
Proof. The first two statements follow from (62) using the commutativity of A to
get βu (aT b) = aβu (T )b. The last statement follows from (61).              
We can then compose the vector states hξn , • ξn i used in the construction of η (52)
with Cτn to replace [|D|, h] by i|[D, h]|.
Thus we need to determine the principal symbol of |D|. The intuitive idea is as
follows: one has
(63)                    βτ (D) = eiτ h De−iτ h = D − iτ [D, h]
since h commutes with [D, h] so that [D, f (h)] = f ′ (h)[D, h] for f smooth (cf. [17]).
Thus, by homogeneity of the absolute value,
               1           1                   D
(64)             βτ (|D|) = eiτ h |D|e−iτ h = | − i[D, h]| , ∀τ > 0
               τ           τ                   τ
                                            1
We need the weak limit in H for τ → ∞ of τ βτ (|D|)ξ for ξ ∈ DomD. These vectors
are bounded in norm as follows from
           1
(65)      k βτ (|D|)ξk = k|ǫD − i[D, h]|ξk = k(ǫD − i[D, h])ξk , ǫ = 1/τ
           τ
                                            20
which is bounded since ξ ∈ DomD so that kǫDξk → 0. Note also that τ1 βτ (|D|) is
a positive operator so that any weak limit η of τ1 βτ (|D|)ξ fulfills hξ, ηi ≥ 0.
Let us now show how to use regularity to obtain the strong convergence of
                             1
(66)                           βτ (|D|)ξ = |ǫD − i[D, h]|ξ
                             τ
when ǫ → 0 and ξ ∈ DomD. By (65) we can assume that ξ ∈ H∞ . We let
X(ǫ) = ǫD − i[D, h]. By (63) it is a self-adjoint operator with H∞ as a core since
H∞ is invariant under eiτ h . The same holds for |X(ǫ)|.
Lemma 5.8. One has, with X(ǫ) = ǫD − i[D, h],
(67)                          |X(ǫ)| = Y (ǫ) + f0 (X(ǫ))
where
                             Z ∞
                         2             X(ǫ)2
(68)            Y (ǫ)ξ =                          ξ du ,   ∀ξ ∈ DomD
                         π   0     1 + u2 + X(ǫ)2
and
(69)                  f0 (x) = |x| − x2 (1 + x2 )−1/2 ,    ∀x ∈ R
Proof. For any self-adjoint operator T one has k(1 + u2 + T 2 )−1 k ≤ (1 + u2 )−1 and
the norm convergent expression
                                               Z ∞
                                            2             1
                         (1 + T 2 )−1/2 =                     du
                                            π 0 1 + u + T22

which gives for any ξ ∈ DomT ,
                                              2 ∞          T2
                                                 Z
                      T 2 (1 + T 2 )−1/2 ξ =                   ξ du
                                              π 0 1 + u2 + T 2
Note that the partial sums           Z v
                                               T
                                                2 + T2
                                                       du
                                      0   1 + u
are uniformly bounded but do not converge in norm to T (1 + T 2 )−1/2 since the
function x(1 + x2 )−1/2 does not vanish at ∞. Thus we get strong convergence
on DomT . This applies to X(ǫ) which is, up to a scale factor, conjugate to D
by an automorphism of DomD so that (68) holds with Y (ǫ) = f (X(ǫ)), f (x) =
x2 (1 + x2 )−1/2 . Finally one has f0 ∈ C0 (R) and f (x) + f0 (x) = |x|.            
For each λ ≥ 0 we define a transformation on operators acting in H∞ by
(70)                      θλ (T ) = (D2 + λ)T (D2 + λ)−1
Lemma 5.9. Let h = h∗ ∈ A, there exists λ < ∞ such that
                                             1
(71)          kθλ ((1 + u2 + X(0)2 )−1 )k ≤ ( + u2 )−1 , ∀u .
                                             2
Proof. Let ξ ∈ H∞ and let us give a lower bound for kθλ (1 + u2 + X(0)2 )ξk. Using
(72)                      θλ (T ) = T + [D2 , T ](D2 + λ)−1
we get
(73)               θλ (X(0)2 ) = X(0)2 − [D2 , [D, h]2 ](D2 + λ)−1
Now the regularity shows (cf. §13) that [D2 , [D, h]2 ](D2 + λ)−1 is compact so that
for λ → ∞ its norm goes to 0 (in fact it is of the form Bλ (D2 + λ)−1/2 with the
                                           21
norm of Bλ bounded, so its norm decays like λ−1/2 ). Thus we can choose λ large
enough so that Z = θλ (X(0)2 ) − X(0)2 fulfills kZk ≤ 1/2. We then get
                                                                      1
    hξ, θλ (1 + u2 + X(0)2 )ξi ≥ hξ, 1 + u2 + X(0)2 ξi − |hξ, Zξi| ≥ ( + u2 )kξk2
                                                                      2
              2         2
(using X(0) = −[D, h] ≥ 0) so that
                                             1
(74)             kθλ (1 + u2 + X(0)2 )ξk ≥ ( + u2 )kξk , ∀ξ ∈ H∞ .
                                             2
It remains to show that θλ (1+u2 +X(0)2 ) is invertible as an operator acting in H∞ .
Since D2 + λ is an automorphism of H∞ , it is enough to show that 1 + u2 + X(0)2
is invertible as an operator acting in H∞ . One has X(0)2 = −[D, h]2 ≥ 0 so that
1 + u2 + X(0)2 is invertible as an operator in H. Its invertibility in H∞ follows from
the stability under smooth functional calculus (Proposition 2.4) of the algebra
                    {T ∈ L(H) | T H∞ ⊂ H∞ , kδ m (T )k < ∞ , ∀m}
and the fact that, by regularity, [D, h] belongs to this algebra.                          
Lemma 5.10. Let h = h∗ ∈ A, then when ǫ → 0,
(75)                          Y (ǫ)ξ → Y (0)ξ ,        ∀ξ ∈ H∞
Proof. One has for the action on H∞ ,
          X(ǫ)2 = (ǫD − i[D, h])2 = ǫ2 D2 − iǫ(D[D, h] + [D, h]D) − [D, h]2
                              = ǫ2 D2 − iǫ[D2 , h] − [D, h]2
We first estimate, for ξ ∈ H∞ ,
                                      X(ǫ)2            X(0)2
                    η(u, ǫ) = (                  −                )ξ
                                  1 + u2 + X(ǫ)2   1 + u2 + X(0)2
One has
                                              1                   1
              η(u, ǫ) = (1 + u2 )(                      −                    )ξ =
                                       1 + u2 + X(0)2       1 + u2 + X(ǫ)2
                        1 + u2                             1
                                   (X(ǫ)2 − X(0)2 )                ξ
                    1 + u2 + X(ǫ)2                  1 + u2 + X(0)2
                        1 + u2                                 1
                =                  (ǫ2 D2 − iǫ[D2 , h])                ξ
                    1 + u2 + X(ǫ)2                      1 + u2 + X(0)2
       1 + u2
 =                (ǫ2 D2 − iǫ[D2 , h])(D2 + λ)−1 θλ ((1 + u2 + X(0)2 )−1 )(D2 + λ)ξ
   1 + u2 + X(ǫ)2
Now one has, using regularity,
                    k(ǫ2 D2 − iǫ[D2 , h])(D2 + λ)−1 k = k(ǫ) = O(ǫ)
while, since X(ǫ) is self-adjoint,
                                           1 + u2
                                   k                  k ≤ 1.
                                       1 + u2 + X(ǫ)2
Moreover (D2 + λ)ξ ∈ H∞ ⊂ H. By Lemma 5.9, for λ large enough, one thus gets
                                               1
       kθλ ((1 + u2 + X(0)2 )−1 )(D2 + λ)ξk ≤ ( + u2 )−1 k(D2 + λ)ξk ,              ∀u .
                                               2
                                                  22
Thus after integrating in u we get the following estimate
                                Z ∞
                             2            1
        k(Y (ǫ) − Y (0))ξk ≤         k(ǫ)( + u2 )−1 k(D2 + λ)ξkdu = O(ǫ)
                             π 0          2
which gives the required result.                                                              

It remains to estimate the continuity for ǫ → 0 of f0 (X(ǫ))ξ. The above proof shows
that for ga (x) = (a + x2 )−1 and any a > 0 one has the norm continuity of ga (X(ǫ))ξ
when ǫ → 0 (we showed convergence only for ξ ∈ H∞ but it holds in general using
the boundedness of the functions ga ). The even functions in f ∈ C0 (R) for which
the following holds
(76)                      kf (X(ǫ))ξ − f (X(0))ξk → 0 ,          ∀ξ ∈ H
                                                 even
form a norm closed subalgebra of C0 (R)     . This algebra contains the functions
ga , thus the Stone-Weierstrass Theorem shows that (76) holds for all f ∈ C0 (R)even
and in particular for f0 . We thus get:
Proposition 5.11. Let h = h∗ ∈ A, then one has, with norm convergence:
(77)                lim τ −1 eiτ h |D|e−iτ h ξ = |[D, h]|ξ ,     ∀ξ ∈ DomD .
                   τ →∞

Proof. By (66) we just need to show that |X(ǫ)|ξ → |X(0)|ξ when ǫ → 0 for any
ξ ∈ H∞ . By (67) |X(ǫ)| = Y (ǫ) + f0 (X(ǫ)). By Lemma 5.9 we have Y (ǫ)ξ → Y (0)ξ
for ξ ∈ H∞ , and by the above discussion f0 (X(ǫ))ξ is continuous at ǫ = 0. Thus
we get the required result for ξ ∈ H∞ . The general case ξ ∈ DomD follows using
(65).                                                                          

Remark 5.12. Proposition 5.11 shows that, under the regularity hypothesis,
(78)                      [|[D, h]|, [D, a]] = 0 ,     ∀h = h∗ , a ∈ A .
Indeed one has
                       [eiτ h |D|e−iτ h , [D, a]] = eiτ h [|D|, [D, a]]e−iτ h
and the norm of [|D|, [D, a]] is finite so that τ −1 k[eiτ h |D|e−iτ h , [D, a]]k → 0 for
τ → ∞. Thus one has
       lim τ −1 (eiτ h |D|e−iτ h [D, a]ξ − [D, a]eiτ h |D|e−iτ h ξ) = 0 ,       ∀ξ ∈ DomD ,
       τ →∞

and, since [D, a] preserves DomD,
                           [|[D, h]|, [D, a]]ξ = 0 ,     ∀ξ ∈ DomD .
Note also that, by the same argument, under the strong regularity hypothesis of
Definition 6.1 below, this shows that
(79)                            [D, h]2 ∈ A ,        ∀h = h∗ ∈ A .
Indeed |[D, h]| then commutes with all endomorphisms of H∞ . Its square [D, h]2 ,
being itself an endomorphism, belongs to the center of EndA (H∞ ) and is, by (9),
an element of A.
We can now show that regularity suffices to ensure the dissipative property of
Lemma 5.1.
                                                23
Theorem 5.13. Let (A, H, D) be a regular spectral triple with A commutative
fulfilling the order one condition. Then for any h = h∗ ∈ A, the commutator [D, h]
vanishes where h reaches its maximum, i.e. for any sequence bn ∈ A, kbn k ≤ 1,
with support tending to {χ}, where χ is a character such that |χ(h)| is maximum,
one has
                                    k[D, h]bn k → 0 .
Proof. By Proposition 5.11 combined with the third statement of Lemma 5.7 one
has, first for ξ ∈ DomD and then by uniformity for all ξ ∈ H,
                                          i
          lim Cτ ([|D|, h])ξ = lim            (eiτ h |D|e−iτ h ξ − |D|ξ) = i|[D, h]|ξ
          τ →∞                     τ →∞ τ

and thus the Cτ ([|D|, h]) converge strongly to i|[D, h]| when τ → ∞. By the second
statement of Lemma 5.7, one has
(80)                       Cτ (b∗n [|D|, h]bn ) = b∗n Cτ ([|D|, h])bn
Thus fixing n and taking the limit for τ → ∞ one gets
(81)                        Cτ (b∗n [|D|, h]bn ) → ib∗n |[D, h]|bn
One thus gets
(82)                         kb∗n |[D, h]|bn k ≤ kb∗n [|D|, h]bn k
But Lemma 5.4 shows that kb∗n [|D|, h]bn k → 0 when n → ∞ which gives the re-
quired result. Moreover, since |[D, h]| commutes with the bn this can be formulated
as k[D, h]bn k → 0 .                                                             
Corollary 5.14. Let (A, H, D) be a spectral triple with A commutative fulfilling
the five conditions of §2. The derivations ±δj of Lemma 4.3 are dissipative.
Proof. This follows from Theorem 5.13 and Lemma 5.1.                                    
Corollary 5.15. Let h = h∗ ∈ A. The principal symbol of the operator
(83)                                 Grad(h) = [D2 , h]
vanishes where h reaches its maximum.
Proof. One has [D2 , h] = D[D, h] + [D, h]D and since [D, h] commutes with A one
gets the principal symbol of [D2 , h] from that of D which gives
                       1 iτ φ 2
(84)             lim    e [D , h]eiτ φ = −i([D, φ][D, h] + [D, h][D, φ])
                τ →∞ τ

Thus the result follows from Theorem 5.13.                                              


                       6. Self-adjointness and derivations
We now introduce a technical hypothesis which will play an important role.
Definition 6.1. A spectral triple is strongly regular when all endomorphisms of
the A-module H∞ are regular.
Our goal is to obtain self-adjoint operators from the operator D, in the form A∗ DA
where A is regular i.e. belongs to the domains of δ m for all m.
                                                24
Lemma 6.2. Let A be regular, then ADomD ⊂ DomD and the adjoint of A∗ D is
the closure of the densely defined operator T
(85)              DomT = DomD , T ξ = D(Aξ) ,          ∀ξ ∈ DomD
Proof. By regularity both A and A∗ preserve the domain Dom|D| = DomD so that
(85) makes sense. The domain of A∗ D is the domain of D. An η ∈ H belongs to
the domain of the adjoint S = (A∗ D)∗ when there exists a constant C < ∞ such
that
(86)                    |hA∗ Dξ, ηi| ≤ Ckξk ,   ∀ξ ∈ DomD
One has hA∗ Dξ, ηi = hDξ, Aηi and, since D is self-adjoint, the above condition
means that Aη ∈ DomD. Moreover one then has Sη = DAη. In other words
S = DA with domain
(87)         DomS = {η | Aη ∈ DomD} , Sξ = D(Aξ) ,             ∀ξ ∈ DomS
To prove the Lemma we need to show that S is the closure of the operator T of
(85). Let η ∈ DomS. We construct a sequence ηn ∈ DomD such that
(88)                         ηn → η , DAηn → DAη
In fact we let
(89)                      η(ǫ) = (1 + ǫ|D|)−1 η ,   ∀ǫ > 0 .
It belongs to DomD by construction and η(ǫ) → η when ǫ → 0. One has
         DAη(ǫ) = D(1 + ǫ|D|)−1 Aη + ǫD(1 + ǫ|D|)−1 [|D|, A](1 + ǫ|D|)−1 η
Since Aη ∈ DomD one has D(1 + ǫ|D|)−1 Aη = (1 + ǫ|D|)−1 DAη → DAη. The
remainder is of the form B(ǫ)[|D|, A]η(ǫ) where B(ǫ) = ǫD(1 + ǫ|D|)−1 is of norm
less than 1, [|D|, A] is bounded and η(ǫ) → η. Thus it behaves like B(ǫ)[|D|, A]η
and hence tends to 0 when ǫ → 0, since B(ǫ)ζ → 0 for any ζ ∈ H. This shows that
DAη(ǫ) → DAη and S is the closure of T .                                       
Corollary 6.3. Let ϕ = ϕ∗ ∈ A then the operator H = ϕDϕ with domain DomD
is essentially self-adjoint.
Proof. One has H = ϕ2 D + ϕ[D, ϕ] on DomD. The bounded perturbation P =
ϕ[D, ϕ] does not alter the domain of the adjoint H ∗ which is thus the same as
the domain of H0∗ , H0 = ϕ2 D. By Lemma 6.2, the adjoint of H0 is the closure of
Dϕ2 with domain DomD. This is the same as the closure of ϕDϕ + [D, ϕ]ϕ with
domain DomD. Since [D, ϕ]ϕ is bounded we thus get that the adjoint H0∗ of H0
is the sum of the closure of ϕDϕ with domain DomD with the bounded operator
[D, ϕ]ϕ. Thus when adding P ∗ = −[D, ϕ]ϕ to H0∗ we obtain the closure of ϕDϕ
with domain DomD, i.e. the operator H.                                        
Lemma 6.4. Let A be regular. Then A∗ D is closable and
   • For any ξ in the domain of the closure A∗ D of A∗ D, one has, for ǫ > 0,
(90) (1+ǫ|D|)−1 A∗ Dξ = A∗ D(1+ǫ|D|)−1 ξ −(1+ǫ|D|)−1 [|D|, A∗ ]ǫD(1+ǫ|D|)−1 ξ
       • The domain of A∗ D is the set of ξ ∈ H for which the A∗ D(1 + ǫ|D|)−1 ξ
         converge in norm for ǫ → 0.
       • The limit of the A∗ D(1 + ǫ|D|)−1 ξ gives A∗ Dξ.
                                         25
Proof. The operator A∗ D is closable since its adjoint is densely defined by Lemma
6.2. The right hand side of (90) is a bounded operator, thus it is enough to prove
the equality for ξ ∈ DomD since A∗ D is the closure of its restriction to DomD. For
ξ ∈ DomD (90) follows from
              [(1 + ǫ|D|)−1 , A∗ ] = −(1 + ǫ|D|)−1 [ǫ|D|, A∗ ](1 + ǫ|D|)−1 .
Let then ξ be in the domain of the closure A∗ D. By (90), A∗ D(1 + ǫ|D|)−1 ξ is the
sum of (1 + ǫ|D|)−1 A∗ Dξ → A∗ Dξ, and of (1 + ǫ|D|)−1 [|D|, A∗ ]ǫD(1 + ǫ|D|)−1 ξ
which converges to 0 in norm since (1 + ǫ|D|)−1 [|D|, A∗ ] is uniformly bounded while
ǫD(1+ǫ|D|)−1 ξ converges to 0 in norm. Thus A∗ D(1+ǫ|D|)−1 ξ is convergent when
ǫ → 0. Conversely, if the A∗ D(1 + ǫ|D|)−1 ξ converge in norm for ǫ → 0, then since
(1 + ǫ|D|)−1 ξ → ξ and (1 + ǫ|D|)−1 ξ ∈ DomD, one gets that ξ is in the domain
of the closure A∗ D of A∗ D and that moreover the limit of the A∗ D(1 + ǫ|D|)−1 ξ
gives A∗ Dξ.                                                                       

Proposition 6.5. Let A be regular then the operator H = A∗ DA with domain
DomD is essentially self-adjoint. The domain of the closure of H is the set of
ξ ∈ H for which the A∗ DA(1 + ǫ|D|)−1 ξ converge in norm for ǫ → 0. The limit of
the A∗ DA(1 + ǫ|D|)−1 ξ gives Hξ.
Proof. Let us first check that H is symmetric. One has for ξ and η in DomD,
       hHξ, ηi = hA∗ DAξ, ηi = hDAξ, Aηi = hAξ, DAηi = hξ, A∗ DAηi = hξ, Hηi
Let us now show that H ∗ is the closure of H. Let η ∈ DomH ∗ . Then there exists
C < ∞ with
                     |hA∗ DAξ, ηi| ≤ Ckξk , ∀ξ ∈ DomD .
Since hA∗ DAξ, ηi = hDAξ, Aηi, this means that Aη is in the domain of the adjoint
of DA with domain DomD i.e.
                             Aη ∈ DomT ∗ , H ∗ η = T ∗ Aη
where T is defined in (85). By Lemma 6.2 the adjoint of A∗ D is the closure of T :
(A∗ D)∗ = T̄ . The adjoint T ∗ of T is the same as the adjoint of the closure T̄ , and
is the closure A∗ D = (A∗ D)∗∗ of A∗ D. Thus by Lemma 6.4 we have, since Aη is
in the domain of A∗ D, the convergence of A∗ D(1 + ǫ|D|)−1 Aη to A∗ DAη = H ∗ η.
Moreover, as above, we have
A∗ D(1+ǫ|D|)−1 Aη−A∗ DA(1+ǫ|D|)−1 η = −A∗ ǫD(1+ǫ|D|)−1 [|D|, A](1+ǫ|D|)−1 η
and the right hand side converges to 0 in norm when ǫ → 0. Thus we have shown
that for any η ∈ DomH ∗ one gets the convergence of A∗ DA(1 + ǫ|D|)−1 η to H ∗ η.
This shows, since (1 + ǫ|D|)−1 η ∈ DomH, that H ∗ is the closure of H and hence
that H is essentially self-adjoint. It also gives a characterization of the domain of
the closure of H as required.                                                      

We now want to apply this result using endomorphisms of the A-module H∞ which
are of rank one, in order to obtain an operator on A itself.
Lemma 6.6. Let ξ, η ∈ H∞ then the following gives an endomorphism of the
A-module H∞ :
(91)                         Tξ,η (ζ) = (η|ζ)ξ ,   ∀ζ ∈ H∞
                                            26
where (η|ζ) is the A-valued inner product. One has
(92)                Taξ, bη = ab∗ Tξ,η ,                ∗
                                           ∀a, b ∈ A , Tξ,η = Tη,ξ
Proof. This follows from the A-linearity of the inner product, which is linear in the
                                                           ∗
second variable and antilinear in the first. The equality Tξ,η = Tη,ξ follows from
                                                Z
                     hTη,ξ α, βi = h(ξ|α)η, βi = (ξ|α)∗ (η|β)dλ
                                                      Z
                      hα, Tξ,η βi = hα, (η|β)ξi =         (α|ξ)(η|β)dλ
                                                                                   
By Proposition 2.3 (4), the Tξ,η are bounded operators in H. Let us now assume
that all endomorphisms of the A-module H∞ are regular as in Definition 6.1. We
can then apply Proposition 6.5 and get that the following defines an essentially
self-adjoint operator with domain DomD,
(93)                              Dξ, η = Tη, ξ D Tξ, η
We need to relate this operator with the derivation of A given by (32) i.e.
(94)                        δ0 (a) = i(ξ|[D, a]ξ) ,       ∀a ∈ A
Lemma 6.7. One has
(95)          Dξ, η ζ = −i δ0 ((η|ζ)) η + (ξ|Dξ)Tη, η ζ ,      ∀ξ, η, ζ ∈ H∞
The operator Vη (a) = aη, ∀a ∈ A extends to a bounded linear map Vη from
L2 (X, dλ) to H, and one has
(96)         Vη∗ Vη = (η|η) , Vη Vη∗ = Tη, η , Vη∗ (ζ) = (η|ζ) ,    ∀ζ ∈ H∞
Proof. One has Dξ, η ζ = Tη, ξ D Tξ, η ζ = Tη, ξ D((η|ζ)ξ). Thus using (ξ, [D, a]ξ) =
−iδ0 (a) and (ξ|aDξ)η = (ξ|Dξ)aη for a = (η|ζ) one gets
    Dξ, η ζ = (ξ|Daξ)η = (ξ|[D, a]ξ)η + (ξ|Dξ)aη = −iδ0 ((η|ζ))η + (ξ|Dξ)Tη, η ζ
which gives (95). To show that Vη is bounded, note that
                                         Z              Z
           hVη (a), Vη (a)i = haη, aηi = −a a(η|η)|D| = a∗ a(η|η)dλ
                                           ∗         −p


which also shows that Vη∗ Vη = (η|η). Let us check that Vη∗ (ζ) = (η|ζ). One has
                                 Z             Z
          hζ, Vη (a)i = hζ, aηi = a(ζ|η)dλ = (η|ζ)∗ adλ = hVη∗ (ζ), ai

The equality Vη Vη∗ = Tη, η follows from (91).                                     
The strategy now is to use the self-adjointness of Dξ, η and the fact that δ0 can be
compared to iDξ, η plus a bounded perturbation to show that the resolvent problem
(1 + ǫδ0 )ξ = η can be solved first in L2 . Then one wants to use the regularity to
show that this problem can also be solved in the Sobolev spaces. Finally one wants
to use the Sobolev estimates to show that it can be solved in the C ∗ norm. Then
together with the results on dissipative derivations of §5 one gets the existence of
the resolvent for the action on the C ∗ -algebra. One notes that it is enough to
solve the resolvent problem for ǫ small enough. One then applies the Hille-Yoshida
Theorem.
                                            27
More specifically we consider the equation
(97)                       (1 + iǫ(Dξ, η − (ξ|Dξ)Tη, η ))ζ = aη
where a ∈ A is given and ǫ can be taken as small as needed. Given a solution ζ
of (97), one can under suitable regularity conditions on ζ take the inner product
(η|ζ) = b. One then has, at the formal level
(98)                            b + ǫδ0 (b)(η|η) = a(η|η)
We can assume that the support of ξ is small enough so that we can find η such
that (η|η) = 1 in a neighborhood of the support K of ξ. Then by (94) one gets that
since δ0 vanishes outside K, one can replace δ0 (b)(η|η) in (98) by δ0 (b). Moreover
one then gets
(99)                     c + ǫδ0 (c) = a , c = b + (1 − (η|η))a
since (1 − (η|η))a belongs to the kernel of δ0 since its support is disjoint from K.
We need to know that c ∈ A where A = C(X) is the norm closure of A and in fact
also that [D, c] is bounded, just to formulate the result. Thus we need to control
the Sobolev norms of the solution of (97). To do that we use the transformation
θλ of (70). One has, as in (72),
(100)             θλ (T ) = T + Eλ (T ) , Eλ (T ) = [D2 , T ](D2 + λ)−1
so that the binomial formula expresses θλN (T ) in terms of the Eλk (T ) for k ≤ N , as
                                        X N 
(101)                    θλN (T ) = T +              Eλk (T )
                                                k
                                           k≥1

Note also that, for T regular, and on DomD one has
(102)                         [D2 , T ] = 2δ(T )|D| + δ 2 (T )
as follows from [D2 , T ] = [|D|2 , T ] = δ(T )|D| + |D|δ(T ) = 2δ(T )|D| + δ 2 (T ).
Lemma 6.8. Let T be regular.
1) The Eλk (T ) are compact operators for k > 0 and converge in norm to 0 when
λ → ∞.
2) One has (with λ ≥ 1)
(103) kEλ (T )Dk ≤ 2kδ(T )k+kδ 2(T )k , kDEλ (T )k ≤ 2kδ(T )k+3kδ 2(T )k+kδ 3 (T )k
3) For k > 1, the operators DEλk (T ) and Eλk (T )D are compact operators which
converge in norm to 0 when λ → ∞.
Proof. 1) One has, using (100) and (102), that
(104)                  Eλ (T ) = (2δ(T )|D| + δ 2 (T ))(D2 + λ)−1
Thus the answer follows for k = 1 since both (D2 + λ)−1 and |D|(D2 + λ)−1 are
compact operators which converge in norm to 0 when λ → ∞. Since Eλ (T ) is also
regular it follows also for k > 1.
2) The first inequality of (103) follows from (104). For the second, one has
                                [|D|, Eλ (T )] = Eλ (δ(T ))
which gives (103) using,
                        kDEλ (T )k ≤ kEλ (T )|D|k + kEλ (δ(T ))k
and the second inequality follows using the first and (104).
                                            28
3) The statement is immediate for Eλk (T )D since |D|(D2 + λ)−1 is compact. For
the second one uses [|D|, Eλk (T )] = Eλk (δ(T )) as in the proof of 2).     
Lemma 6.9. 1) For any integer N ∈ N, there exists λ < ∞ and ǫ0 > 0 such that
the following operator with domain DomD is closable and invertible in H for any
ǫ ≤ ǫ0 ,
(105)                θλN (1 + iǫSξ, η ) , Sξ, η = Dξ, η − (ξ|Dξ)Tη, η
and the norm of its inverse fulfills
(106)                    k(θλN (1 + iǫSξ, η ))−1 k ≤ 1 + N cξ, η ǫ ,
where cξ, η < ∞ only depends on ξ and η.
2) For any integer N there exists ǫN > 0 such that (97) can be solved in HN =
Dom|D|N .
Proof. The operator P = (ξ|Dξ)Tη, η is bounded and regular since it is an endo-
morphism of the A-module H∞ . Thus it preserves the domain of (D2 + λ)N and
the Eλk (P ) are compact operators for k > 0 and converge in norm to 0 when λ → ∞
by Lemma 6.8. By (93), one has Dξ, η = Tη, ξ D Tξ, η thus, by regularity of the Tξ, η ,
the operator
                         θλN (Dξ, η ) = (D2 + λ)N Dξ, η (D2 + λ)−N
is well defined on DomD. Moreover one has, by (101), and on DomD,
                                               X N                    
                                                                          N
                                                                            
   N              N         N        N                       k
  θλ (Dξ, η ) = θλ (Tη, ξ )θλ (D)θλ (Tξ, η ) =             Eλ (Tη, ξ )D       Eλm (Tξ, η )
                                                      k                   m
                                              k,m

so that one gets
(107)      θλN (Dξ, η ) = Dξ, η + N Eλ (Tη, ξ )DTξ, η + N Tη, ξ DEλ (Tξ, η ) + Q(N, λ)
where the remainder Q(N, λ) is a sum of terms proportional to Eλk (Tη, ξ )DEλm (Tξ, η )
for k + m > 1. By Lemma 6.8 we get that Q(N, λ) is a compact operator and
kQ(N, λ)k → 0 when λ → ∞. Thus for λ → ∞, we get the following estimate:
there exists Cξ, η < ∞ only depending on ξ and η such that
(108)                    lim inf kθλN (Dξ, η ) − Dξ, η k ≤ N Cξ, η .
                          λ→∞

Since the Eλk (P ) are compact operators for k > 0 and converge in norm to 0 when
λ → ∞, one gets similarly
(109)                    lim inf kθλN (Sξ, η ) − Sξ, η k ≤ N Cξ, η .
                          λ→∞

Let λ be large enough so that kθλN (Sξ, η ) − Sξ, η k ≤ 2N Cξ, η . For ǫ small enough,
(110)       kθλN (1 + iǫSξ, η ) − (1 + iǫDξ, η )k ≤ 2N Cξ, η ǫ + ǫk(ξ|Dξ)Tη, η k < 1
Since Dξ, η is essentially self-adjoint, the operator K = 1 + iǫDξ, η is closable and
invertible for any ǫ > 0 and the norm of its inverse is ≤ 1. θλN (1 + iǫSξ, η ) is closable
since it is a bounded perturbation K − B of K = 1 + iǫDξ, η . Moreover by (110)
it is invertible,Pand the norm of its inverse, which is given by the Neumann series
(K − B)−1 = (K −1 B)m K −1 , fulfills (106). This proves the first statement.
2) Let ξ = aη ∈ H2N , and consider ξ ′ = (D2 + λ)N ξ ∈ H. Then, by the first
statement, one can find a sequence ζn ∈ DomD, ζn → ζ ′ ∈ H such that
                        θλN (1 + iǫ(Dξ, η − (ξ|Dξ)Tη, η ))ζn → ξ ′
                                             29
where the convergence is in H. Applying the bounded operator (D2 + λ)−N gives
                  (1 + iǫ(Dξ, η − (ξ|Dξ)Tη, η ))(D2 + λ)−N ζn → ξ .
One has ζ = (D2 + λ)−N ζ ′ ∈ H2N ⊂ DomD and (D2 + λ)−N ζn → (D2 + λ)−N ζ ′
in the topology of DomD. Thus
                           (1 + iǫ(Dξ, η − (ξ|Dξ)Tη, η ))ζ = ξ
and ζ ∈ H2N gives the required solution.                                                   
We now need to show that if η ∈ H∞ and ζ ∈ HN for N large enough, the inner
product (η|ζ) gives an element of A = C(X) and in fact in the domain of δ k . To
see this we use Proposition 2.3. We recall that the Sobolev norms on A are defined
using generators ηµ of the A-module H∞ by (13) i.e.
                              X
                 kaksobolev
                    s       =(    k(1 + D2 )s/2 aηµ k2 )1/2 , ∀a ∈ A
                                 µ

Thus when we want to control the Sobolev norms of (η|ζ) we need to control the
norms
                                 k(1 + D2 )s/2 (η|ζ)ηµ k
The point then is that (η, ζ)ηµ = Tηµ , η ζ while the endomorphism Tηµ , η is regular
by hypothesis so that θλN (Tηµ , η ) is bounded and (with λ = 1) one gets:
Lemma 6.10. Assuming strong regularity, one has for η ∈ H∞
(111)                     k(η|ζ)ksobolev
                                 s       ≤ Cs k(1 + D2 )s/2 ζk
Proof. It is enough to prove the estimate when s/2 = N is an integer. For each µ
one has
   k(1 + D2 )N (η|ζ)ηµ k = kθ1N (Tηµ , η )(1 + D2 )N ζk ≤ kθ1N (Tηµ , η )kk(1 + D2 )N ζk
                                                                                           
Theorem 6.11. Let (A, H, D) be a strongly regular spectral triple with A commu-
tative, fulfilling the five conditions of §2. Then any derivation of A of the form (32)
i.e. δ0 (a) = i(ξ|[D, a]ξ), ∀a ∈ A, is closable for the C ∗ -norm of A, and its closure
is the generator of a one-parameter group of automorphisms U (t) of A = C(X),
X = Spec(A).
Proof. By Corollary 5.14 the derivation δ0 , with domain A ⊂ A, is dissipative for
the C ∗ -norm of A. Thus it is closable ([2] Proposition 1.4.7) and we let D(δ0 ) be
the domain of its closure. To apply the Hille-Yosida-Lumer-Phillips Theorem we
need to show that for sufficiently small ǫ one has
(112)                             (1 + ǫδ0 )D(δ0 ) = A
By Corollary 5.14, we have
                         k(1 + ǫδ0 )(x)k ≥ kxk ,     ∀x ∈ D(δ0 )
Thus (1 + ǫδ0 )D(δ0 ) is closed in norm and it is enough to show that (1 + ǫδ0 )A is
norm dense in A. Let then η ∈ H∞ be such that (η|η) = 1 in a neighborhood of the
support of ξ (with δ0 (a) = i(ξ|[D, a]ξ)). Let then N ∈ N be such that the Sobolev
estimate holds (Proposition 2.3)
(113)                       kakC ∗ ≤ Ckaksobolev
                                         N       ,    ∀a ∈ A
                                            30
Let a ∈ A one has aη ∈ H∞ . By Lemma 6.9 there exists ǫN +1 > 0 such that for
any ǫ ≤ ǫN +1 one can find a solution in ζ ∈ HN +1 of the equation (97). Since H∞
is dense in HN +1 we thus get a sequence ζn ∈ H∞ such that ζn → ζ in HN +1 . The
operator Sξ, η = Dξ, η − (ξ|Dξ)Tη, η ) is continuous from HN +1 to HN . One thus
has, with convergence in HN :
                            (1 + iǫSξ, η )ζn → (1 + iǫSξ, η )ζ = aη
Combining Lemma 6.10 with (113), one gets that the bn = (η|ζn ) ∈ A converge in
the C ∗ -norm kxk. Moreover, by (95) and (105),
             Sξ, η ζn = −i δ0 ((η|ζn )) η , (1 + iǫSξ, η )ζn = ζn + ǫδ0 (bn ) η → aη
with convergence in HN . Thus applying (η|•) and using (111) and (113),
                                 bn + ǫδ0 (bn )(η|η) → a(η|η)
         ∗
in the C -norm, as in (98). Since (η|η) = 1 in a neighborhood of the support of
ξ one has δ0 (bn )(η|η) = δ0 (bn ). Moreover one has, since (1 − (η|η))a vanishes in a
neighborhood of the support of ξ that δ0 ((1 − (η|η))a) = 0 . Thus we have the norm
convergence
                      cn + ǫδ0 (cn ) → a , cn = bn + (1 − (η|η))a
and this shows that (1 + ǫδ0 )A is norm dense in A. Since (1 + ǫδ0 )D(δ0 ) is norm
closed it is equal to A. Thus, we have shown that for sufficiently small ǫ one
has (112). Thus the Hille-Yosida-Lumer-Phillips Theorem ([2] Theorem 1.5.2, [21]
Theorem X.47 a) shows that δ0 generates a contraction semi-group of A. Since the
same holds for −δ0 , one gets a one parameter group of isometries U (t) = etδ0 of
the C ∗ -algebra A. Moreover U (t)(a) is a norm continuous function of t for fixed
a ∈ A. Using the operators of the form
                                     Z
(114)                       U (f ) = f (t)U (t)dt : A → A
                                                                   P tn (n)
for f such that the L1 -norms of the derivatives kf (n) k1 fulfill   n! kf  k1 < ∞,
one gets a dense domain of analytic elements and one checks that since δ0 is a
derivation on D(δ0 ) the U (t) are automorphisms of A.                            
It remains to show that the U (t) ∈ Aut(A) respect the smoothness. Let us first
show that we need only understand what happens to U (t)(a)η as an element of H
because U (t) is the identity in the complement of the support of ξ.
Lemma 6.12. Let x ∈ A have support disjoint from the support of ξ. Then
U (t)(x) = x for all t ∈ R.
Proof. We can assume that x ∈ A. Let us show that δ0 (x) = 0. There exists
φ ∈ A with x = xφ2 and φξ = 0. One has δ0 (x) = i(ξ|[D, x]ξ) and [D, x] =
[D, x]φ2 + 2x[D, φ]φ so that [D, x]ξ = 0 and δ0 (x) = 0. It follows that for f as in
(114), one gets δ0 (U (f )(x)) = 0 since U (f ) commutes with δ0 . With f analytic
for L1 one gets that U (f )(x) is an analytic element such that δ0 (U (f )(x)) = 0 and
hence δ0n (U (f )(x)) = 0 for all n ≥ 1. It follows that
                                  X tn
              U (t)(U (f )(x)) =        δ n (U (f )(x)) = U (f )(x) , ∀t ∈ R
                                     n! 0
Thus since U (fn )(x) → x in norm for a suitable sequence fn , one gets that
U (t)(x) = x for all t ∈ R.                                                          
                                               31
Lemma 6.13. Let S be the closure of Sξ, η = Dξ, η − (ξ|Dξ)Tη, η as an unbounded
operator in H. Then for any a ∈ Domδ0 one has aη ∈ DomS and
(115)                                S(aη) = −iδ0 (a)η
For any a ∈ A and ǫ > 0, let b = (1 + ǫδ0 )−1 (a). Then bη ∈ DomS and
(116)                               (1 + iǫS)(bη) = aη
Proof. For an → a and δ0 (an ) → δ0 (a) in norm one has an η → aη and δ0 (an )η →
δ0 (a)η in H. Thus, since S is closed and A is a core for δ0 it is enough to prove
(115) for a ∈ A. In that case one gets
                S(aη) = Sξ, η (aη) = ((ξ|D(a(η|η)ξ)) − (ξ|Dξ)(η|aη)) η
One has a(η|η)ξ = aξ since (η|η) = 1 on the support of ξ. Similarly (ξ|Dξ)(η|aη) =
(ξ|Dξ)a = (ξ|aDξ). Thus we get
                             S(aη) = (ξ|[D, a]ξ) ,      ∀a ∈ A ,
which gives (115).
To prove (116), note that by Theorem 6.11 the resolvent (1 + ǫδ0 )−1 exists for any
ǫ > 0 and maps A to the domain of δ0 . Thus applying the first part of the Lemma
to b = (1 + ǫδ0 )−1 (a), one gets
                (1 + iǫS)(bη) = bη + iǫ(−iδ0 (b)η) = ((1 + ǫδ0 )b)η = aη
which gives (116).                                                                    

Lemma 6.14. The one parameter group U (t) ∈ Aut(A) fulfills for each N an
estimate of the form
(117)                    kU (t)(a)ksobolev
                                   N       ≤ c1 eN cξ, η |t| kaksobolev
                                                                N

Proof. We first use the Sobolev semi-norm given by
                               kaksobolev     2
                                  N, η, λ = (D + λ)
                                                   N/2
                                                       aη
with λ > 0 determined by Lemma 6.9. We let ǫ0 > 0 be as in Lemma 6.9. By (116)
one has for any a ∈ A
(118)                 (1 + ǫδ0 )−1 (a)η = (1 + iǫS)−1 aη ,       ∀ǫ ≤ ǫ0
Assume that kaksobolev
               N, η, λ < ∞. One then has

                     aη = (D2 + λ)−N/2 ζ , ζ = (D2 + λ)N/2 aη ∈ H
By Lemma 6.9 one gets, for ǫ ≤ ǫ0 , using (106),
k(1+ǫδ0)−1 (a)ksobolev      2
               N, η, λ = k(D +λ)
                                N/2
                                    (1+ǫδ0)−1 (a)ηk = k(D2 +λ)N/2 (1+iǫS)−1aηk
            N/2
        = kθλ     ((1 + iǫS)−1 )ζk ≤ (1 + N cξ, η ǫ)kζk = (1 + N cξ, η ǫ)kaksobolev
                                                                            N, η, λ

This shows that k(1 + ǫδ0 )−1 (a)ksobolev
                                  N, η, λ < ∞ and thus one can iterate and get,

(119)      k(1 + ǫδ0 )−m (a)ksobolev                  m   sobolev
                             N, η, λ ≤ (1 + N cξ, η ǫ) kakN, η, λ ,        ∀ǫ ≤ ǫ0
Now for t > 0 and with norm convergence in A one has,
                                                     tδ0 −n
                             U (−t)a = lim (1 +         ) (a) .
                                         n→∞          n
                                            32
This shows that U (−t)a is the norm limit of the sequence an = (1 + tδn0 )−n (a) and
moreover one has, from (119), kan ksobolev                    n   sobolev
                                   N, η, λ ≤ (1 + N cξ, η t/n) kakN, η, λ . Thus

(120)                   lim sup kan ksobolev
                                     N, η, λ ≤ e
                                                 N cξ, η |t|
                                                             kaksobolev
                                                                N, η, λ

Since an → b = U (−t)a in norm, one has an η → bη also in norm in H. Since the
operator (D2 + λ)N/2 is closed, and by (120) the (D2 + λ)N/2 an η are uniformly
bounded, it follows that bη ∈ Dom(D2 + λ)N/2 and thus kU (−t)aksobolev
                                                                   N, η, λ < ∞.
More precisely we get
                         kU (−t)aksobolev
                                  N, η, λ ≤ e
                                              N cξ, η |t|
                                                          kaksobolev
                                                             N, η, λ

Now the semi-norm kaksobolev
                        N, η, λ is not equivalent to the Sobolev norm but the latter
is equivalent to the sum
                                          X
                     k(D2 + λ)N/2 aηk +       k(D2 + λ)N/2 aηµ k
where one can choose the ηµ so that their supports are disjoint from the support of
ξ. This can be seenP using the strong regularity. It then follows from Lemma 6.12,
that the semi-norm k(D2 +λ)N/2 aηµ k is preserved by U (t) since U (t)(a)ηµ = aηµ
for all µ. Thus one obtains (117).                                               

Theorem 6.15. Let (A, H, D) be a strongly regular spectral triple with A commu-
tative, fulfilling the five conditions of §2. Then any derivation of A of the form
(32) i.e. δ0 (a) = i(ξ|[D, a]ξ), ∀a ∈ A, is the generator of a one-parameter group of
automorphisms σt ∈ Aut(A) such that
      • ∂t σt (a) = δ0 (σt (a)).
      • The map (t, a) ∈ R × A 7→ σt (a) ∈ A is jointly continuous.
Proof. By Lemma 6.14, the one parameter group U (t) ∈ Aut(A) preserves the
subalgebra A ⊂ A. We let σt ∈ Aut(A) be the corresponding automorphisms. For
a ∈ A one has a ∈ Domδ0 and thus
                                      Z t
                         σt (a) − a =     σu (δ0 (a))du
                                              0

where σu (δ0 (a)) is a norm continuous function of u. By (117) applied to δ0 (a), this
shows that kσt (a) − aksobolev
                          N      = O(|t|) when t → 0. One has
                  1                         1 t
                                             Z
                    (σt (a) − a) − δ0 (a) =     (σu (δ0 (a)) − δ0 (a))du
                  t                         t 0
which, since kσu (δ0 (a)) − δ0 (a)ksobolev
                                   N       = O(|u|), gives
                    1
                  k (σt (a) − a) − δ0 (a)ksobolev
                                             N       = O(|t|) , for t → 0 .
                    t
This shows that ∂t σt (a) = δ0 (σt (a) in the Frechet space A. Let us check the joint
continuity of (t, a) 7→ σt (a). Let (tn , an ) → (t, a) ∈ R×A. One has σtn (an )−σt (a) =
σtn (an − a) + σtn (a) − σt (a). The norm kσtn (a) − σt (a)ksobolev
                                                                 N     converges to 0 from
the above discussion. Moreover Lemma 6.14 shows that one controls the Sobolev
norms of σtn (an − a) from those of (an − a) which gives the required continuity. 

We can now also prove directly the absolute continuity of the transformed measure
σt∗ (λ) with respect to λ.
                                              33
Proposition 6.16. Let (A, H, D), δ0 and σt be as in Theorem 6.15. Then for each
t ∈ R the measure λ of (5) is strongly8 equivalent to its transform under σt .
Proof. Let δ0 (a) = i(ξ|[D, a]ξ), ∀a ∈ A. By Lemma 6.12 the measure σt∗ (λ), given
by σt∗ (λ)(f ) = λ(σt (f )) agrees with λ(f ) whenever the support of f is disjoint from
the support of ξ. With η ∈ H∞ as above one has (η|η) = 1 in a neighborhood
V of the support of ξ. To obtain the required strong equivalence, it is enough to
compare λ(σt (f )) and λ(f ) for f and σt (f ) with support contained in V . One then
has, using (2)
                           Z                Z
              λ(σt (f )) = −σt (f )|D|−p = −σt (f )(η|η)|D|−p = hη, σt (f )ηi

Let, as above, S be the closure of Sξ, η = Dξ, η − (ξ|Dξ)Tη, η . It is by construction
a bounded perturbation of the self-adjoint operator (closure of) Dξ, η and one can
define eitS for t ∈ R using the expansional formula ([1])
                                                        !
                          XZ
             A+B −A
(121)      e     e   =           αu1 (B) · · · αun (B)du , αu (B) = euA Be−uA
                             n    Sn

with A = itDξ, η and B = −it(ξ|Dξ)Tη, η . Let us show that
(122)                            σt (a)η = eitS aη ,   ∀a ∈ A .
By Theorem 6.15 and (115) the H-valued function t 7→ η(t) = σt (a)η solves the
differential equation
                dη(t)
                      = iSη(t) , η(0) = aη , η(t) ∈ DomS ,                ∀t ∈ R .
                 dt
                  d
This implies that dt (e−itS η(t)) = 0 and thus e−itS η(t) = aη which proves (122). It
follows from (122) that
                                                                ∗
(123)                   hη, σt (a)ηi = hη, eitS aηi = he−itS η, aηi

Note that S is not self-adjoint in general because of the additional term −(ξ|Dξ)Tη, η .
The difference S −S ∗ is a bounded operator and an endomorphism of the A-module
H∞ given by
(124)                   S − S ∗ = ρ Tη, η , ρ = (ξ|Dξ)∗ − (ξ|Dξ)
                                                                                     ∗
since Tη, η is self-adjoint by (92). We can now write a formula for e−itS η,
                                       Z                             !
                    −itS ∗
                               X
                                   n n
(125)             e        η=     i t     σ−tu1 (ρ) · · · σ−tun (ρ)du η
                                  n         Sn

with Sn = {(uj ) | 0 ≤ u1 ≤ . . . ≤ un ≤ 1} the standard simplex. Indeed one has
−itS ∗ = −itS + P with P = itρTη, η which is bounded which allows one to use
the expansional formula (121), with A = −itS, B = P . Now by (122) one has
                                                                                  ∗
eitS η = η for all t ∈ R thus the left hand side of (121) applied to η gives e−itS η.
Let us compute the right hand side. We first show that
(126)                      eisS ρTη, η aη = σs (ρa)η ,     ∀a ∈ A .

  8µ is strongly equivalent to ν iff there is c > 0 with cν ≤ µ ≤ c−1 ν

                                                 34
Indeed one has Tη, η aη = (η|aη)η = a(η|η)η and since (η|η) = 1 on the support of
ρ (using (124)) one gets that ρTη, η aη = ρa(η|η)η = ρaη. Thus (126) follows from
(122). We then get
         αu1 (P ) · · · αun (P )η = e−itu1 S P e−it(u2 −u1 )S P · · · e−it(un −un−1 )S P η =

             in tn e−itu1 S ρTη, η e−it(u2 −u1 )S ρTη, η · · · e−it(un −un−1 )S ρTη, η η =
                 = in tn σ−tu1 (ρσ−t(u2 −u1 ) (ρ(. . . (ρσ−t(un −un−1 ) (ρ)) . . .)η
which yields (125) from (121). Now the series
                           X       Z
                               n n
(127)               h(t) =    i t     σ−tu1 (ρ) · · · σ−tun (ρ)du
                                   n          Sn

converges in the Frechet algebra A since, for each k, the pk (σs (ρ)) are uniformly
bounded on compact sets of s, while the volume of the simplex Sn is 1/n!. Thus
h(t) ∈ A and combining (123) and (125) one has:
                                          ∗
(128)            hη, σt (f )ηi = he−itS η, f ηi = hh(t)η, f ηi = hη, h̄(t)f ηi
so that we get, for all f with support in V ,
(129)                                  λ(σt (f )) = λ(h̄(t)f )
Since, by construction one has h = 1 outside the support of ξ, (using Lemma 6.12),
equality (129) holds for all f ∈ A. The norm continuity kh(t) − 1k → 0 when t → 0
(using (127)) then gives the required strong equivalence.                       



                                  7. Absolute continuity
The following equality defines a positive measure λ on X.
                        Z         Z
(130)                      adλ = − a|D|−p , ∀a ∈ C(X) .

This measure is locally equivalent to the spectral measure of the representation of
A = C(X) in H. More precisely:

Lemma 7.1. For any open set V ⊂ X the following two measures are strongly
equivalent:
        • The restriction λ|V to V of the measure λ of (130).
        • The restriction to V of the spectral measure associated to a vector ξ ∈ H∞
          whose A-valued inner product (ξ, ξ) is strictly positive on V .
Proof. By the condition of absolute continuity one has a relation of the form
                                       Z
                             hξ, aξi = − a(ξ, ξ)|D|−p

and since (ξ, ξ) ∈ A is strictly positive on V , one gets the strong equivalence between
the restriction to V of the spectral measure associated to the vector ξ ∈ H∞ and
the measure λ|V of (130).                                                             
                                                   35
We let
                           Bǫ = {t ∈ Rp | |t| < ǫ}
Given an automorphism σ ∈ Aut(A) we use the covariant notation
(131)                    σ(κ) = κ ◦ σ −1 ,     ∀κ ∈ Spec(A)
and view σ as an homeomorphism of X = Spec(A). We use the notations Uα , sα
of Lemma 4.4 and of (40).

Lemma 7.2. Let V ⊂ Uα be an open set and χ ∈ V . There exists a smooth family
σt ∈ Aut(A), t ∈ Rp , a neighborhood Z of χ in V and ǫ > 0, ǫ′ > 0 such that:
    (1) For any κ ∈ Z, the map t 7→ sα (σt (κ)) = F (κ, t) is a diffeomorphism,
        depending continuously on κ, of Bǫ with a neighborhood of sα (κ) in Rp and
(132)                  sα (κ) + Bǫ′ ⊂ F (κ, Bǫ/2 ) ,   ∀κ ∈ Z
   (2) For any t ∈ Bǫ one has
                                1
(133)                             λ ≤ σt (λ) ≤ 2λ .
                                2
   (3) Z1 = ∩Bǫ σt Z is a neighborhood of χ.
   (4) Z2 = ∪Bǫ σt Z is contained in V .
Proof. Let σt ∈ Aut(A), t ∈ Rp , W and Z as in Lemma 4.5. We can replace the
Z0 of Lemma 4.5 by any neighborhood of χ contained in Z0 and hence by a ball
centered at χ and contained in V ∩ Z0 . We use a metric d on X compatible with
the topology (Proposition 2.3). Thus
                             Z = {κ ∈ X | d(κ, χ) < r}
and we can take r small enough so that
(134)                     {κ ∈ X | d(κ, χ) ≤ 3/2 r} ⊂ V
The continuity of the map (κ, t) 7→ σt−1 (κ) = κ ◦ σt yields ǫ > 0 with Bǫ ⊂ W and
(135)                 d(κ, σt±1 (κ)) ≤ r/2 ,   ∀κ ∈ X , t ∈ Bǫ
Then the first statement (1) follows from Lemma 4.5, with (132) coming from the
continuity in κ. The second statement follows from (135) since for d(κ, χ) < r/2
one gets d(χ, σt−1 (κ)) < r and σt−1 (κ) ∈ Z. Similarly the third statement follows
from (135) and (134). Finally (133) follows from Proposition 6.16 for ǫ small. 
Lemma 7.3. Let V ⊂ X be an open set with V ⊂ Uα and λV (resp. λV ) be the
spectral measure of the restriction to V (resp. V ) of the representation of C(X) in
H. Then sα (λV ) is equivalent to the Lebesgue measure on sα (V ) and there exists
c < ∞ such that
                Z                   Z
(136)              f ◦ sα dλV ≤ c         f (x)dxp , ∀f ∈ Cc+ (Rp ) .
                 V                  sα (V )

Proof. By Lemma 7.1, the spectral measure λV (resp. λV ) is equivalent to the
measure λ of (130) restricted to V (resp. V ). We show that
      • For any χ ∈ V one can find a neighborhood Z1 of χ in Uα such that
        sα (λ|Z1 ) ≤ c dxp for some c < ∞.
      • For any χ ∈ V one can find a neighborhood Z2 of χ in V such that
        dsα (λ|Z2 )/dxp = ρ(x) > 0 in a neighborhood of sα (χ)
                                          36
Let χ ∈ V . We apply Lemma 7.2 relative to V = Uα . We let σt , Z, Zj , ǫ and
ǫ′ be as in Lemma 7.2. We can assume that for |t| < ǫ one has (133). Let then
h ∈ Cc∞ (Bǫ ), h(t) ∈ [0, 1], be equal to 1 on Bǫ/2 . By Lemma 7.2, for any κ ∈ Z, the
map t 7→ F (κ, t) = sα (σt (κ)) is a diffeomorphism Fκ of Bǫ with a neighborhood of
sα (κ) in Rp . It follows then that for fixed κ the image in Rp of the measure h(t)dtp ,
is a smooth multiple gκ (u) of the Lebesgue measure dup ,
              Z                         Z
                                     p
(137)              f (F (κ, t))h(t)dt =     f (u)gκ (u)dup , ∀f ∈ Cc (Rp ) .
              Bǫ                           Rp

The function gκ vanishes outside Fκ (Bǫ ) and is given inside by
(138)                        gκ (u) = h(ψ(u))|dψ(u)/du|
where ψ is the inverse of the diffeomorphism Fκ and dψ(u)/du its Jacobian. The
continuity of the map κ 7→ Fκ gives a uniform upper bound
(139)                      gκ (u) ≤ c1 ,        ∀u ∈ Rp , κ ∈ Z .
Since h = 1 on Bǫ/2 and sα (κ) + Bǫ′ ⊂ Fκ (Bǫ/2 ) by (132), one has h(ψ(u)) = 1 for
u ∈ sα (y) + Bǫ′ . The continuity of the map κ 7→ Fκ then yields ǫ1 > 0 such that
(140)                gκ (u) ≥ ǫ1 ,   ∀u ∈ sα (κ) + Bǫ′ ,         ∀κ ∈ Z
We consider the image dν under (κ, t) ∈ Z ×Bǫ 7→ F (κ, t) ∈ Rp of the finite positive
measure dλ(κ)h(t)dtp on Z × Bǫ . It is given by
           Z                 Z Z
(141)           f (x)dν(x) =        f (F (κ, t))h(t)dtp dλ(κ) , ∀f ∈ Cc (Rp ) ,
              Rp                Z    Bǫ

and is equal, by (137), to
            Z               Z Z                       Z
(142)          f (x)dν(x) =     f (u)gκ (u)dup dλ(κ) = f (u)ρ(u)dup

where
                                           Z
(143)                           ρ(u) =           gκ (u)dλ(κ)
                                            Z

By (139) one has
(144)                     ρ(u) ≤ c1 λ(Z) < ∞ ,          ∀u ∈ Rp .
Moreover (140) shows that
(145)                  ρ(u) ≥ ǫ1 λ({κ ∈ Z | |u − sα (κ)| < ǫ′ }) .
We then have
(146)                         ρ(u) > 0 ,         ∀u ∈ sα (Z) .
This strict positivity follows from the condition of absolute continuity which shows
that the support of the measure λ is X. Indeed, for u ∈ sα (Z), the open set
{κ ∈ Z | |u − sα (κ)| < ǫ′ } is non-empty and it has strictly positive measure. This
shows that the restriction of the measure ν to the open set sα (Z) is equivalent to
the Lebesgue measure.
We now use the quasi-invariance of dλ given by (133) to compare sα (λ|Zj ) with ν.
Using (133) (for δ = 1/2), one has for t ∈ Bǫ , 21 dλ ≤ d(σt (λ)) ≤ 2dλ so that, for
                                                37
any subset E ⊂ X and any positive f ∈ Cc+ (Rp ) one has, with 1E the characteristic
function of E,
           1
             Z                   Z                         Z
               (f ◦ sα )1E dλ ≤ (f ◦ sα )1E d(σt (λ)) ≤ 2 (f ◦ sα )1E dλ
           2
The middle term is
                Z                         Z
                   (f ◦ sα )1E d(σt (λ)) = (f ◦ sα ◦ σt )(1E ◦ σt )dλ

and we thus get
       1
         Z               Z                           Z
(147)      (f ◦ sα )dλ ≤         (f ◦ sα ◦ σt )dλ ≤ 2 (f ◦ sα )dλ ,            ∀f ∈ Cc+ (Rp )
       2 E                σt−1 E                      E

We let, as in Lemma 7.2,
                           Z1 = ∩Bǫ σt Z , Z2 = ∪Bǫ σt Z .
One has σt−1 (Z1 ) ⊂ Z for t ∈ Bǫ so that, by the first inequality of (147) for E = Z1 ,
1
  Z                Z                        Z
     (f ◦sα )dλ ≤           (f ◦sα ◦σt )dλ ≤ (f ◦sα ◦σt )dλ , ∀t ∈ Bǫ , f ∈ Cc+ (Rp )
2 Z1                σt−1 Z1                  Z

so that, multiplying by h(t)dtp and integrating over t ∈ Bǫ , we get C < ∞ with
      Z                   Z Z                                   Z
          (f ◦ sα )dλ ≤ C       f (sα (σt (κ))h(t)dtp dλ(κ) = C    f (x)dν(x) ,
       Z1                  Z    Bǫ                                       Rp
where we used Fubini’s theorem, and the equality sα (σt (κ)) = F (κ, t) for κ ∈ Z
and t ∈ Bǫ . Thus, using (142) and (144)
         Z                   Z                     Z
(148)        (f ◦ sα )dλ ≤ C    f (u)ρ(u)dup ≤ C ′   f (u)dup , ∀f ∈ Cc+ (Rp )
            Z1                  Rp                          Rp
hence the image sα (λ|Z1 ) is absolutely continuous with respect to the Lebesgue
measure and is majorized by a constant multiple of Lebesgue measure. Thus, every
point of V has a neighborhood Z1 such that sα (λ|Z1 ) ≤ c1 dxp . Covering the
compact set V by finitely many such Z1 gives (136).
Let us now assume that χ ∈ V . We can then assume, by Lemma 7.2 that Z2 =
∪Bǫ σt Z is contained in V . One has Z ⊂ σt−1 (Z2 ) for t ∈ Bǫ so that, by the second
inequality of (147) for E = Z2 ,
     Z                     Z                           Z
        (f ◦ sα ◦ σt )dλ ≤        (f ◦ sα ◦ σt )dλ ≤ 2     (f ◦ sα )dλ , ∀t ∈ Bǫ
      Z                     σt−1 (Z2 )                           Z2

thus, after integration over t ∈ Bǫ ,
         Z                     Z Z                                  Z
      C′      f (x)dν(x) = C ′        f (sα (σt (y))h(t)dtp dλ(y) ≤   (f ◦ sα )dλ
            Rp                  Z    Bǫ                                   Z2
This shows, using (142), that
               Z                    Z
(149)             (f ◦ sα )dλ ≥ C ′            f (u)ρ(u)dup ,    ∀f ∈ Cc+ (Rp )
                 Z2                       Rp
By (146) one has ρ(u) > 0 for all u ∈ sα (Z) thus ρ(u) > 0 in a neighborhood
of sα (χ), in other words dsα (λ|Z2 )/dxp = ρ2 (x) > 0 in a neighborhood of sα (χ)
as required. This shows that sα (λ|V ) is equivalent to the Lebesgue measure on
sα (V ).                                                                        

                                                38
                            8. Spectral multiplicity
We want to get an upper bound for the number of elements in the fiber of the
map sα : Uα → Rp . We shall first relate the multiplicity of the map sα with
the spectral multiplicity of the operators ajα in the Hilbert space H. This is not
automatic, indeed the first difficulty is that for an injective representation π of a
C ∗ -algebra B with a subalgebra A ⊂ B, one can have the same double-commutants
π(A)′′ = π(B)′′ even though A 6= B. Thus for instance one can take the subalgebra
C[0, 1] ⊂ C(K) where K = {0, 1, . . . , 9}N is the Cantor set of the decimal digits
and the inclusion is given by the decimal expansion. Both act in L2 [0, 1] (by
multiplication) and the spectral multiplicity of the function x ∈ C[0, 1] is equal
to one but the number of elements in the fiber is equal to 2 for numbers of the form
k 10−n . The point in this example is that the projection map s : K → [0, 1] is not
an open mapping. Thus in particular the subset of K where the multiplicity of s is
two is not an open subset of K (it is countable).
Lemma 8.1. Let s : X → Y be a continuous open map of compact spaces. Then
the function n(y) = #s−1 (y) is lower semicontinuous on Y .
Proof. Assume that n(y) ≥ m and let us show that this inequality still holds in a
neighborhood of y. Let xj ∈ X be m distinct points in s−1 (y). One can then find
disjoint open sets Vj ∋ xj and let W = ∩j s(Vj ) which is an open neighborhood of
y. For any z ∈ W the preimage s−1 (z) contains at least m points.              

Now, let s : X → Y be a continuous open map of compact spaces. Let µ be a
positive measure on X with support X and π the corresponding representation of
C(X) in L2 (X, µ). We want to compare the spectral multiplicity function Σ(y) of
the restriction of π to C(Y ) with n(y) = #s−1 (y). Let ν = s(µ) be the image of
the measure µ. One can desintegrate µ in the form
                                      Z
                                  µ=     ρy dν(y)
                                         Y

where the conditional measure ρy is supported by the closed subset s−1 (y). The
issue is what is the dimension of the Hilbert space L2 (X, ρy ). It might seem at first
that if the support of the measure µ is X one should be able to conclude that the
support of ρy is s−1 (y) and obtain that the spectral multiplicity function Σ(y) is
larger than n(y) = #s−1 (y). However this fails as shown by the following example:
                         X = Y × {1, . . . , m} , s(y, k) = y
and let µk be the measure on Y corresponding to the restriction of µ to Y × {k}.
Lemma 8.2. If the measures µk are mutually singular then the spectral multiplicity
function Σ(y) is equal to 1 a.e. .
Proof. The representations of C(Y ) in L2 (Y, µk ) are pairwise disjoint, and each
is of multiplicity one. Thus the commutant of C(Y ) in the direct sum of these
representations only contains block diagonal operators and is hence commutative
so that the multiplicity is equal to one.                                       

The above example gives the needed condition for the relation between Σ(y) and
n(y) and one has:
                                             39
Lemma 8.3. Let X be a compact space and λ a finite positive measure on X, π
the representation9 of C(X) in L2 (X, dλ). Let aj = a∗j ∈ C(X) and s the map from
X to Rp with coordinates aj . We let U ⊂ X be an open set and ν a measure on Rp
and assume that
      • The restriction of s to U is an open mapping.
      • For every open subset V ⊂ U the image s(λ|V ) is equivalent to the restric-
         tion of ν to s(V ).
Let then V ⊂ U be an open set and consider the operators Tj = π(aj )|V obtained
by restriction of the π(aj ) to the subspace L2 (V, dλ) ⊂ L2 (X, dλ). Then the joint
spectral measure of the Tj is ν|s(V ) and the spectral multiplicity Σ(y) fulfills
(150)                  Σ(y) ≥ n(y) = #{s−1 (y) ∩ V } ,   ∀y ∈ s(V ) ,
almost everywhere modulo ν.
Proof. Let W = s(V ) which is a bounded open set in Rp . One can desintegrate
λ|V in the form
                                    Z
(151)                         λ|V =    ρy dν(y)
                                            W
where the ρy are positive measures carried by Fy = s−1 (y) ∩ V . Moreover the total
mass of ρy is > 0 almost everywhere modulo ν for y ∈ s(V ). This follows from the
assumed equivalence s(λ|V ) ∼ ν|s(V ) . One then has
                                       Z ⊕
                         L2 (V, dλ) =      L2 (Fy , ρy )dν(y)
                                            W
For any ξ ∈ L (V, dλ) and any f ∈ Cc (Rp ) one has
               2
                                     Z Z
                   hξ, f ((aj ))ξi =      |ξ(x)|2 dρy f (y)dν(y)
                                        W   Fy

which shows that the joint spectral measure of the aj is absolutely continuous with
respect to ν|W . Its equivalence with ν|W follows from (151) taking ξ(x) = 1 and
using the assumed equivalence of s(λ|V ) with the restriction of ν to s(V ).
Let us prove (150). Let y ∈ W with n(y) = #{s−1 (y)∩V } ≥ m > 0. Let xj ∈ V be
m distinct points in s−1 (y) ∩ V . One can then find disjoint open sets Bj ∋ xj and
let Z = ∩j s(Bj ) which is an open neighborhood of y. For any z ∈ Z the preimage
s−1 (z) ∩ V contains at least m points since it contains at least one in each Bj .
Moreover one has s(s−1 (Z) ∩ Bj ) = Z for all j. Let λj be the restriction of λ to
Vj = s−1 (Z)∩Bj . From the first part of the Lemma, for each j the spectral measure
of the action of the aj in L2 (Vj , dλj ) is the restriction ν|s(Vj ) = νZ . The action of
the aj in L2 (V, dλj ) contains the direct sum of the actions in the L2 (Vj , dλj ) and
hence a copy of the action of the coordinates yj in
                                      ⊕m  2
                                       1 L (Z, νZ )
which shows that the spectral multiplicity fulfills Σ(z) ≥ m a.e. on the neighbor-
hood Z of y. This shows that any element y in the open set Um = {y ∈ U | n(y) ≥
m} admits an open neighborhood Zy where Σ(z) ≥ m holds a.e. Since Um is σ-
compact it follows that Σ(y) ≥ m almost everywhere modulo ν on Um so that (150)
holds.                                                                          
  9by multiplication

                                            40
Remark 8.4. With the hypothesis of Lemma 8.3, let E be a complex hermit-
ian vector bundle over X with non-zero fiber dimension everywhere. Then the
inequality ΣE (y) ≥ n(y) holds, where ΣE is the spectral multiplicity of the Tj
acting on L2 (X, dλ, E). This follows since, at the measurable level, one can find a
nowhere vanishing section of E which shows that the representation πE of C(X)
in L2 (X, dλ, E) contains the representation π of C(X) in L2 (X, dλ). Since πE is
contained in the sum of N copies of π, one obtains the conclusion.
Theorem 8.5. Let V ⊂ Uα be an open set and let ajα |V be the restriction of ajα ∈ A
to the range 1V H ⊂ H. Then
      • The joint spectral measure of the ajα |V is the Lebesgue measure on sα (V ).
      • The spectral multiplicity mac (y) fulfills
(152)             mac (y) ≥ n(y) = #{s−1
                                      α (y) ∩ V } ,            ∀y ∈ sα (V ) ,
        almost everywhere modulo the Lebesgue measure.
Proof. By Lemma 7.3 the hypothesis of Lemma 8.3 are fulfilled by the compact
space X with measure λ, the open set Uα , the measure dν = dxp and the elements
ajα . Thus the result follows from Lemma 8.3 and Remark 8.4.                 


                       9. Local form of the L(p,1) estimate
We fix p ∈ [1, ∞[. Our goal is to control the size of the Lebesgue multiplicity mac (y)
which appears in Theorem 8.5. The idea here is to use a local form of the L(p,1)
estimate of [9] Proposition IV.3.14, with the right hand side of the inequality now
involving a closed subset K ⊂ X, by
                                                   Z
                           λ(K) =         inf      −b|D|−p
                                       b∈A+ , b1K =1K

It relies on the estimate given in [8] and on the crucial results of Voiculescu ([25],
[26], [27]). The norm kT k(p,1) is defined10 for a compact operator T with charac-
teristic values µn (T ) in decreasing order by (cf. [25] p. 5)
                                               ∞
                                               X
(153)                            kT k(p,1) =        n−1+1/p µn
                                               1

In order to get an upper bound on kT k(p,1) for T an operator of finite rank, we can
use an inequality of the form
(154)                        kT k(p,1) ≤ Cp (Rank T )1/p kT k∞
which follows using the characteristic values µn (T ) from
                       N
                       X                            N
                                                    X
         kT k(p,1) =         n−1+1/p µn ≤ kT k∞           n−1+1/p ≤ Cp N 1/p kT k∞
                       n=1                          n=1
                                                (p,1)
where N = Rank T . Note also that the L                 norm fulfills
(155)                     kAT Bk(p,1) ≤ kAk∞ kT k(p,1)kBk∞ .

  10For p = 1 it agrees with the L1 -norm

                                               41
Let D be a self-adjoint unbounded operator such that its resolvent is an infinitesimal
of order 1/p i.e. is such that the characteristic values fulfill µn (|D|−1 ) = O(n−1/p ).
We let for any λ > 0,
(156)                   P (λ) = 1[0,λ] (|D|) , α(λ) = TrP (λ) .
By construction α(λ) is a non decreasing integer valued function. The hypothesis
µn (|D|−1 ) = O(n−1/p ) implies µn (|D|−1 ) < Cn−1/p for some C < ∞ and it follows
that α(C −1 n1/p ) < n, since the n-th eigenvalue of |D| in increasing order is >
C −1 n1/p . Thus, using for n the smallest integer above C p λp , we get
(157)                          α(λ) ≤ C p λp ,        ∀λ > 0 .
Let us show that
Lemma 9.1. Let f ∈ Cc∞ (R), then there is a finite constant Cf such that
(158)                 k[f (ǫD), a]k∞ ≤ Cf ǫk[D, a]k ,         ∀a ∈ A .
Under the hypothesis of Theorem 8.5, one has:
(159)                             lim inf λ−p α(λ) > 0 .
Proof. One has
                                         Z 1
(160)                [eisǫD , a] = isǫ         eiusǫD [D, a]ei(1−u)sǫD du
                                          0

                                            |s fˆ(s)|ds and
                                                 R
which gives (158) using the finiteness of
                                           Z
(161)                  [f (ǫD), a] = (2π)−1 fˆ(s)[eisǫD , a]ds .

Assume that (159) does not hold. Then let λn → ∞ be such that lim λ−p   n α(λn ) = 0.
Let f ∈ Cc∞ (R) be an (even) cutoff function vanishing outside [−1, 1]. For ǫn = λ−1
                                                                                  n
one has
                Rank f (ǫn D) ≤ α(λn ) , Rank [f (ǫn D), a] ≤ 2α(λn )
so that by (154) one gets, using (158),
                   k[f (ǫn D), a]k(p,1) ≤ Cp (2α(λn ))1/p Cǫn k[D, a]k
and since lim λ−p
               n α(λn ) = 0,

(162)                          lim k[f (ǫn D), a]k(p,1) = 0
                               n→∞
The Voiculescu obstruction relative to an ideal J of compact operators is given by
(163)                   kJ ({aj }) = lim+inf         max k[A, aj ]kJ
                                         A∈R1 ,A↑1

where R+ 1 is the partially ordered set of positive, finite rank operators of norm less
than one, in H. We take An = f (ǫn D). It is by construction an element of R+        1.
Moreover since f (ǫn D) → 1 strongly in H this shows that for the ideal J = L(p,1)
one gets kJ ({aj }) = 0. This contradicts the existence, shown in Theorem 8.5, of p
self-adjoint elements aj of A whose joint spectral measure is the Lebesgue measure,
using Theorem 4.5 of [25] which gives the equality, valid for p self-adjoint operators
                                              Z
(164)                        kJ ({aj })p = γp     m(y)dp y
                                                     Rp
where the function m(y) is the multiplicity of the Lebesgue spectrum.                  
                                                42
The rank of the operator T = [f (ǫD), a] is controlled by twice the rank of f (ǫD).
We take f compactly supported and thus f ≤ g where g is equal to one on the
support of f yields an inequality of the form
(165)                            Rank f (ǫD) ≤ Tr(g(ǫD))
One has by Corollary 14.10 (Appendix 2) an estimate of the form
                                                 Z
(166)                   lim inf ǫp Tr(g(ǫD)) ≤ cg −|D|−p

This gives
                                                      Z
                                       p
(167)                       lim inf ǫ Rank f (ǫD) ≤ cg −|D|−p

and:
Lemma 9.2. Let f ∈ Cc∞ (R), then there is a finite constant cf such that
                                         Z
(168)   lim inf k[f (ǫD), a]k(p,1) ≤ cf ( −|D|−p )1/p k[D, a]k , ∀a ∈ A .

Proof. Using (167), and Rank [f (ǫD), a] ≤ 2Rank f (ǫD) one gets a sequence ǫq → 0
with                                   Z
                  Rank Tq ≤ 3 ǫ−p
                                q  c g −|D|−p , Tq = [f (ǫq D), a]
Using (154) and (158) then gives
                                                            Z
       kTq k(p,1) ≤ Cp (Rank Tq )1/p kTq k∞ ≤ Cp (3 ǫ−p
                                                     q  c g −|D|−p )1/p Cf ǫq k[D, a]k

which is the required estimate since (ǫ−p
                                       q )
                                          1/p
                                              ǫq = 1.                                        
We now let K ⊂ X be a compact subset and we want to localize the estimate (168)
to K i.e. to the range of K in H.
Lemma 9.3. 11 Let h ∈ Cc∞ (R) be an (even) cutoff function and f = h2 . Then
                           1
(169)      k[f (ǫ|D|), a] − ǫ(f ′ (ǫ|D|)δ(a) + δ(a)f ′ (ǫ|D|))k(p,1) = O(ǫ)
                           2
where δ(a) = [|D|, a] and one assumes that a ∈ ∩2j=1 Dom δ j .
Proof. First one has (cf. Corollary 10.16 of [14]),
(170)                 k[h(ǫ|D|), a] − ǫh′ (ǫ|D|)δ(a)k ≤ C2 ǫ2 kδ 2 (a)k
with a similar estimate using ǫδ(a)h′ (ǫ|D|). Indeed, using (161) with |D| instead
of D, one gets                             Z
                        [h(ǫ|D|), a] = (2π)−1            ĥ(s)[eisǫ|D| , a]ds
so that by (160)
                                   Z              Z 1
           [h(ǫ|D|), a] = (2π)−1       ĥ(s)isǫ         eiusǫ|D| [|D|, a]ei(1−u)sǫ|D| duds
                                                   0
and since by (160) one has
                          k[[|D|, a], ei(1−u)sǫ|D| ]k ≤ |sǫ|kδ 2 (a)k
   11This is Lemma 10.29 in [14], but the proof given there is not correct, so we give the full
details here.
                                                  43
one gets
                                                                           Z
    k[h(ǫ|D|), a] − ǫh′ (ǫ|D|)δ(a)k ≤ C2 ǫ2 kδ 2 (a)k , C2 = (2π)−1            s2 |ĥ(s)|ds .

We follow the proof of Lemma 10.29 in [14]. One has
                           1
            [f (ǫ|D|), a] − ǫ(f ′ (ǫ|D|)δ(a) + δ(a)f ′ (ǫ|D|)) = Aǫ Bǫ + Cǫ Aǫ
                           2
where Aǫ = h(ǫ|D|), Bǫ = [h(ǫ|D|), a] − ǫh′ (ǫ|D|)δ(a) and Cǫ = [h(ǫ|D|), a] −
ǫδ(a)h′ (ǫ|D|). By (170) one has kBǫ k = O(ǫ2 ), kCǫ k = O(ǫ2 ), while Aǫ is uniformly
bounded with Rank Aǫ = O(ǫ−p ). Thus by (154) one has kAǫ k(p,1) = O(ǫ−1 ). Thus
we get the required estimate using (155).                                           
We then let K ⊂ X be a compact subset, as above, and consider the operators
(171)                             Rǫ = 1K f (ǫ|D|) 1K
We let b ∈ A be equal to 1 on K i.e. such that b 1K = 1K . One then has:
Lemma 9.4.
                      1
(172)     k[Rǫ , a] − ǫ(1K f ′ (ǫ|D|)bδ(a)1K + 1K δ(a)bf ′ (ǫ|D|)1K )k(p,1) = O(ǫ)
                      2
Proof. One has
                              [Rǫ , a] = 1K [f (ǫ|D|), a] 1K
since a commutes with 1K . Thus multiplying on both sides by 1K in (169), one
gets (using (155))
                       1
(173)      k[Rǫ , a] − ǫ(1K f ′ (ǫ|D|)δ(a)1K + 1K δ(a)f ′ (ǫ|D|)1K )k(p,1) = O(ǫ)
                       2
Lemma 9.1 and (157) show, using (154), that one has a uniform upper bound
                            k[f ′ (ǫ|D|), b]k(p,1) ≤ Ck[|D|, b]k
since f ′ has compact support. Thus in (173) one can replace 1K f ′ (ǫ|D|) = 1K b f ′ (ǫ|D|)
by 1K f ′ (ǫ|D|)b, without affecting the behavior in O(ǫ). The same applies to the
other term.                                                                            
We recall the interpolation inequality used in [9] §IV.2.δ, but stated without proof
there.
Lemma 9.5. There exists for 1 ≤ p < ∞, a constant cp such that, for S ∈ L1 ,
                                                  1/p
                                                   1−1/p
(174)                        kSk(p,1) ≤ cp kSk1 kSk∞
Proof. The inequality holds as an equality for p = 1 with c1 = 1, thus we can
assume that p > 1. We use the fact that L(p,1) is obtained by real interpolation
of index (θ, 1) for θ = 1p from the Banach spaces Y0 = K and Y1 = L1 . The
functoriality of the interpolation gives an inequality of the form
                     kT (x)k(Y0 ,Y1 )(θ,q) ≤ M01−θ M1θ kxk(X0 ,X1 )(θ,q)
for any linear operator from X0 + X1 to Y0 + Y1 such that
                       kT xkYi ≤ Mi kxkXi ,       ∀x ∈ Xi , i = 0, 1
We can take X0 = X1 = C and let T be such that T (1) = S. Then M0 = kSk∞ ,
M1 = kSk1 and the norm kxk(X0 ,X1 )(θ,1) is finite and non-zero.       
                                             44
Remark 9.6. In order not to depend on interpolation theory we give a direct proof
of (174). We assume that p > 1. First, for p > 1 an equivalent norm on L(p,1) is
                                       X                     1
(175)             kT k(p,1)′ = (1 − θ)    N θ−2 σN (T ) , θ = .
                                                             p
where σN (T ) is the sum of the first N characteristic values. The equivalence of the
norms (175) and (153) follows from µN ≤ σN /N one way. For the other way, one
applies Fubini to the double sum
                       XX                  XX
                                µn mθ−2 =            µn mθ−2 .
                        n m≥n                 m n≤m

Now to estimate (175) assuming kT k∞ ≤ 1 and kT k1 = ρ ≥ 1, one splits the sum
as follows
            X∞                  X                 X
                N θ−2 σN (T ) =   N θ−2 σN (T ) +   N θ−2 σN (T ) .
               1                 N <ρ                 N ≥ρ

Using kT k∞ ≤ 1 gives σN (T ) ≤ N and one bounds the first sum as
                               X
                                  N θ−2 N ∼ Cθ ρθ
                                N <ρ

Using kT k1 = ρ ≥ 1 gives σN (T ) ≤ ρ and one bounds the second sum by
                                X
                                    N θ−2 ρ ∼ Cθ′ ρθ
                                N ≥ρ

which gives the required inequality (174).
Lemma 9.7. There exists a constant Cf ≤ ∞ such that for b = b∗ ∈ A, b ≥ 0,
                                              Z
                           p   ′
(176)             lim inf ǫ kbf (ǫ|D|)bk1 ≤ Cf −b2 |D|−p

Proof. Note that by construction of f as a cutoff function, its derivative f ′ ≤ 0 on
[0, ∞[. Let h = −f ′ ∈ Cc∞ (R) so that h ≥ 0. One then has bh(ǫ|D|)b ≥ 0 and
                   kbh(ǫ|D|)bk1 = Tr(bh(ǫ|D|)b) = Tr(b2 h(ǫ|D|))
and the result follows from Corollary 14.10 (Appendix 2) which gives,
                                                   Z
                        lim inf ǫ Tr(b h(ǫ|D|)) ≤ µ −b2 |D|−p
                                 p    2

           R∞
where µ = p 0 up−1 h(u)du.                                                         
Lemma 9.8. There exists a constant Cf′ ≤ ∞ such that, for b = b∗ ∈ A, 0 ≤ b ≤ 1,
                                                Z
(177)          lim inf kǫbf (ǫ|D|)bk(p,1) ≤ Cf ( −b2 |D|−p )1/p
                            ′                ′


Proof. By Lemma 9.7 one has, once b is fixed, a sequence ǫq → 0 such that
                                                 Z
                     kbf ′ (ǫq |D|)bk1 ≤ 2Cf ǫ−p   2
                                              q −b |D|
                                                      −p


Also since f ′ is bounded one has
                        kbf ′ (ǫq |D|)bk∞ ≤ B = kf ′ k∞ < ∞
                                         45
Thus it follows from (174), that
                                                       Z
                 kbf (ǫq |D|)bk(p,1) ≤ cp (2Cf ǫq−p −b2 |D|−p )1/p B 1−1/p
                     ′


After multiplication by ǫq one gets the required estimate.                               

Theorem 9.9. There exits a finite constant κp such that for any operators aj ∈ A
and compact subset K ⊂ X one has, with J = L(p,1) , the inequality
(178)                    kJ ({aj 1K }) ≤ κp max kδ(aj )k∞ (λ(K))1/p
where one lets12:                                        Z
                               λ(K) =         inf        −b|D|−p .
                                        b∈A+ , b1K =1K

Proof. By definition one has
                         kJ ({aj 1K }) = lim inf      max k[A, aj 1K ]kJ
                                          A∈R+
                                             1 ,A↑1


where R+ 1 is the partially ordered set of positive, finite rank operators of norm less
than one, in 1K H. We take Rǫ = 1K f (ǫ|D|) 1K as in (171). It is by construction
an element of R+ 1 . Moreover since f (ǫ|D|) → 1 strongly in H one gets that Rǫ → 1
strongly in 1K H. By Lemma 9.4 one has
                   1
        k[Rǫ , a] − ǫ(1K f ′ (ǫ|D|)bδ(a)1K + 1K δ(a)bf ′ (ǫ|D|)1K )k(p,1) = O(ǫ)
                   2
Using
                         1K f ′ (ǫ|D|)bδ(a)1K = 1K b f ′ (ǫ|D|)bδ(a)1K
and (155) for A = 1K , T = b f ′ (ǫ|D|)b, B = δ(a)1K and similarly for the other
term, one gets an estimate of the form
                    k[Rǫ , a]k(p,1) ≤ O(ǫ) + kǫbf ′ (ǫ|D|)bk(p,1) kδ(a)k∞
Thus, by Lemma 9.8 one gets that, for any b ∈ A+ equal to 1 on K, there exists a
sequence ǫq → 0 such that
                                                  Z
                    kǫq bf (ǫq |D|)bk(p,1) ≤ 2Cf ( −b2 |D|−p )1/p
                          ′                    ′


which gives, for q large enough,
                                                Z
                         k[Rǫq , a]k(p,1) ≤ 2Cf′ ( −b2 |D|−p )1/p kδ(a)k∞

for any a ∈ A and hence:
                                                               Z
            lim inf max k[Rǫ , aj 1K ]kJ ≤ 2Cf′ max kδ(aj )k∞ ( −b2 |D|−p )1/p

After varying b one obtains the required estimate.                                       

Remark 9.10. a) One may worry that Voiculescu’s definition of kJ involves the
ordered set R+
             1 while all we got was Rǫ → 1 strongly in 1K H. Thus let us briefly
mention how to get the A ↑ 1 from Rǫ by a small modification. Given a finite

  12This is the natural extension of λ given by the Riesz representation Theorem [23].

                                                46
dimensional subspace of 1K H, one lets P be the corresponding finite rank projec-
tion, with fixed rank N . One needs to construct A ∈ R+
                                                      1 , A ≥ P with a control on
max k[A, aj 1K ]kJ . One takes
                             Aǫ = P + (1 − P )Rǫ (1 − P ) ,
so that A ≥ P by construction. Moreover one has
(179)          Rǫ − Aǫ = P (Rǫ − 1)P + P Rǫ (1 − P ) + (1 − P )Rǫ P .
Moreover by the strong convergence Rǫ → 1, one has
                         kP (Rǫ − 1)k∞ = k(Rǫ − 1)P k∞ → 0
so that all three terms in the rhs of (179) converge to 0 in norm and hence in the
J norm since their rank is less than N so that one can use (154). Thus one has
                                    kRǫ − Aǫ kJ → 0
and one controls max k[A, aj 1K ]kJ from max k[Rǫ , aj 1K ]kJ .
b) It might seem possible at first sight to tensor the spectral triple (A, H, D) by
(C, H′ , D′ ), with the spectrum of D′ growing fast enough so that the product triple13
(180)                  (A ⊗ C, H ⊗ H′ , D′′ = D ⊗ 1 + γ ⊗ D′ )
would still be of dimension p, i.e. such that the characteristic values of the inverse
of D′′ are O(n−1/p ). Let us show that this is only possible if the dimension of H′
                                                                            ′
is finite. Indeed the eigenvalues of (D ⊗ 1 + γ ⊗ D′ )2 = D2 ⊗ 1 + 1 ⊗ D 2 are the
                                                     ′
independent sums of the eigenvalues of D2 and of D 2 . Thus having infinitely many
                  ′
eigenvalues of D 2 contradicts the two inequalities
                             α(λ) ≥ cλp , α′′ (λ) ≤ C ′′ λp
for the counting functions α(λ) = Tr(1[0,λ] (|D|), α′′ (λ) = Tr(1[0,λ] (|D′′ |) since they
yield
                                dim(H′ ) ≤ C ′′ /c .
                   ′
c) The constant Cf in (177) is given, up to a function of p alone, by
                     Z ∞             1/p
                ′           p−1                 1−1/p
               Cf =        u h(u)du          khk∞       , h = −f ′ ≥ 0 .
                         0
and one needs to check that there is a lower bound to Cf′ independently of the
Rchoice
  ∞
        of the cutoff function f . Since f (0) = 1 the only information is about
  0
     h(u)du = 1 and thus one needs to show a general inequality of the form:
               Z ∞                  Z ∞              1/p
(181)               h(u)du ≤ c(p) p       up−1 h(u)du         1−1/p
                                                           khk∞     .
                 0                       0

To prove this one lets g(u) = h(u1/p ), so that
                                                           1 ∞ 1/p−1
        Z ∞                 Z ∞            Z ∞                Z
      p     up−1 h(u)du =         g(v)dv ,      h(u)du =          v  g(v)dv
         0                   0              0              p 0
                                                                      Ru
and one uses the same argument as in Remark 9.6. First, with k(u) = 0 g(v)dv,
                  Z ∞                           Z ∞
                         1/p−1                1
                       v       g(v)dv = (1 − )       v 1/p−2 k(v)dv
                    0                         p 0
  13in the even case

                                             47
RNext,
  ∞
       assuming khk∞ = 1, one has g(v) ≤ 1 for all v > 0 and thus, with ρ =
  0 g(v)dv,
            Z ∞                  Z ρ                  Z ∞
                v 1/p−2 k(v)dv ≤     v 1/p−2 k(v)dv +     v 1/p−2 k(v)dv
                 0                        0                  ρ

so that, since k(v) ≤ v and k(v) ≤ ρ one gets
            Z ∞                   Z ρ              Z ∞
                   1/p−2                1/p−1
                 v       k(v)dv ≤     v       dv +     v 1/p−2 ρdv = cp ρ1/p
             0                        0                 ρ

with cp = p + (1 − p1 )−1 which gives (181) with c(p) = 1.

We can now combine this with Theorem 4.5 of [25] which gives the equality, valid
for p self-adjoint operators hj ,
                                              Z
(182)                        kJ ({hj })p = γp   m(y)dp y
                                                   Rp

Corollary 9.11. Let aj = a∗j ∈ A be p self-adjoint elements, then for any compact
subset K ⊂ X one has
                   Z
(183)                        mK      p     ′             p
                              ac (y)d y ≤ κp max kδ(aj )k∞ λ(K)
                        Rp

where the constant κ′p only depends on p, and the function mKac (y) is the multiplicity
of the Lebesgue spectrum of the restriction of the aj to 1K (H).


                       10. Local bound on #(s−1
                                             α (x) ∩ V )

Let V ⊂ Uα be an open set with V ⊂ Uα .
Lemma 10.1. There exists C < ∞ such that the spectral multiplicity mVac (x), on
the absolutely continuous joint spectrum of the restriction ajα |V of the ajα , to 1V H
fulfills:
(184)                    mVac (x) ≤ C , a.e. on W = sα (V )
Proof. By Theorem 8.5, the joint spectral measure of the ajα |V is the Lebesgue
measure on sα (V ). Let E ⊂ W be a compact subset, and K = s−1 α (E) ∩ V . Then
Corollary 9.11 gives an inequality of the form
                             Z
(185)                             mK       p     ′
                                    ac (y)d y ≤ κ λ(K)
                                 Rp
One has
(186)                         mVac (y) ≤ mK
                                          ac (y) ,      ∀y ∈ E
since one has a direct sum decomposition
                         1V H = 1s−1
                                  α (E)∩V
                                          H ⊕ 1s−1  c
                                                α (E )∩V
                                                         H
where the representation in the second term in the right hand-side does not con-
tribute to the multiplicity in E. Indeed, with E c = ∪En and En compact disjoint
from E, the joint spectrum of ajα |s−1
                                    α (En )∩V
                                              is contained in En and disjoint from E.
Moreover the representation in the first term is dominated by the representation in
1K H since s−1                   −1
             α (E) ∩ V ⊂ K = sα (E) ∩ V .
                                              48
By (136) one has an inequality
      Z                  Z                  Z
          f ◦ sα dλV ≤ c       f (x)dxp ≤ c                   f (x)dxp ,   ∀f ∈ Cc+ (Rp ) ,
        V                    sα (V )                     Rp
which shows, taking 1E = inf fn as an infimum of continuous functions fn ∈
Cc+ (Rp ), that
                Z               Z                 Z               Z
      λ(K) =      1E ◦ sα dλV ≤   fn ◦ sα dλV ≤ c   fn (x)dxp → c   dxp .
               V                       V                          Rp                 E
Thus, using (186) and (185),
             Z                 Z                               Z
                mVac (x)dp x ≤   mK
                                  ac (x)dp
                                           x ≤ κ ′
                                                   λ(K) ≤ cκ ′
                                                                 dxp .
               E                    E                                       E
                                           ′
and there exists a constant C = cκ such that, for any compact E ⊂ W ,
                            Z                  Z
(187)                            V     p
                               mac (x)d x ≤ C     dp x
                                E                             E
which gives the inequality, valid almost everywhere,
                                           mVac (x) ≤ C .
                                                                                              
Lemma 10.2. Let V be as above. Then there exists m < ∞ such that
(188)                  #(s−1
                          α (x) ∩ V ) ≤ m ,             ∀x ∈ W = sα (V )
Proof. By Theorem 8.5, one has, almost everywhere,
                   mVac (y) ≥ n(y) = #{s−1
                                        α (y) ∩ V } ,             ∀y ∈ sα (V ) ,
so that the result follows from Lemma 10.1 and the semi-continuity of n(y) which
shows that an almost everywhere inequality remains valid everywhere.          
Lemma 10.3. Let V ⊂ Uα be an open set with V ⊂ Uα . There exists a dense open
subset Y ⊂ sα (V ) such that every point of s−1
                                             α (Y ) ∩ V has a neighborhood N in X
such that the restriction of sα to N is an homeomorphism with an open set of Rp .
Proof. Let W = sα (V ) and
                               m1 = sup #(s−1
                                           α (x) ∩ V )
                                           x∈W

which is finite (and non-zero) by Lemma 10.2. Let
                        W1 = {x ∈ W | #(s−1
                                         α (x) ∩ V ) = m1 }
It is by Lemma 8.1 an open subset of W . Moreover for x ∈ W1 one can find m1
disjoint open neighborhoods Vj of the preimages xj of x such that all Vj surject on
the same neighborhood U of x in W . It follows that the restriction of sα to each
of the Vj is a bijection onto U and hence an isomorphism of a neighborhood of xj
with an open set in Rp given by the ajα .
It can be that W1 is not dense in W , but then we just take the complement of its
closure: W 1 = W \W 1 and let
                              m2 = sup #(s−1
                                          α (x) ∩ V )
                                           x∈W 1
which is < m1 by construction. One then defines
                        W2 = {x ∈ W 1 | #(s−1
                                           α (x) ∩ V ) = m2 }
                                                   49
which is by Lemma 8.1 an open subset of W 1 . The same argument as above shows
that the subset Z = W1 ∪ W2 fulfills the condition of the Lemma. One proceeds in
the same way and gets, by induction, a sequence Wk , with Y = ∪Wj fulfilling the
condition of the Lemma. Since the sequence mj is strictly decreasing one gets that
the process stops and Y is dense in W .                                         


                        11. Reconstruction Theorem
We shall now use Lemma 10.3 together with the ability to move around in X by
automorphisms of A to prove the following key Lemma:
Lemma 11.1. For every point χ ∈ X there exists p real elements xµ ∈ A and a
smooth family τt ∈ Aut(A), t ∈ Rp , τ0 = Id, such that
     • The xµ give an homeomorphism of a neighborhood of χ with an open set in
       Rp .
     • The map t 7→ h(t) = χ ◦ τt is an homeomorphism of a neighborhood of 0 in
       Rp with a neighborhood of χ.
     • The map x ◦ h is a local diffeomorphism.
Proof. Let χ ∈ X. By Lemma 4.4, there exists α such that χ ∈ Uα . By Lemma
4.5, there exists a smooth family σt ∈ Aut(A), t ∈ Rp , a neighborhood Z of χ in
X = Spec(A) and a neighborhood W of 0 ∈ Rp such that, for any κ ∈ Z, the
map t 7→ sα (κ ◦ σt ) is a diffeomorphism, depending continuously on κ, of W with
a neighborhood of sα (κ) in Rp .
We now take for V a ball
                V = Br = {y ∈ X | d(χ, y) < r} ⊂ Uα , V ⊂ Uα .
We apply Lemma 10.3 to V = Br and let Y be a dense open subset Y ⊂ sα (V )
such that every point of s−1 α (Y ) ∩ V has a neighborhood N in X such that the
restriction of sα to N is an homeomorphism with an open set of Rp . Since Y is
dense in sα (V ), and by Lemma 4.5 the image of W by t 7→ ψ(t) = sα (χ ◦ σt ) is an
open neighborhood of sα (χ) one can choose a u0 ∈ W such that χ ◦ σu0 ∈ V and
ψ(u0 ) = sα (χ ◦ σu0 ) ∈ Y . One has κ = χ ◦ σu0 ∈ s−1
                                                     α (Y ) ∩ V . Thus by Lemma
10.3 there exists a neighborhood N of κ such that the restriction of sα to N is an
isomorphism with an open set of Rp . Thus the aµα are good local coordinates near
κ. The automorphism σu0 ∈ Aut(A) is such that
(189)                        κ = χ ◦ σu0 , χ = σu0 (κ)
Recall that we use the covariant notation (131). We take
(190)                               xµ = σu0 (aµα )
as local coordinates near χ. The corresponding map x from X = Spec(A) to Rp is
given by
            ζ ∈ X 7→ ζ(xµ ) = ζ(σu0 (aµα )) = sα (ζ ◦ σu0 ) = sα ◦ σu−1
                                                                      0
                                                                        (ζ)
Thus x = sα ◦ σu−1
                 0
                   and, since σu0 is an homeomorphism of X, x = sα ◦ σu−10
                                                                           is an
homeomorphism of the neighborhood σu0 (N ) of χ with an open set of Rp . Thus
the xµ are good local coordinates at χ. Then let τt ∈ Aut(A) be given by
                                  τt = σu0 +t ◦ σu−1
                                                   0
                                          50
so that τt ◦ σu0 = σu0 +t . One has
    χ ◦ τt (xµ ) = χ ◦ τt (σu0 (aµα )) = χ ◦ σu0 +t (aµα ) = sµα (χ ◦ σu0 +t ) = ψ µ (u0 + t)
Now the map h is given by t 7→ h(t) = χ ◦ τt thus one has
(191)                               x ◦ h(t) = ψ(u0 + t)
This shows that the map x ◦ h is a diffeomorphism from W1 = W − u0 (which
is a neighborhood of t = 0 ∈ Rp since u0 ∈ W ) with an open set of Rp . On
W1 , the map h is injective since x ◦ h is injective. Thus h is an homeomorphism
with its range. One has h(0) = χ, h is continuous thus W2 = h−1 (σu0 (N )) ∩
W1 is an open set containing 0 and W2′ = x ◦ h(W2 ) is an open set in Rp . The
map x is an homeomorphism of σu0 (N ) with an open set in Rp and x ◦ h is an
homeomorphism of W1 with an open set in Rp . One has h(W2 ) ⊂ σu0 (N ). Thus
h(W2 ) = x−1 (W2′ ) ∩ σu0 (N ) is open in σu0 (N ) and since it contains h(0) = χ we
get that h is an homeomorphism of a neighborhood of 0 in Rp with a neighborhood
of χ. Moreover, as we have seen above, the map x ◦ h is a diffeomorphism.          
Lemma 11.2. The algebra A is locally the algebra of restrictions of smooth func-
tions on Rp to a bounded open set of Rp .
Proof. Let χ ∈ X. By Lemma 11.1, we can assume that some xµ ∈ A give an
homeomorphism of a neighborhood U of χ with a bounded open set x(U ) ⊂ Rp .
By the smooth functional calculus the algebra Cc∞ (x(U )) is contained in A using
the morphism f ∈ Cc∞ (x(U )) 7→ f (xµ ) ∈ A . Moreover for any κ ∈ U one has
κ(f (xµ )) = f (κ(xµ ) so that the function f ◦ x coincides on U with the element
f (xµ ) ∈ A. Taking a smaller neighborhood V of χ with compact closure in U one
gets that the algebra C ∞ (Rp )|x(V ) of restrictions to x(V ) of smooth functions on Rp
is contained in the algebra of restrictions to V of elements of A, using x to identify
V with the open set x(V ) ⊂ Rp . We need to show that any element of A restricts
to a smooth function on V , using the local coordinates x to define smoothness. For
this we use (Lemma 11.1) the existence of a smooth family τ : Rp → Aut(A) such
that x ◦ τ is a local diffeomorphism around χ. Thus given b ∈ A, to show that the
restriction of b to V is smooth, it is enough to show that τt (b) evaluated at χ is a
smooth function of t. This follows from the smoothness of the family τt .              
Theorem 11.3. Let (A, H, D) be a strongly regular spectral triple fulfilling the
five conditions of §2 (cf. [11]) with c antisymmetric Then there exists an oriented
smooth compact manifold X such that A = C ∞ (X).
Proof. We let X = Spec(A) be the spectrum of A or equivalently of the norm
closure A. By construction it is a compact space. By Lemma 11.1, for every point
χ ∈ X there exists a neighborhood U of χ and p real elements xµ ∈ A which give a
local homeomorphism φ of a neighborhood V of x with an open set in Rp . Moreover
by Lemma 11.2 one has
                           f ∈ A|V ⇔ f ◦ φ−1 ∈ C ∞ (Rp )|φ(V )
This shows that on the intersection of such domains of local charts, the change
of chart is of class C ∞ . We can thus, using compactness, take a finite cover and
this endows X with a structure of p-dimensional smooth manifold. Lemma 11.2
shows that any a ∈ A restricts to a smooth function in each local chart and thus
A ⊂ C ∞ (X). Moreover given f ∈ C ∞ (X) there exists for each Vj in the finite open
                                               51
cover of X an aj ∈ A with f |Vj = aj |Vj . Then the existence of partitions of unity
(Lemma 2.10 of [22]):
                                 X
                       ψj ∈ A ,      ψj = 1 , Support ψj ⊂ Vj
                            P
shows that f agrees with      ψj aj ∈ A. We have shown that there exists a smooth
compact manifold X such that A = C ∞ (X). The cycle c gives a nowhere vanishing
section of the real exterior power ∧p (T X) and hence shows that the manifold X is
oriented.                                                                         
We thus obtain the following characterization of the algebras C ∞ (X):
Theorem 11.4. An involutive algebra A is the algebra of smooth functions on an
oriented smooth compact manifold if and only if it admits a faithful 14 represen-
tation in a pair (H, D) fulfilling the five conditions of §2 (cf. [11]) with the cycle
antisymmetric and the strong regularity.
Proof. The direct implication follows from Theorem 11.3. Conversely, given an
oriented smooth compact manifold X of dimension p, one can take the represen-
tation in H = L2 (X, ∧∗C ) the Hilbert space of square integrable differential forms
with complex coefficients, and use the choice of a Riemannian metric to get the
signature operator D = d + d∗ with the Z/2-grading γ in the even case coming
from the Clifford multiplication by the volume form as in [18] Chapter 5. In the
odd case one uses the Clifford multiplication γ by the volume form to reduce the
Hilbert space H to the subspace given by γξ = ξ. More specifically we consider the
faithful representation of the Clifford algebra Cliff Tx∗ (X) in ∧∗ Tx∗ (X) given by the
symbol of D, i.e.
(192)               v. ξ = v ∧ ξ − iv ξ ,     ∀v ∈ Tx∗ (X) , ξ ∈ ∧∗ Tx∗ (X)
where iv is the contraction by v. This gives (cf. [18] Proposition 3.9) a canonical
isomorphism of vector spaces Cliff Tx∗ (X) ∼ ∧∗ Tx∗ (X). We let ω be the section
of ∧p T ∗ X given at each point by ω = e1 ∧ · · · ∧ ep where e1 , . . . ep is any pos-
itively oriented orthonormal basis. In the Clifford algebra Cliff Tx∗ (X) one has
            p(p+1)
ω 2 = (−1) 2 (cf. [18] (5.26)) and one defines
                                   p(p+1)
(193)                   γ ξ = i−      2     ωξ,    ∀ξ ∈ Cliff Tx∗ (X) ⊗ C
where the product ω ξ is the left Clifford multiplication by ω. By [18] (5.35) this
left multiplication is related to the Hodge star operation by
                                                  k(k+1)
(194)                    ω ξ = (−1)k(p−k)+           2     ⋆ξ,   ∀ξ ∈ ∧k .
With these notations one has d∗ = (−1)(p+1) γdγ (cf. [18] (5.10)) which shows that
D commutes with γ when p is odd and anticommutes with γ when p is even.
To check the orientability condition 4), one uses (in both cases of the Dirac operator
or the signature operator) local coordinates xµ and the equalities
                               X
(195)                [D, f ] =     γ µ ∂µ f , {γ µ , γ ν } = −2g µν ,
where the γ µ correspond to the action of dxµ through the representation of the
Clifford algebra (given by (192) for the signature operator). One then has, for the

  14i.e. with trivial kernel

                                                  52
multiple commutator,
                                                                  p(p+1)    √
(196)                         [γ 1 , γ 2 , . . . , γ p ] = p! i      2     ( g)−1 γ
       √
where g is the square root of the determinant of the matrix gµν and γ = γ ∗ ,
γ 2 = 1 is the grading in the even case and is just 1 in the odd case15. Thus in these
local coordinates xµ the cycle associated to the volume form:
                            1 X       √
                        c=        ǫ(σ) g ⊗ xσ(1) ⊗ · · · ⊗ xσ(p)
                            p! σ
                                                                           p(p+1)
fulfills, locally, condition 4), up to the power of i, i 2 . Using a partition of unity
gives the global form of c which is just the Hochschild cycle representing the global
volume form.
The condition of strong regularity is checked using §13. One applies Lemma 13.2 to
obtain the strong regularity since we take for D an elliptic differential operator of
order one on a smooth compact manifold and the principal symbol of D2 is a scalar
multiple of the identity. This ensures that for any differential operator P of order
m the symbol of order m + 2 of [D2 , P ] vanishes as it is given by the commutator
of the principal symbols of order m and 2. Thus one gets that for any differential
operator T of order 0, the operators δ1m (T ) are of the form P (1 + D2 )−m/2 where
P is a differential operator of order m. Thus the theory of elliptic operators (cf.
[15] Lemma 1.3.4 and 1.3.5) shows that they are bounded. This applies for D the
Dirac operator or the signature operator, thus one gets the strong regularity in this
case.                                                                                
Theorem 11.5. Let (A, H, D) be a spectral triple with A commutative, fulfilling the
five conditions of §2 with the cycle c antisymmetric. Assume that the multiplicity16
of the action of A′′ in H is 2p/2 . Then there exists a smooth oriented compact
(spinc ) manifold X such that A = C ∞ (X).
Proof. We need to show that we can dispense with the hypothesis of strong regu-
larity in Theorem 11.3. Indeed by the first part of Remark 5.12, we get
(197)             [([D, a][D, b] + [D, b][D, a]), [D, c]] = 0 ,                     ∀a, b, c ∈ A
since this is implied by the commutation (78) of |[D, h]| with [D, c]. Thus if we work
at a point χ ∈ Spec(A) and let Sχ be the fiber at χ ∈ X of the finite projective
module H∞ and Mχ ⊂ EndSχ be the subalgebra generated by the [D, a] for a ∈ A,
it follows from (197) that
(198)                 [D, a][D, b] + [D, b][D, a] ∈ Z(Mχ ) ,                        ∀a, b ∈ A
where Z(Mχ ) is the center of Mχ . Let e be a minimal projection in the center of
Mχ . The equality πD (c) = γ shows that, at the point χ,
                        X
                  γe =      ea0α [[D, a1α ], [D, a2α ], . . . , [D, apα ]] 6= 0
                                α

so that the dimension of the space Te∗ (χ) = {e[D, a] | a ∈ A}χ is at least equal to
p. In fact, more precisely, for some α, the multiple commutator
        [e[D, a1α ], e[D, a2α ], . . . , e[D, apα ]] = e[[D, a1α ], [D, a2α ], . . . , [D, apα ]] 6= 0
  15Since we reduced the Hilbert space H to the subspace given by γξ = ξ
  16We restrict to the even case

                                                        53
which can hold only if the e[D, ajα ] are linearly independent. By (198) and the
minimality of e, the following equality defines a positive quadratic form Q on the
self-adjoint part of Te∗ (χ):
(199)                    Q(e[D, a])e = (e[D, a])2 ,           ∀a ∈ A .
It is non-degenerate since when e[D, a] is self-adjoint, (e[D, a])2 = 0 implies e[D, a] =
0. Let then CQ be the Clifford algebra associated to the quadratic form Q on the
self-adjoint part of Te∗ (χ). The latter has real dimension ≥ p and the relations (198)
show that the map e[D, a] 7→ e[D, a] gives a representation of CQ in the complex
vector space eSχ . Thus this shows that the dimension of eSχ is then at least equal
to 2p/2 . The hypothesis of the Theorem on the multiplicity of the action of A′′ in
H shows, using the condition of absolute continuity, that the fiber dimension of S
is 2p/2 . This shows that e = 1 and also, since the complexification of the algebra
CQ is an N × N matrix algebra for N ≥ 2p/2 , that Mχ = EndSχ for every χ ∈ X.
It also shows that the dimension of T ∗ (χ) is equal to p and that on Uα the [D, ajα ]
form a basis of T ∗ (χ). Consider then the following monomials
                         µF = [[D, ajα1 ], [D, ajα2 ], . . . , [D, ajαk ]]
where F = {j1 < j2 < . . . < jk } is a subset with k elements of {1, 2, . . . , p}.
For every χ ∈ Uα the µF form a basis of Mχ = EndSχ . Thus any element T of
Mχ = EndSχ can be uniquely written in the form
                                    X
(200)                         T =      aF µF

The coefficients aF can be computed using the normalized trace on EndSχ , the
µF and the element T . Thus using the conditional expectation EA of (37) one
gets, for any endomorphism T of H∞ with support in Uα , that (200) holds with
coefficients aF ∈ A. This shows that any endomorphism T of H∞ is a polynomial
in the [D, a] with coefficients in A and it follows that it is automatically regular.
Thus the strong regularity holds and we can apply Theorem 11.3. To see that X is
a spinc manifold one uses [11] (see [14] for the detailed proof).                  



                                  12. Final remarks
12.1. The role of D. By Lemma 2.1, the spectral triple (A, H, D) is entirely
determined by (A′′ , H, D) where M = A′′ is the commutative von Neumann algebra
weak closure of A. It follows in particular that, except for the dimension N of
the bundle S which we may assume, for simplicity, to be constant and equal to
2p/2 , there is no information in the pair (A′′ , H): they are all pairwise isomorphic.
Similarly the only invariant of the pair (H, D) is the spectrum of D i.e. a list of real
numbers with multiplicity. By [20] this spectrum does not suffice to reconstruct the
geometry, and it is natural to wonder what additional invariant is required to do
so. As we shall briefly explain it is the relative position of M and of the self-adjoint
operator D which selects one geometric space, and it is worthwhile to look at the
conditions from this point of view. The analogue in our context of the geodesic
flow is the following one parameter group
(201)                   γt (T ) = eit|D| T e−it|D| ,      ∀T ∈ L(H) .
                                                54
We say17 that an operator T ∈ L(H) is of class C ∞ when the map from R to L(H)
given by t 7→ γt (T ) is of class C ∞ (for the norm topology of L(H)) and we denote
by C ∞ (H, D) this subalgebra of L(H). This algebra only depends upon (H, D) and
does not yet measure the compatibility of (M, H) and (H, D). This is measured by
the weak density in M of
(202)      C ∞ (M, H, D) = {T ∈ M ∩ C ∞ (H, D) |[D, T ] ∈ M ′ ∩ C ∞ (H, D)}
where M ′ is the commutant of M . One checks that A = C ∞ (M, H, D) is a subal-
gebra of M and its size measures the compatibility of (M, H) and (H, D).
We now come to two equations which assert that A = C ∞ (M, H, D) is large enough,
so that we have maximal compatibility. One checks that H∞ = ∩DomDm is
automatically a module over A (for the obvious action). The first equation requires
that this module is finite and projective and that it admits a hermitian structure
( | ) (necessarily unique) such that:
                               Z
(203)               hξ, a ηi = − (ξ|η) a |ds|p , ∀a ∈ A, ∀ξ, η ∈ H∞
        R
where − is the noncommutative integral given by the Dixmier trace.
The second equation means that we can find an element c of the tensor power A⊗n ,
n = p + 1, totally antisymmetric in its last p-entries, and such that
(204)   c(D) = 1 , where (a0 ⊗ · · · ⊗ ap )(D) = a0 [D, a1 ] · · · [D, ap ] ,   ∀aj ∈ A .
(This assumes p odd, in the even case one requires that for some c as above c(D) = γ
fulfills γ = γ ∗ , γ 2 = 1, γD = −Dγ). We can now restate Theorem 11.5 as:
Theorem 12.1. Let (M, H, D) fulfill (202), (203) and (204), and N = 2p/2 , then
there exists a unique smooth compact oriented spinc Riemannian manifold (X, g)
such that the triple (M, H, D) is given by
      • M = L∞ (X, dv) where dv is the Riemannian volume form.
      • H = L2 (X, S) where S is the spinor bundle.
      • D is a Dirac operator associated to the Riemannian metric g.
Proof. We let A = C ∞ (M, H, D). By the weak density in M of (202), we know
that the multiplicity of the action of A′′ = M in H is N = 2p/2 . By construction
the triple (A, H, D) fulfills the first three conditions . The fourth and fifth follow
from (203) and (204). Thus by Theorem 11.5 we get that A = C ∞ (X) for a smooth
oriented compact spinc manifold X. The conclusion then follows from [11] (see [14]
for the detailed proof). Note that there is no uniqueness of D since we only know
its principal symbol. This is discussed in [11] and [14].                            
A striking feature of the above formulation is that the full information on the
geometric space is subdivided in two pieces
    (1) The list of eigenvalues of D.
    (2) The unitary relation F between the Hilbert space of the canonical pair
        (M, H) and the Hilbert space of the canonical pair (H, D).
Of course the conceptual meaning of the unitary F is the Fourier transform, but
this second piece of data is now playing a role entirely similar to that of the CKM
matrix in the Standard Model [6]. Moreover, in the latter, the information about
the Yukawa coupling of the Higgs fields with the Fermions (quarks and leptons) is
  17cf. Lemma 13.3 of §13

                                             55
organised in a completely similar manner, namely 1) The masses of the particles
2) The CKM (and PMNS) matrix. At the conceptual level, such matrices describe
the relative position of two different bases in the same Hilbert space. They are
encoded by a double coset space closely related to Shimura varieties ([6]). These
points deserve further investigations and will be pursued in a forthcoming paper.


12.2. Finite propagation. One can use in the above context a result of Hilsum
[17] to obtain:

Lemma 12.2. The support of the kernel kt (x, y) of the operator eitD is contained
in
                                 {(x, y) ∈ X 2 | d(x, y) ≤ |t|}
where the distance d is defined as

                         d(x, y) = sup |h(x) − h(y)| , k[D, h]k ≤ 1

Proof. Let (x, y) ∈ X 2 with d(x, y) > |t|. There exists h = h∗ in A such that
k[D, h]k ≤ 1 and h(y) − h(x) > |t|. Also h and [D, h] commute by the order one
condition. Thus by Lemma 1.10 of [17], one has b < h(y), a > h(x) such that:

                                 (h − b)+ e−itD (h − a)− = 0

so that kt (x, y) = 0.                                                                  



12.3. Immersion versus embedding. The proof of Theorem 11.3 shows that,
with the cycle c given by (36), the map ψ from X to RN given by the components
ajα for j ≥ 1 is an immersion. It is not however an embedding in general even
if one includes the components a0α . To see this consider open balls B ⊂ Rp and
B1 ⊂ B such that for some translation v the ball B2 = B1 + v is disjoint from B1
and contained in B. Then let xµ be the coordinates in Rp and aj1 ∈ Cc∞ (B) be such
that
                aj1 (x) = xj ,    ∀x ∈ B1 , aj1 (x) = xj − v j ,     ∀x ∈ B2

Let N be a neighborhood of the complement of B1 ∪ B2 in B. Let then aj2 (x) =
b(x)xj where b(x) = 1 for all x ∈ N and vanishes in an open set of the form B1′ ∪ B2′
where the Bj′ ⊂ Bj are smaller concentric balls. Let a0α be a partition of unity in
B for the covering by B1 ∪ B2 and N . Then let c be the antisymmetrization of
                                   2
                                   X
                                        a0α ⊗ a1α ⊗ · · · ⊗ apα
                                    1

For x ∈ B1′ all the aj2 vanish, including a02 , and a01 = 1 so that the following equality
shows that the map ψ is not injective:

                             aj1 (x + v) = aj1 (x) ,    ∀x ∈ B1′ .

                                                56
12.4. The antisymmetry condition. We have used throughout the stronger
form of condition 4) where the Hochschild cycle c ∈ Hp (A, A) is assumed to be
totally antisymmetric in its last p-entries. It is unclear that one can relax the
antisymmetry condition on c. It is not true in general for commutative algebras
that any Hochschild class can be represented in this way, but this is the case for
A = C ∞ (X). In general, one has a natural projection on the antisymmetric chains,
given by the antisymmetrisation map P . It is defined by the equality
                                         1 X
             P (a0 ⊗ a1 ⊗ · · · ⊗ ap ) =     ǫ(β)a0 ⊗ aβ(1) ⊗ · · · ⊗ aβ(p)
                                         p!
                                              β

Its range is contained in Zp (A, A) since A is commutative and any antisymmetric
chain is a cycle ([19] Proposition 1.3.5). It is not obvious that P maps Hochschild
boundaries to Hochschild boundaries. This follows from the equality
                                             1
                                      P =       εp ◦ πp
                                             p!
where one lets ΩpK = ∧pA Ω1K be the A-module of Kähler p-forms (cf. [19] 1.3.11)
and
(205)              εp : ΩpK → Hp (A, A) , πp : Hp (A, A) → ΩpK
are defined in [19] Proposition 1.3.12 and Proposition 1.3.15. They are given by
(206)                πk (a0 ⊗ a1 ⊗ · · · ⊗ ak ) = a0 da1 ∧ · · · ∧ dak
and
                                             X
(207)         εk (a0 da1 ∧ · · · ∧ dak ) =       ǫ(σ)a0 ⊗ aσ(1) ⊗ · · · ⊗ aσ(k)


12.5. Strong regularity. The hypothesis of strong regularity is, in general, stronger
than regularity. Indeed the operation of direct sum (A, H1 ⊕ H2 , D1 ⊕ D2 ) of two
spectral triples for the same algebra A preserves regularity but not, in general,
strong regularity.
Proposition 12.3. Assuming regularity the subalgebra ZD (A) of EndA (H∞ ) gen-
erated by A and the [D, b][D, c] + [D, c][D, b] for b, c ∈ A is a commutative algebra
containing A and commuting with [D, a] for all a ∈ A.
Proof. This follows from Remark 5.12 since (78) shows that [D, b]2 commutes with
[D, a] for all a ∈ A.                                                         

The understanding of the general situation when one does not assume strong reg-
ularity should be an interesting problem since the inclusion A ⊂ ZD (A) should
correspond to a finite “ramified cover” of the corresponding spectra, with Y =
SpecZD (A) covering X = SpecA. It is easy to construct examples where Y has
singularities. It is not clear that, assuming the first five conditions, the space X is
always smooth. Similarly it is unclear what happens if one relaxes the regularity
condition to the Lipschitz regularity, since we made heavy use of at least C 1+ǫ -
regularity in the above proofs. Finally it would be interesting also to investigate
the meaning of real analyticity of the space X in terms of the real analyticity of the
geodesic flow (201).
                                              57
12.6. The Noncommutative case. Among the five conditions of §2 the condi-
tions 1), 3) and 5) make no use of the commutativity of the algebra A and they
extend as such to the noncommutative case. We refer to [11] for the extension
of conditions 2) and 4) to the noncommutative case. The extension of the order
one condition involves a new key ingredient which is an antilinear unitary operator
J in H which encodes the nuance between spin and spinc . It turns out to be an
incarnation not only of the charge conjugation in physics terms and of the needed
“real structure” to refine the K-theoretic meaning of the spectral triple from ordi-
nary K-homology to KO-homology but, at a deeper level, of the Tomita operator
which plays in the noncommutative case the role of a substitute for commutativity.
All this plays an important role in the noncommutative geometry understanding of
the standard model [6], [4], [5]. The extension of the “orientability” condition 4)
exists and it certainly holds e.g. for noncommutative tori ([11]) but it is not fully
satisfactory yet and its clarification should be considered as an open question.


                           13. Appendix 1: Regularity
The condition of regularity is not easy to check for smooth manifolds since it involves
the module of the operator D. We give below the equivalent formulation in terms
of D2 (cf. [13]).
We deal with operators T which act on H∞ = ∩DomDn . We say that T is bounded
when
(208)                   kT k = sup{kT ξk | ξ ∈ H∞ , kξk ≤ 1}
is finite. We still denote by T the unique continuous extension to a bounded
operator in H. By self-adjointness of D the domain H∞ is a core for powers of
D or of |D|. The derivation δ(T ) = [|D|, T ] is defined algebraically as an operator
in H∞ . The relation with the commutator in H is given as follows.
Lemma 13.1. Assume that both T and [|D|, T ] are bounded (as in (208)). Then
T preserves Dom|D| = DomD and the bounded extension of [|D|, T ] coincides with
the commutator |D|T − T |D| on Dom|D|.
Proof. Let ξ ∈ Dom|D|. There exists a sequence ξn ∈ H∞ with ξn → ξ and
|D|ξn → |D|ξ. Since T is bounded the sequences T ξn and T |D|ξn are convergent
and converge to T ξ and T |D|ξ. Since [|D|, T ] is bounded the sequence (|D|T −
T |D|)ξn converges. Thus |D|T ξn converges, and as |D| is closed one gets that T ξ
is in the domain of |D|. Thus Dom|D| is invariant under T . Moreover one has
|D|T ξ = (|D|T − T |D|)ξ + T |D|ξ.                                              

In other words, saying that both T and [|D|, T ] are bounded is equivalent, for
operators acting in H∞ to T ∈ Domδ and moreover δ(T ) is then the bounded
extension of |D|T − T |D|.
We introduce the following variant of δ, defined on operators T acting in H∞ ,
(209)                        δ1 (T ) = [D2 , T ](1 + D2 )−1/2
Lemma 13.2. Let T acting in H∞ be bounded.
    (1) If δ1 (T ) and δ12 (T ) are bounded so is δ(T ).
    (2) The δ1n (T ) are bounded for all n iff so are the δ n (T ).
                                            58
Proof. (1) The module |D| is given by the following integral, which makes sense
when applied to any ξ ∈ DomD, which we omit for simplicity
                                    Z ∞
                                 2         D2
(210)                     |D| =                  du
                                 π 0 D 2 + u2
To avoid dealing with the kernel of D we use the decomposition δ = δ ′ + δ0 where
the derivations δ ′ and δ0 commute, and δ0 is bounded,
(211)                        δ ′ (T ) = [Q, T ] , Q = D2 (1 + D2 )−1/2

(212)           δ0 (T ) = [f0 (D), T ] , f0 (x) = |x| − x2 (1 + x2 )−1/2 ,   ∀x ∈ R
One has f ∈ C0 (R) and the derivation δ0 is bounded, in fact kδ0 k ≤ 1 since
kf0 k∞ < 1/2. One has
                                     Z ∞
                                  2           D2
(213)                       Q=                      du
                                  π 0 D 2 + 1 + u2
Thus
                                         Z ∞
                                       2         D2
(214)             δ ′ (T ) = [Q, T ] =       [ 2       , T ] du
                                       π 0 D + 1 + u2
      D2                     1 + u2                              1                    1
[              , T ] = −[                , T ] = (1 + u2 ) 2              [D2 , T ] 2
 D 2 + 1 + u2             D 2 + 1 + u2                    D + 1 + u2               D + 1 + u2
                       1 + u2                           1                          1
      = [D2 , T ] 2             2 2
                                      + (1 + u2 )[ 2           2
                                                                 , [D2 , T ]] 2
                  (D + 1 + u )                     D +1+u                    D + 1 + u2
Thus using
                 1                               1                             1
         [ 2             , [D2 , T ]] = − 2             [D2 , [D2 , T ]] 2
          D + 1 + u2                       D + 1 + u2                    D + 1 + u2
we get
         D2                 2           1 + u2          1          2      2            1 + u2
[                , T ] = [D   , T ]                −            [D   , [D   , T ]]
    D 2 + 1 + u2                    (D2 + 1 + u2 )2 D2 + 1 + u2                    (D2 + 1 + u2 )2
Thus combining with (214) one gets
                         1                             1
(215)        δ ′ (T ) = [D2 , T ](1 + D2 )−1/2 + [D2 , T ](1 + D2 )−3/2
                         2                             2
                      Z ∞
                   2             1                           1 + u2
               −             2          2
                                          [D2 , [D2 , T ]] 2             du
                   π 0 D +1+u                             (D + 1 + u2 )2
where we used           Z ∞
                      2              u2                 1
                                                du = (1 + D2 )−1/2 ,
                     π 0 (D + 1 + u2 )2
                                2                       2
and                     Z ∞
                      2               1                 1
                                2           2 2
                                                du = (1 + D2 )−3/2 .
                     π 0 (D + 1 + u )                   2
Now one has [D2 , [D2 , T ]] = δ12 (T )(1 + D2 ) and
                                        (1 + u2 )(1 + D2 )
                                    k                      k≤1
                                         (D2 + 1 + u2 )2
so that
                   1          2      2            1 + u2            1
          k                [D   , [D   , T ]]                 k≤k 2         kkδ12 (T )k
              D 2 + 1 + u2                    (D2 + 1 + u2 )2    D + 1 + u2
                                                 59
and one gets
(216)                        kδ ′ (T )k ≤ kδ1 (T )k + kδ12 (T )k .
Now if both δ1 (T ) and δ12 (T ) are bounded, we get that δ ′ (T ) is bounded and since
δ = δ ′ + δ0 with δ0 bounded, we get that δ(T ) is bounded, with
                                                2
                                                      kδ1j (T )k .
                                                X
(217)                            kδ(T )k ≤
                                                 0

(2) The operations δ and δ1 commute since |D| commutes with D2 . Let us assume
that the δ1n (T ) are bounded. We have seen that δ(T ) is bounded. To show that
δ 2 (T ) is bounded it is enough to show that δ1m (δ(T )) are bounded for m = 1, 2.
But δ1m (δ(T )) = δ(δ1m (T )) which is bounded since the δ1n (δ1m (T )) are bounded for
n ≤ 2, m ≤ 2. More generally let us show by induction on n an inequality of the
form
                                               2n
                                               X
(218)                          kδ n (T )k ≤          cn,k kδ1k (T )k
                                                0

To get it for n + 1, assuming it for n, one uses (217) which gives
                                     2                        2
                                         kδ1j (δ n (T ))k =          kδ n (δ1j (T ))k
                                     X                        X
                   kδ(δ n (T ))k ≤
                                     0                         0

                                       2n
                                     2 X
                                              cn,k kδ1k (δ1j (T ))k
                                     X
                               ≤
                                     0    0
                                          n
Thus we obtain by induction that δ (T ) is bounded.
Conversely, the boundedness of the δ n (T ) implies that of the δ1n (T ). Indeed the
                                                                           n
boundedness of the δ n (T ) is equivalent to the boundedness of the δ ′′ (T ) where
δ ′′ (T ) = [(1 + D2 )1/2 , T ] since |D| − (1 + D2 )1/2 is bounded and commutes with
|D|. Moreover the square of the operation
              T 7→ (1 + D2 )1/2 T (1 + D2 )−1/2 = T + δ ′′ (T )(1 + D2 )−1/2
is
                T 7→ (1 + D2 )T (1 + D2 )−1 = T + [D2 , T ](1 + D2 )−1
which gives
                                                                         2
          [D2 , T ](1 + D2 )−1 = 2δ ′′ (T )(1 + D2 )−1/2 + δ ′′ (T )(1 + D2 )−1
so that
                                                     2
                        δ1 (T ) = 2δ ′′ (T ) + δ ′′ (T )(1 + D2 )−1/2
and one can proceed as above to get the boundedness of the δ1n (T ).                    

Finally we relate the regularity condition with the smoothness of the geodesic flow
t → γt (T ) = eit|D| T e−it|D| of (49).
Lemma 13.3. Let T ∈ L(H), then the following conditions are equivalent:
  (1) T ∈ ∩m Dom δ m .
  (2) t → γt (T ) is of class C ∞ in the norm topology.
                                                60
Proof. Let us show that (1) ⇒ (2). By (10) T preserves H∞ . We write the Taylor
formula with remainder
                                          tn           tn+1 1
                                                           Z
(219)   f (t) = f (0) + tf ′ (0) + . . . + f (n) (0) +        (1 − u)n f (n+1) (tu)du
                                          n!            n! 0
for the function f (t) = eit|D| T e−it|D| ξ with ξ ∈ H∞ . Since T preserves H∞ this
function is of class C ∞ . One gets
(220)
                                    i n tn n        in+1 tn+1 1
                                                             Z
γt (T )ξ = T ξ + itδ(T )ξ + . . . +       δ (T )ξ +             (1 − u)n γtu (δ (n+1) (T ))ξdu
                                      n!               n!     0

since f (k) (s) = γs (δ (k) (T ))ξ by induction on k. This shows that t → γt (T ) is of
class C ∞ in the norm topology, since the norm of the remainder is O(tn+1 ). Let
us show the converse (2) ⇒ (1). It is enough to show that if T ∈ L(H)) and the
following limit exists in norm limt→0 1t (γt (T ) − T ), then T ∈ Domδ and the limit
is iδ(T ). One has, for ξ ∈ H,
                                                 1 it|D|
(221)                      ξ ∈ Dom|D| ⇔ ∃ lim      (e    ξ − ξ)
                                                 t
                                               t→0

where the limit is supposed to exist in norm. Assuming that for some bounded
operator Y ∈ L(H) one has limt→0 k 1t (γt (T ) − T ) − Y k = 0, one gets for any
ξ ∈ Dom|D|, that 1t (eit|D| T ξ − T ξ) → iT |D|ξ + Y ξ. This shows that T ξ ∈ Dom|D|
and that i|D|T ξ = iT |D|ξ + Y ξ which gives the required equality.               


        14. Appendix 2: The Dixmier trace and the heat expansion


We first recall the basic properties of the Dixmier trace. Recall that the character-
istic value µn (T ) of a compact operator T is the n-th eigenvalue of |T | arranged in
decreasing order and is equal to
(222)                          inf{kT |E ⊥ k | dim E = n − 1}
Definition 14.1. We define the Weyl norms by
                                               N
                                               X
(223)                              σN (T ) =          µn (T )
                                                  1

The fact that they are norms and in particular fulfill
(224)                       σN (T1 + T2 ) ≤ σN (T1 ) + σN (T1 )
follows from the next statement in which we use the same notation for a subspace
E ⊂ H and the orthogonal projection on that subspace.
Proposition 14.2. One has
(225)                      σN (T ) = sup{kT Ek1 | dim E = N }
Let T be a positive operator, then
(226)                     σN (T ) = sup{Tr(T E) | dim E = N }
We use the following notation for refined limiting processes,
                                             61
Definition 14.3. With the Cesàro mean M defined by
                                         Z λ
                                      1           du
(227)                   M (f )(λ) =          f (u) .
                                    log λ 1        u
and h(λ) a bounded function of λ > 0, ω a linear form on Cb (R∗+ ) which is positive,
ω(1) = 1, and vanishes on C0 (R∗+ ), and φ an homeomorphism of R∗+ , we define:
(228)             Limkφ(λ)→ω h(λ) = ω(M k (g)) , g(λ) = h(φ−1 (λ))
where the upper index k indicates that we iterate the Cesàro mean k-times.

We write Limω as an abbreviation for Lim1ω , and when we apply it to a sequence
(αN )N ∈N we mean that the sequence has been extended to a function using
(229)                        fα (λ) = αN for λ ∈ ]N − 1, N ].
Also we consider the two-sided ideal containing compact operators of order one,
(230)                 L(1,∞) (H) = {T ∈ K; σN (T ) = O(log N )} .


Definition 14.4. For T ≥ 0, T ∈ L(1,∞) (H), we set
                                                        N
                                                   1 X
(231)                      Trω (T ) = Limω                 µn (T ).
                                                 log N n=1

The basic properties of the Dixmier trace Trω are summarized in the following ([9]
Proposition 3, IV.2.β):
Proposition 14.5. Trω extends uniquely by linearity to the entire ideal L(1,∞) (H)
and has the following properties:
   (a) If T ≥ 0 then Trω (T ) ≥ 0.
   (b) If S is any bounded operator and T ∈ L(1,∞) (H), then Trω (ST ) = Trω (T S).
   (c) Trω (T ) is independent of the choice of the inner product on H, i.e. it de-
       pends only on the Hilbert space H as a topological vector space.
                                         (1,∞)
   (d) Trω vanishes on the ideal L0      (H), which is the closure, for the k k1,∞ -
       norm, of the ideal of finite-rank operators.
We fix p ∈ [1, ∞]. Let D be a self-adjoint unbounded operator such that its re-
solvent is an infinitesimal of order 1/p, i.e. such18 that µn (D−1 ) = O(n−1/p ). We
shall compare Trω (T |D|−p ) and lim ǫp Tr(f (ǫD)T ). We let EN be the spectral
projection19 on the first N -eigenvectors of |D| so that dimEN = N , EN < EN +1
and
(232)                         Tr(EN |D|−p ) = σN (|D|−p ) .
Lemma 14.6. For any bounded operator T ∈ L(H) one has
                               1
(233)                 Limω         Tr(EN |D|−p T ) = Trω (T |D|−p )
                             log N

  18We replace D by a non-zero constant on its kernel so that D −1 makes sense.
  19This is ambiguous when there is spectral multiplicity.

                                              62
Proof. The hypothesis on D shows that Tr(EN |D|−p ) = O(log N ). Moreover, by
construction of the Dixmier trace, one has
                    1                         1
(234)      Limω        Tr(EN |D|−p ) = Limω       σN (|D|−p ) = Trω (|D|−p )
                 log N                      log N
Let φ(T ) be the left-hand side of (233). It makes sense since
                  |Tr(EN |D|−p T )| ≤ Tr(EN |D|−p )kT k = O(log N )
so that the sequence log1N Tr(EN |D|−p T ) is bounded. The functional φ on L(H) is
linear and positive (the trace of the product of the two positive operators EN |D|−p
and T is positive). Let ψ(T ) be the right-hand side of (233). Proposition 14.5 shows
that, since |D|−p ∈ L(1,∞) (H), the functional ψ is a positive linear functional on
L(H). One uses Proposition 14.5, (b) to check the positivity, using for T ≥ 0,
                      Trω (T |D|−p ) = Trω (T 1/2 |D|−p T 1/2 ) ≥ 0 .
Let us show that for any T ≥ 0 one has φ(T ) ≤ ψ(T ). One has
                    σN (T 1/2 |D|−p T 1/2 ) = σN (|D|−p/2 T |D|−p/2 )
using A = |D|−p/2 T 1/2 in
(235)                 µn (A∗ A) = µn (AA∗ ) ,    ∀A ∈ K , n ∈ N .
Thus one gets
                                                1
(236)         ψ(T ) = Trω (T |D|−p ) = Limω         σN (|D|−p/2 T |D|−p/2 )
                                              log N
By (226), one has
          σN (|D|−p/2 T |D|−p/2 ) = sup{Tr(|D|−p/2 T |D|−p/2 E) | dim E = N }
                   ≥ Tr(|D|−p/2 T |D|−p/2 EN ) = Tr(EN |D|−p T )
since EN and |D|−p/2 commute. Thus σN (|D|−p/2 T |D|−p/2 ) ≥ Tr(EN |D|−p T ) and
after dividing by log N and applying Limω to both sides one gets the inequality
φ(T ) ≤ ψ(T ). But, by (234), φ(1) = Trω (|D|−p ) = ψ(1) and thus the positive
functional θ = ψ −φ is equal to 0, by the Schwartz inequality |θ(T )|2 ≤ θ(T ∗ T )θ(1).
                                                                                     
With |D| as above, we let as in (156), for any λ > 0,
(237)                   P (λ) = 1[0,λ] (|D|) , α(λ) = TrP (λ) .
Lemma 14.7. Assume that
(238)                             lim inf λ−p α(λ) > 0
Then, for any bounded operator T ∈ L(H) one has
                     1                                1
(239)       p Limω       Tr(EN |D|−p T ) = Limλp →ω       Tr(P (λ)|D|−p T )
                   log N                            log λ
Proof. We can assume by linearity that T ≥ 0. We have (using (157)) constants
c1 > 0 and c2 < ∞ such that:
(240)                             c1 λp ≤ α(λ) ≤ c2 λp
We let:
(241)             f (N ) = Tr(EN |D|−p T ) , g(λ) = Tr(P (λ)|D|−p T )
                                            63
Since dimP (λ) ≤ N implies P (λ) ≤ EN we get, using P (λ)|D|−p ≤ EN |D|−p ,
(242)                       f (N ) ≥ g(λ) ,    ∀λ , c2 λp ≤ N .
Similarly, since dimP (λ) ≥ N implies P (λ) ≥ EN we get
(243)                       f (N ) ≤ g(λ) ,    ∀λ , c1 λp ≥ N .
We extend f (N ) to positive real values of N as a non-decreasing step function.
The arbitrariness of the extension is irrelevant since f (N + 1) − f (N ) → 0 when
N → ∞ and we are interested in Limω log1 N f (N ) which is insensitive to bounded
perturbations of f . By construction, the Cesàro mean satisfies the following scale
invariance, for bounded functions f ,
(244)                |M (θµ (f ))(λ) − M (f )(λ)| → 0 as λ → ∞,
where µ > 0 and θµ (f )(λ) = f (µ−1 λ) ∀λ ∈ R∗+ . It follows from (242) and (243)
that f (c1 N ) ≤ g(N 1/p ) ≤ f (c2 N ) up to o(N ) and for any positive real N . Thus the
scale invariance of the Cesàro mean (244), together with log N/ log cN → 1 gives:
                             1                   1
(245)                 M(         f (N )) − M (       g(N 1/p )) → 0
                           log N               log N
so that
                           1            1         1
                     Limω      f (N ) = Limω            g(N 1/p )
                         log N          p     log N 1/p
and the required equality (239) follows from Definition 14.3.                          

Corollary 14.8. Assuming (238), one has
                                            1
(246)       p Trω (T |D|−p ) = Limλp →ω         Tr(P (λ)|D|−p T ) ,    ∀T ∈ L(H) .
                                          log λ
Proof. This follows from Lemmas 14.6 and 14.7.                                         

                                                          R∞
Theorem 14.9. Assume (238). Let f ∈ Cc ([0, ∞[). Let ρ = p 0 up−1 f (u)du.
Then for any bounded operator T ∈ L(H) one has
(247)                Lim2ǫ−p →ω ǫp Tr(f (ǫ|D|)T ) = ρ Trω (T |D|−p )
Proof. Let g(u) = up f (u) viewed as an integrable function on the multiplicative
group R∗+ , endowed with its normalized Haar measure d∗ u = duu . We can assume
that T ≥ 0. We consider the positive measure on R∗+ given by dβ(λ) where
(248)                           β(λ) = Tr(P (λ)|D|−p T )
which is a non-decreasing step function
                                   P of λ. The measure dβ is a positive linear
combination of Dirac masses, dβ = αn δλn . One has
                    dβ(λ) = Tr(dP (λ)|D|−p T ) = λ−p Tr(dP (λ)T )
                                  Z                     Z
            p                   p
           ǫ Tr(f (ǫ|D|)T ) = ǫ     f (ǫλ)Tr(dP (λ)T ) = ǫp λp f (ǫλ)dβ(λ)

so that:
                                                   Z
                            p
(249)                       ǫ Tr(f (ǫ|D|)T ) =         g(ǫλ)dβ(λ)
                                              64
The convolution of the measure dβ with the function g̃(u) = g(u−1 ) makes sense,
since both have support in an interval [u0 , ∞[ with u0 > 0, and gives the function
                                        Z
(250)                    (g̃ ⋆ dβ)(u) = g(u−1 λ)dβ(λ) .

Thus, with h(ǫ) = ǫp Tr(f (ǫ|D|)T ), one gets using (249),
(251)                           h(u−1 ) = (g̃ ⋆ dβ)(u)
The convolution of the measures g̃(u)d∗ u and dβ is absolutely continuous with
respect to d∗ u and is given, with θu (v) = uv for all u, v > 0, by
                                          Z
(252)                     (g̃ ⋆ dβ)d u = g̃(u)θu (dβ)d∗ u .
                                    ∗


We extend the definition of the Cesàro mean (227) to measures µ by:
                                              Z λ
                                           1
(253)                        M (µ)(λ) =           dµ ,
                                         log λ 1
so that
(254)                   M (µ)(λ) = M (h)(λ) for µ = h d∗ u .
One has β(λ) = O(log λ) since
                                                          Z λ
                                        −p
                  β(λ) ≤ Tr(P (λ)|D|            )kT k ≤         u−p dα(u)kT k
                                                           0

while α(u) = 0 near 0, and u−p α(u) is bounded by (240). This gives after integrat-
ing by parts
       Z λ                        Z λ
             −p          −p
           u dα(u) = λ α(λ) +          p u−p−1 α(u)du ≤ c2 (1 + p log λ) + c′
          0                             0
Moreover for v > 1 one gets, by the above integration by parts,
                                 Z vλ
(255)        β(vλ) − β(λ) ≤ kT k      u−p dα(u) ≤ kT k c2(1 + log v) .
                                    λ
One has
                                        Z λ
                                1                        1
(256)             M (dβ)(λ) =                   dβ =         (β(λ) − β(1))
                              log λ         1          log λ
Thus one has constants a and b such that for any u,
(257)         |M (θu (dβ))(λ) − M (dβ)(λ)| =≤ (a + b| log u|)(log λ)−1
Thus since g̃(u) and | log u|g̃(u) are integrable,
                     Z                             Z
(258)             M ( g̃(u)θu (dβ)d∗ u) − M (dβ)     g̃(u)d∗ u → 0

Equivalently, using (251), (252), (254) and g̃(u)d∗ u = g(u)d∗ u,
                                             R           R
                                 Z
(259)            M (h̃) − M (dβ)    g(u)d∗ u → 0 , h̃(u) = h(u−1 ) .

Now by (256) and (246) one has
(260)                  Limλp →ω M (dβ)(λ) = p Trω (T |D|−p )
                                                65
Thus we finally get
                          Z
(261)                (p       g(u)d∗ u)Trω (T |D|−p ) = Limλp →ω M (h̃)(λ)

The right hand side is given, by definition, by
                Limλp →ω M (h̃)(λ) = ω(M (k)(u)) , k(u) = M (h̃)(u1/p )
Thus we still need to compare k(u) = M (h̃)(u1/p ) with k1 (u) = M (h̃(λ1/p ))(u),
but a simple computation shows that k(u) = k1 (u).                              

Corollary 14.10. Assume (238). Let f ∈ Cc ([0, ∞[)+ be a positive function. Let
     R ∞ p−1
ρ = p 0 u f (u)du. One has, when ǫ → 0,
(262)                     lim inf ǫp Tr(f (ǫ|D|)T ) ≤ ρ Trω (T |D|−p ) .
Proof. Let δ = lim inf ǫp Tr(f (ǫ|D|)T ). Then for any c < 1 one has h(ǫ) =
ǫp Tr(f (ǫ|D|)T ) ≥ cδ for ǫ ≤ ǫc > 0. It follows that Lim2ǫ−p →ω h(ǫ) ≥ cδ. Thus
by (247) one has cδ ≤ ρ Trω (T |D|−p ) and one gets (262).                     


                                          References
 [1] H. Araki, Expansional in Banach algebras, Ann. Sci. École Norm. Sup. (4) 6 (1973), 67–84.
 [2] O. Bratteli, Derivations, dissipations and group actions on C ∗ -algebras. Lecture Notes in
     Mathematics, 1229. Springer-Verlag, Berlin, (1986).
 [3] A. Chamseddine, A. Connes, The Spectral action principle, Comm. Math. Phys. Vol.186
     (1997), 731–750.
 [4] A. Chamseddine, A. Connes, Why the Standard Model, hep-th 0706.3688.
 [5] A. Chamseddine, A. Connes, A dress for SM the beggar, hep-th 0706.3690.
 [6] A. Chamseddine, A. Connes, M. Marcolli, Gravity and the standard model with neutrino
     mixing, hep-th/0610241.
 [7] A. Connes, Noncommutative differential geometry. Inst. Hautes Études Sci. Publ. Math. No.
     62 (1985), 257–360.
 [8] A. Connes, Trace de Dixmier, modules de Fredholm et géométrie riemannienne. (French)
     [Dixmier trace, Fredholm modules and Riemannian geometry] Conformal field theories and
     related topics (Annecy-le-Vieux, 1988). Nuclear Phys. B Proc. Suppl. 5B (1988), 65–70.
 [9] A. Connes, Noncommutative geometry, Academic Press (1994).
[10] A. Connes, Geometry from the spectral point of view, Lett. Math. Phys. 34 (1995), 203238
[11] A. Connes, Gravity coupled with matter and the foundation of noncommutative geometry,
     Comm. Math. Phys. (1995)
[12] A. Connes, A unitary invariant in Riemannian Geometry
[13] A. Connes, H. Moscovici, The local index formula in noncommutative geometry, GAFA, Vol.
     5 (1995), 174–243.
[14] H. Figueroa, J.M. Gracia-Bondı́a, J. Varilly, Elements of Noncommutative Geometry,
     Birkhäuser, 2000.
[15] P. Gilkey, Invariance Theory, the Heat Equation and the Atiyah-Singer Index Theorem,
     Wilmington, Publish or Perish, 1984.
[16] R. Hamilton, The inverse function theorem of Nash and Moser Bull. A. M. S.(New Series)
     7, Number 1, (1982).
[17] M. Hilsum, Fonctorialité en K-théorie bivariante pour les variétés lipschitziennes. K-theory
     3 (1989), 401–440.
[18] H. B. Lawson, M-L. Michelsohn Spin geometry, Princeton Mathematical Series, 38. Princeton
     University Press, Princeton, NJ, 1989.
[19] J. L. Loday, Cyclic homology. Grundlehren der Mathematischen Wissenschaften, 301.
     Springer-Verlag, Berlin, 1992.
[20] J. Milnor, Eigenvalues of the Laplace operator on certain manifolds Proc. Natl. Acad. Sci. U
     S A. 51(4) (1964), 542.
                                                 66
[21] M. Reed, B. Simon, II Fourier Analysis, Self-Adjointness
[22] A. Rennie, J.C. Varilly, Reconstruction of manifolds in noncommutative geometry,
     math.OA/0610418.
[23] W. Rudin Real and Complex Analysis, Mc Graw Hill Book Company (1986).
[24] W. Rudin Functional Analysis, Mc Graw Hill Book Company (1973).
[25] D. Voiculescu. Some results on norm-ideal perturbations of Hilbert space operators, I. J.
     Operator Theory 2 (1979), 3-37.
[26] D. Voiculescu. Some results on norm-ideal perturbations of Hilbert space operators, II. J.
     Operator Theory 5 (1981), 77-100.
[27] D. Voiculescu. On the existence of quasicentral approximate units relative to normed ideals,
     Part 1. J. Functional Anal. 91 (1990), 1-36.

A. Connes: Collège de France, 3, rue d’Ulm, Paris, F-75005 France, I.H.E.S. and Van-
derbilt University
E-mail address: alain@connes.org




                                               67
