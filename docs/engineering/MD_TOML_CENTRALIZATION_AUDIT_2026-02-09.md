<!-- AUTO-GENERATED: DO NOT EDIT -->
<!-- Source of truth: registry/research_narratives.toml -->

# Markdown and TOML Centralization Audit (2026-02-09)

## Scope

This audit answers four questions:

1. What is the current markdown footprint in the tracked repository?
2. Are markdown files autogenerated, manual, or mixed?
3. What already uses TOML as source of truth?
4. What is the migration path to a central TOML knowledge database?

Inputs:

- `git ls-files '*.md'`
- `git ls-files '*.toml'`
- `registry/knowledge_sources.toml`
- `crates/gororoba_cli/src/bin/migrate_claims.rs`
- `crates/gororoba_cli/src/bin/migrate_insights.rs`
- `crates/gororoba_cli/src/bin/registry_check.rs`
- `crates/gororoba_cli/src/bin/generate_latex.rs`

## Snapshot

Tracked counts (2026-02-09):

- Markdown files: 216
- TOML files: 43
- Central registry TOML files: 5 under `registry/`

Knowledge-index classification (`registry/knowledge_sources.toml`):

- `manual_source`: 126
- `markdown_mirror`: 6
- `generated_markdown`: 30
- `artifact_report`: 54

Conclusion:

- Not all markdown is autogenerated.
- Most markdown is still manual source content or human-facing mirror content.

## Source-of-Truth Status

Current TOML source-of-truth coverage:

1. Claims:
   - TOML: `registry/claims.toml`
   - Markdown mirror: `docs/CLAIMS_EVIDENCE_MATRIX.md`
   - Import tool: `migrate-claims` (md -> toml)

2. Insights:
   - TOML: `registry/insights.toml`
   - Markdown mirror: `docs/INSIGHTS.md`
   - Import tool: `migrate-insights` (md -> toml)
   - Export tool: `export_registry_markdown_mirrors.py` (toml -> md generated mirror)

3. Experiments:
   - TOML: `registry/experiments.toml`
   - Markdown companion: `docs/EXPERIMENTS_PORTFOLIO_SHORTLIST.md`
   - Export tool: `export_registry_markdown_mirrors.py` (toml -> md generated mirror)

4. Binaries:
   - TOML: `registry/binaries.toml`
   - Checked against Cargo bins by `registry-check`

5. Project metadata:
   - TOML: `registry/project.toml`
   - No single generated markdown mirror

Generated outputs already TOML-driven:

- `docs/latex/claims_appendix.tex` from `registry/claims.toml`
- `docs/latex/insights_appendix.tex` from `registry/insights.toml`

## Key Conflicts Resolved in This Pass

1. Claims markdown header now states it is a mirror, not machine source of truth.
2. Book claims chapter now states `migrate-claims` is md -> toml.
3. Central markdown index added at `registry/knowledge_sources.toml`.

## New Central TOML Database Layer

New artifacts added:

- Generator: `src/scripts/analysis/build_knowledge_sources_registry.py`
- Output: `registry/knowledge_sources.toml`
- Corpus migrator: `src/scripts/analysis/migrate_markdown_corpus_to_toml.py`
- Mirror exporter: `src/scripts/analysis/export_registry_markdown_mirrors.py`
- Output manifest: `registry/knowledge/documents.toml`
- Per-document store: `registry/knowledge/docs/DOC-*.toml`
- Generated mirrors: `docs/generated/*_REGISTRY_MIRROR.md`
- Make targets: `make registry-knowledge`, `make registry-migrate-corpus`
- Registry flow: `make registry` now runs knowledge indexing and corpus
  migration and markdown mirror export before `registry-check`.

Each indexed markdown record includes:

- deterministic id (`DOC-XXXX`)
- path and title
- kind (`manual_source`, `markdown_mirror`, `generated_markdown`,
  `artifact_report`, `transcript_input`)
- authoring mode and generated flag
- migration priority
- optional TOML backing
- sha256, size, line count
- claim/insight/experiment reference counts
- link density and samples

Raw-capture coverage in this pass:

- Raw-captured: 131 markdown files into TOML (`generated = false` in index)
- Skipped: 84 markdown files marked generated/artifact
- Important: this capture layer is intentionally non-authoritative and pending
  normalization into domain registries.

Curated domain registries added in this pass:

- `registry/roadmap.toml`
- `registry/todo.toml`
- `registry/next_actions.toml`
- `registry/requirements.toml`
- `registry/knowledge_migration_plan.toml` (human-curated migration policy by domain)

## Migration Gaps (Remaining)

1. `docs/INSIGHTS.md` and `docs/EXPERIMENTS_PORTFOLIO_SHORTLIST.md` are not
   generated from TOML yet.
2. Domain map (`docs/claims/CLAIMS_DOMAIN_MAP.csv`) is CSV-first, not TOML-first.
3. Sprint trackers (`docs/TODO.md`, `docs/NEXT_ACTIONS.md`, `docs/ROADMAP.md`)
   are markdown-first.
4. Requirements docs are distributed and not indexed in a dedicated TOML schema.

## Recommended Next Phases

Phase 1 (completed in this pass):

- Add central markdown index in TOML.
- Classify markdown sources and mark migration priority.

Phase 2:

- Add TOML registries for operational docs:
  - `registry/roadmap.toml`
  - `registry/next_actions.toml`
  - `registry/todo.toml`
  - `registry/requirements.toml`
- Add deterministic exporters for markdown mirrors.

Phase 2 status:

- Complete in this pass.
- Exported mirrors are written to `docs/generated/*_REGISTRY_MIRROR.md`.

Phase 3:

- Add `migrate-experiments` and `export-experiments-md`.
- Add `export-insights-md`.
- Add `export-claims-md` for a fully TOML-first round-trip.

Phase 3 status:

- Partially complete in this pass:
  - `export_registry_markdown_mirrors.py` now exports experiments and insights mirrors.
- Remaining:
  - dedicated bidirectional claim/insight/experiment import-export normalization
    and policy for legacy narrative markdown replacement vs overlay.

Phase 4:

- Move generated markdown into explicit generated paths where applicable.
- Mark every generated markdown with a `DO NOT EDIT` header and command.
- Wire all exporters into `make registry` and CI.

## Quality Gates for This Workflow

Run:

```bash
python3 src/scripts/analysis/build_knowledge_sources_registry.py
cargo run --release --bin registry-check
python3 bin/ascii_check.py --check
```
