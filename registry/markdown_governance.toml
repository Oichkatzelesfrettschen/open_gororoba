# Canonical markdown governance policy for open_gororoba.
# Defines rules for markdown source lifecycle, removal, and deprecation.
# Source of truth for W6-020 Canonical Markdown Source Removal Policy.

[markdown_governance]
id = "markdown_governance"
schema_version = "1.0"
updated = "2026-02-10"
authoritative = true
objective = "Establish explicit rules for markdown file lifecycle, migration, and removal as TOML sources become canonical."

# Core governance rules
[[rule]]
id = "MG-001"
title = "No orphan hand-written markdown in scope"
description = """
All hand-written markdown files in scope (docs/, reports/, data/artifacts/) MUST have an entry in registry/markdown_owner_map.toml.
Files without an owner entry are implicit violations and must be either:
- Added to markdown_owner_map with canonical_toml pointer, or
- Moved to .gitignore (third-party/external).
"""
enforcement = "hard"
violation_check = "verify_markdown_governance_orphans.py"

[[rule]]
id = "MG-002"
title = "Removal must follow TOML decommission path"
description = """
To remove hand-written markdown:
1. Remove canonical TOML source (mark deprecated or delete)
2. Remove owner entry from markdown_owner_map.toml
3. Run PYTHONWARNINGS=error MARKDOWN_EXPORT=1 make docs-publish to purge mirrors
4. Verify markdown file is regenerated (if still needed) or missing (if deprecated)
5. Delete the .md file only after mirrors are purged

Do NOT delete markdown files directly without decommissioning their TOML sources first.
This ensures mirrors stay in sync and no stale files remain.
"""
enforcement = "hard"
violation_check = "verify_markdown_governance_decommission_order.py"

[[rule]]
id = "MG-003"
title = "Generated mirrors are immutable and ephemeral"
description = """
Markdown files with AUTO-GENERATED header are created from TOML source and MUST NOT be edited.
They are overwritten on every make registry or MARKDOWN_EXPORT=1 make docs-publish invocation.
Manual edits to generated files are lost and tracked as violations.
"""
enforcement = "hard"
violation_check = "verify_markdown_governance_immutability.py"

[[rule]]
id = "MG-004"
title = "Migration queue has explicit rank ordering"
description = """
Files in registry/markdown_inventory.toml migration_queue have explicit rank (1, 2, 3, ...).
Migration MUST proceed in rank order. Do NOT skip ranks.
- Rank 1: Critical path (blockers for other work)
- Rank 2: High priority (needed for Wave 7 scoping)
- Rank 3+: Medium and low priority (nice-to-have enhancements)
"""
enforcement = "medium"
violation_check = "verify_markdown_governance_queue_ordering.py"

[[rule]]
id = "MG-005"
title = "Third-party markdown must be locked"
description = """
Third-party markdown (external sources, imported research) is locked and exempt from removal policy.
Such files MUST have removal_status = locked in markdown_owner_map.
They may be referenced but never removed without explicit exception (documented in removal_reason).
"""
enforcement = "medium"
violation_check = "verify_markdown_governance_third_party.py"

[[rule]]
id = "MG-006"
title = "Removal status must have explicit reason"
description = """
Any markdown file with removal_status != active MUST have a non-empty removal_reason field.
Examples:
- removal_status = deprecated, removal_reason = Superseded by TOML-native equation_atoms_v3.toml
- removal_status = candidate_for_removal, removal_reason = Phase 9 research; migrate to claims after sprint 40
- removal_status = locked, removal_reason = Third-party research import from arXiv
"""
enforcement = "hard"
violation_check = "verify_markdown_governance_removal_reason.py"

# Removal timeline guidance
[[timeline_stage]]
id = "TS-001"
stage = "active"
description = "File is in current use, canonical TOML source is authoritative"
action = "maintain"
duration = "ongoing"

[[timeline_stage]]
id = "TS-002"
stage = "candidate_for_removal"
description = "File is superseded by TOML source; proposed for removal in next sprint"
action = "schedule_decommission"
duration = "1-2 sprints"
example = "data/artifacts/extracted_equations.md to registry/knowledge/equation_atoms_v3.toml"

[[timeline_stage]]
id = "TS-003"
stage = "deprecated"
description = "File's TOML source is canonical and regeneration complete; awaiting archive"
action = "remove_in_next_release"
duration = "1 sprint"
example = "After MARKDOWN_EXPORT=1 make docs-publish succeeds, file marked deprecated"

[[timeline_stage]]
id = "TS-004"
stage = "archived"
description = "File removed from active repo; copy preserved in archive branch"
action = "none"
duration = "eternal"
example = "Commit message references archived file and sprint when removed"

[[timeline_stage]]
id = "TS-005"
stage = "locked"
description = "File is third-party or special-case; exempt from removal policy"
action = "preserve"
duration = "permanent"
example = "Third-party research PDFs, external documentation, immutable records"

# Removal priority zones
[[priority_zone]]
id = "PZ-001"
name = "artifact_scrolls"
rationale = "8 artifact markdown files should migrate to registry/knowledge/artifacts"
file_count = 8
estimated_effort_hours = 2
target_sprint = 35

[[priority_zone]]
id = "PZ-002"
name = "research_narratives"
rationale = "Narrative markdown in reports should migrate to registry/research_narratives.toml"
file_count = 12
estimated_effort_hours = 4
target_sprint = 36

[[priority_zone]]
id = "PZ-003"
name = "docs_root"
rationale = "Root-level markdown (ROADMAP, etc.) should migrate to registry/docs_root_narratives.toml"
file_count = 5
estimated_effort_hours = 2
target_sprint = 37

[[priority_zone]]
id = "PZ-004"
name = "external_sources"
rationale = "Third-party markdown cache should stay locked; no migration"
file_count = 5
estimated_effort_hours = 0
target_sprint = "never"
status = "locked"
